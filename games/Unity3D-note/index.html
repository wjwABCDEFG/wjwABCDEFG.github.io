<!DOCTYPE html>
<html  lang="zh">
<head>
    <meta charset="utf-8" />

<meta name="generator" content="Hexo 4.2.1" />

<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />

<title>Unity3D学习笔记 - 小温 blog</title>


    <meta name="description" content="本笔记是学习自夏村散人韩老师的unity教程https:&#x2F;&#x2F;www.bilibili.com&#x2F;video&#x2F;BV1B7411L74W，自己的一些记录和整理">
<meta property="og:type" content="article">
<meta property="og:title" content="Unity3D学习笔记">
<meta property="og:url" content="https://wjw.today/games/Unity3D-note/index.html">
<meta property="og:site_name" content="小温 blog">
<meta property="og:description" content="本笔记是学习自夏村散人韩老师的unity教程https:&#x2F;&#x2F;www.bilibili.com&#x2F;video&#x2F;BV1B7411L74W，自己的一些记录和整理">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210728004637.jpg">
<meta property="article:published_time" content="2021-07-28T12:42:07.000Z">
<meta property="article:modified_time" content="2021-07-27T16:52:55.999Z">
<meta property="article:author" content="wjw">
<meta property="article:tag" content="游戏和引擎">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210728004637.jpg">







<link rel="icon" href="/images/favicon.ico">


<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bulma@0.7.2/css/bulma.css">
<link rel="stylesheet" href="https://cdn.bootcss.com/font-awesome/5.4.1/css/all.css">
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Ubuntu:400,600|Source+Code+Pro">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@9.12.0/styles/atom-one-dark.css">


    
    
<style>body>.footer,body>.navbar,body>.section{opacity:0}</style>

    
    
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/css/lightgallery.min.css">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/css/justifiedGallery.min.css">

    
    
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/outdatedbrowser@1.1.5/outdatedbrowser/outdatedbrowser.min.css">

    
    
    
    
<link rel="stylesheet" href="/css/back-to-top.css">

    
    
    
    
    
    
    
    <link rel="stylesheet" href="/css/progressbar.css">
<script src="https://cdn.jsdelivr.net/npm/pace-js@1.0.2/pace.min.js"></script>
    
    <script async="" src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
    


<link rel="stylesheet" href="/css/style.css">
</head>
<body class="is-3-column">
    <nav class="navbar navbar-main">
    <div class="container">
        <div class="navbar-brand is-flex-center">
            <a class="navbar-item navbar-logo" href="/">
            
                <img src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210717231246.png" alt="Unity3D学习笔记" height="28">
            
            </a>
        </div>
        <div class="navbar-menu">
            
            <div class="navbar-start">
                
                <a class="navbar-item"
                href="/">主页</a>
                
                <a class="navbar-item"
                href="/archives">归档</a>
                
                <a class="navbar-item"
                href="/categories">分类</a>
                
                <a class="navbar-item"
                href="/tags">标签</a>
                
                <a class="navbar-item"
                href="/about">关于</a>
                
            </div>
            
            <div class="navbar-end">
                
                    
                    <a class="navbar-item" target="_blank" rel="noopener" title="View My GitHub" href="https://github.com/wjwABCDEFG">
                        
                        <i class="fab fa-github"></i>
                        
                    </a>
                    
                
                
                <a class="navbar-item is-hidden-tablet catalogue" title="目录" href="javascript:;">
                    <i class="fas fa-list-ul"></i>
                </a>
                
                
                <a class="navbar-item search" title="搜索" href="javascript:;">
                    <i class="fas fa-search"></i>
                </a>
                
            </div>
        </div>
    </div>
</nav>
    
    <section class="section">
        <div class="container">
            <div class="columns">
                <div class="column is-8-tablet is-8-desktop is-6-widescreen has-order-2 column-main">
<div class="card">
    
    <div class="card-image">
        <span  class="image is-7by1">
            <img class="thumbnail" src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210728004637.jpg" alt="Unity3D学习笔记">
        </span>
    </div>
    
    <div class="card-content article ">
        
        <div class="level article-meta is-size-7 is-uppercase is-mobile is-overflow-x-auto">
            <div class="level-left">
                <time class="level-item has-text-grey" datetime="2021-07-28T12:42:07.000Z">2021-07-28</time>
                
                <div class="level-item">
                <a class="has-link-grey -link" href="/categories/games/">游戏和引擎</a>
                </div>
                
                
                <span class="level-item has-text-grey">
                    
                    
                    2 小时 读完 (大约 21169 个字)
                </span>
                
                
                <span class="level-item has-text-grey" id="busuanzi_container_page_pv">
                    <i class="far fa-eye"></i>
                    <span id="busuanzi_value_page_pv">0</span>次访问
                </span>
                
            </div>
        </div>
        
        <h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal">
            
                Unity3D学习笔记
            
        </h1>
        <div class="content">
            <blockquote>
<p>本笔记是学习自夏村散人韩老师的unity教程<a href="https://www.bilibili.com/video/BV1B7411L74W，自己的一些记录和整理">https://www.bilibili.com/video/BV1B7411L74W，自己的一些记录和整理</a></p>
</blockquote>
<a id="more"></a>

<h1 id="一、基础"><a href="#一、基础" class="headerlink" title="一、基础"></a>一、基础</h1><h2 id="1-1-unity编辑器"><a href="#1-1-unity编辑器" class="headerlink" title="1.1 unity编辑器"></a>1.1 unity编辑器</h2><p>右边栏是组件栏，物品、地形、相机等全都是对象GameObject，每个GameObject有自己的组件component，基本上所有物体都包含transform组件用于缩放和旋转。地形，相机等特殊物体可能有自己特殊的组件。</p>
<p><img src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210727232539.png" alt="image-20210727232539699"></p>
<h2 id="1-2-地形系统"><a href="#1-2-地形系统" class="headerlink" title="1.2 地形系统"></a>1.2 地形系统</h2><p>创建地形</p>
<p><img src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210727232607.png" alt="image-20210727232606840"></p>
<p>笔刷（依次是抬高降低、空洞、纹理、平台高度、平滑）</p>
<p><img src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210727232631.png" alt="image-20210727232631047"></p>
<p>纹理</p>
<p><img src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210727232650.png" alt="image-20210727232649945"></p>
<h2 id="1-3-标准资源包"><a href="#1-3-标准资源包" class="headerlink" title="1.3 标准资源包"></a>1.3 标准资源包</h2><p>18年后的版本需要自己下载，可以在官网下载</p>
<p>[<a href="https://assetstore.unity.com/top-assets/top-download?q=Standard%20Assets&amp;orderBy=1]">https://assetstore.unity.com/top-assets/top-download?q=Standard%20Assets&amp;orderBy=1]</a>(<a href="https://assetstore.unity.com/top-assets/top-download?q=Standard">https://assetstore.unity.com/top-assets/top-download?q=Standard</a> Assets&amp;orderBy=1)</p>
<p>也可以直接在编辑器windows-&gt;assets store</p>
<p>报错可以参考这个教程</p>
<p><a href="https://blog.csdn.net/zhang2333333333/article/details/105000621">https://blog.csdn.net/zhang2333333333/article/details/105000621</a></p>
<h2 id="1-4-脚本"><a href="#1-4-脚本" class="headerlink" title="1.4 脚本"></a>1.4 脚本</h2><p>脚本也作为一种component，可以添加c#脚本，其中自带的start和update函数就是生命周期，会自动调用，其中start在GameObject初始化时调用一次，update每帧调用一次。public成员可以在脚本完成后通过unity编辑器拖拽给物体作为参数传入。</p>
<p>下面介绍一些脚本相关的类（组件）：</p>
<p>Transform：可以对应一个unity中的GameObject</p>
<p>具体的类和方法可以看帮助</p>
<p><img src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210727232744.png" alt="image-20210727232744949"></p>
<p>点击后打开api页面可以搜索</p>
<p>其中，manual是以教程的形式，api只是单纯的用法和参数介绍</p>
<p><img src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210727232802.png" alt="image-20210727232802828"></p>
<p>如果没有代码提示，是由于默认编辑器没有设置的原因，参考</p>
<p><a href="https://blog.csdn.net/LiYAnErr/article/details/105137157">https://blog.csdn.net/LiYAnErr/article/details/105137157</a></p>
<p>以下是一个镜头跟随脚本demo</p>
<p><img src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210727232818.png" alt="image-20210727232818146"></p>
<h2 id="1-5-发布"><a href="#1-5-发布" class="headerlink" title="1.5 发布"></a>1.5 发布</h2><p><img src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210727232834.png" alt="image-20210727232834682"></p>
<p>若要选择窗口等模式，如下：</p>
<p><img src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210727232846.png" alt="image-20210727232846787"></p>
<h3 id="1-5-1制作游戏欢迎页面"><a href="#1-5-1制作游戏欢迎页面" class="headerlink" title="1.5.1制作游戏欢迎页面"></a>1.5.1制作游戏欢迎页面</h3><p>1.unity中一个页面scene其实就是一个关卡，因此欢迎页可以视为一个关卡，该关卡啥都没有，只有一个脚本，按下某个键就开始游戏</p>
<p><img src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210727232859.png" alt="image-20210727232859810"></p>
<p>scene名字随便起，比如叫welcome</p>
<p>2.脚本</p>
<p>脚本名字不能随便起，叫GameManager（也不是不能随便起，只不过叫这个的话可以拥有一个特殊的图标）</p>
<p><img src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210727234308.png" alt="image-20210727234307844"></p>
<p><img src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210727234317.png" alt="image-20210727234316957"></p>
<p>3.将脚本应用到物体上，理论上可以应用给场景默认自带的光照或者相机都可以，但是标准的应该是在该场景新建一个空的GameObject，并将脚本拖拽给他</p>
<p>4.调整发布场景编号</p>
<p><img src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210727234331.png" alt="image-20210727234331763"></p>
<h3 id="1-5-2-非全屏"><a href="#1-5-2-非全屏" class="headerlink" title="1.5.2 非全屏"></a>1.5.2 非全屏</h3><p><img src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210727234346.png" alt="image-20210727234346299"></p>
<h1 id="二、动画"><a href="#二、动画" class="headerlink" title="二、动画"></a>二、动画</h1><h2 id="2-1-场景动画"><a href="#2-1-场景动画" class="headerlink" title="2.1 场景动画"></a>2.1 场景动画</h2><p>unity支持外部动画模型导入（比如maya和3dmax），成为模型动画。当然也可以在unity中制作简单的动画，称为场景动画</p>
<h3 id="2-1-1-录制"><a href="#2-1-1-录制" class="headerlink" title="2.1.1 录制"></a>2.1.1 录制</h3><p><img src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210727234419.png" alt="image-20210727234419574"></p>
<p>选择动画片段保存位置</p>
<p>点击录制按钮</p>
<p><img src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210727234426.png" alt="image-20210727234426467"></p>
<h3 id="2-1-2-多段动画的状态机转换"><a href="#2-1-2-多段动画的状态机转换" class="headerlink" title="2.1.2 多段动画的状态机转换"></a>2.1.2 多段动画的状态机转换</h3><p>可以添加多个动画片段</p>
<p><img src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210727234435.png" alt="image-20210727234434960"></p>
<p>添加多个动画片段后，默认只会播放第一个</p>
<p>如果需要组织<strong>多个</strong>动画片段，就需要animator controller</p>
<p><img src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210727234443.png" alt="image-20210727234443887"></p>
<p>调整状态机使其能够转换到另一个动画片段</p>
<p><img src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210727234454.png" alt="image-20210727234454641"></p>
<p>效果就是动画连着播放，然后在最后一个动画循环</p>
<p>除了鼠标操作状态机，也可以通过脚本进行特定条件下状态机的转换，如下创建一个转换条件c</p>
<p>有Float, int, bool, trigger类型，最后一个是触发器，也就是脉冲，触发完一次会自动回到初始状态等待下一次脉冲</p>
<p><img src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210727234503.png" alt="image-20210727234503220"></p>
<p>然后添加一个脚本，指定触发条件</p>
<p><img src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210727234511.png" alt="image-20210727234511472"></p>
<p>将脚本拖拽给cube，即可自动创建出animator controller这个组件</p>
<p>效果：停在第二个动画反复循环，按下空格（并当当前动画放完之后）才进入第三个动画</p>
<p>若需要按下空格时强制跳转到第三个动画，如下取消勾选</p>
<p><img src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210727234531.png" alt="image-20210727234531401"></p>
<h3 id="2-1-3-event"><a href="#2-1-3-event" class="headerlink" title="2.1.3 event"></a>2.1.3 event</h3><p>event事件，用于在某个特定时间点执行某个脚本中的函数</p>
<p>首先添加一个函数，这里是销毁，我们的目的是在最后一个动画结束后销毁</p>
<p><img src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210727234541.png" alt="image-20210727234541537"></p>
<p>然后在最后一段动画（缩放的某个地方添加一个event），填入函数名</p>
<p><img src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210727234551.png" alt="image-20210727234551815"></p>
<h2 id="2-2-骨骼动画"><a href="#2-2-骨骼动画" class="headerlink" title="2.2 骨骼动画"></a>2.2 骨骼动画</h2><h3 id="2-2-1-space-robot-kyle资源包和配置"><a href="#2-2-1-space-robot-kyle资源包和配置" class="headerlink" title="2.2.1 space robot kyle资源包和配置"></a>2.2.1 space robot kyle资源包和配置</h3><p>unity官方提供的一个资源包，可以在商店搜索下载</p>
<p>将rig调整为类人骨架humannoid，记得点击apply</p>
<p><img src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210727234604.png" alt="image-20210727234604507"></p>
<p>这个骨架有个好处是可以容易的实现动画重定向（为一个骨架设计的动画可以移植到另一个骨架上），点击apply后configure按钮亮起，点击可以看到如下界面</p>
<p><img src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210727234614.png" alt="image-20210727234614346"></p>
<p>这只是一个模型，拉取到场景中没有动画效果，我们可以从标准资源包如下位置拉取一个预实现看看效果</p>
<p><img src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210727234630.png" alt="image-20210727234630166"></p>
<h3 id="2-2-2-骨骼动画交互效果说明"><a href="#2-2-2-骨骼动画交互效果说明" class="headerlink" title="2.2.2 骨骼动画交互效果说明"></a>2.2.2 骨骼动画交互效果说明</h3><p>对比我们可以发现预实现的人物有animation controller</p>
<p><img src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210727234638.png" alt="image-20210727234638215"></p>
<p>我们可以为自己的机器人模型也添加同样的controller</p>
<p>人物随之可以摆动，但没有键盘交互效果</p>
<p>不难发现，预实现的人物对象中还有一些脚本</p>
<p><img src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210727234646.png" alt="image-20210727234646245"></p>
<p>第一个脚本有[RequireComponent(typeof (ThirdPersonCharacter))]，也就是包含了第二个脚本</p>
<p>所以我们只需要把第一个脚本拖拽给自己的模型</p>
<p><img src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210727234653.png" alt="image-20210727234653365"></p>
<p>我们通过右边的capsule将框架调整到如上图所示大约包裹身体，此时运行如下图所示</p>
<p><img src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210727234703.png" alt="image-20210727234703313"></p>
<p>这是由于地面检测原因，将其调大即可 </p>
<p><img src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210727234714.png" alt="image-20210727234714600"></p>
<h2 id="2-3-曲线"><a href="#2-3-曲线" class="headerlink" title="2.3 曲线"></a>2.3 曲线</h2><p>曲线是用函数的形式让时间和某个变量关联起来，即value = func(time)，func可以是二次函数或者别的函数，value的值便会发生变化，可以用这个值影响动画</p>
<p>比如：机器人在跑步的时候如果想让他吹一个泡泡，泡泡随时间变大变小</p>
<p>新建一个场景，添加机器人，新建一个animation controller，新建一个空状态，为状态添加一个人物跑步动作</p>
<p><img src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210727234724.png" alt="image-20210727234724312"></p>
<p>并拖拽给机器人，机器人可以跑步</p>
<p>为了更好的演示，将机器人取消连接根节点（应该就是不转换为世界坐标），便可以原地跑步</p>
<p><img src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210727234731.png" alt="image-20210727234731793"></p>
<p>接下来添加曲线，在controller的parameters中添加参数，参数名很重要，然后点击motion，unity会自动定位这个run动作的位置，点击它</p>
<p><img src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210727234754.png" alt="image-20210727234754151"></p>
<p>点击edit便可以编辑属性值</p>
<p><img src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210727234807.png" alt="image-20210727234807442"></p>
<p>找到曲线，添加，</p>
<p>曲线的名字必须跟parameters中某个变量的名字一样，点击曲线并选择一种曲线</p>
<p><img src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210727234816.png" alt="image-20210727234816468"></p>
<p>选完后一定要点击一下下面的apply</p>
<p>下面来创建泡泡，新建一个GameObject命名为泡泡，并作为头部的子物体</p>
<p><img src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210727234828.png" alt="image-20210727234828596"></p>
<p>点击transform中的reset，球体便会将本地坐标变为头部位置（和头部重合）</p>
<p><img src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210727234840.png" alt="image-20210727234839962"></p>
<p>再将泡泡细微调整以下</p>
<p><img src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210727234847.png" alt="image-20210727234847779"></p>
<p>新建脚本，设置机器人的动作（其实是设置机器人里面泡泡的动作）</p>
<p><img src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210727234858.png" alt="image-20210727234858007"></p>
<p>这里的bubble当然也可以直接设置为public，然后再unity中直接将泡泡拖拽赋值。因为这个脚本最终会拖拽给机器人，泡泡是机器人的子物体，所以可以设置为private然后通过transform的Find函数获取子物体。</p>
<p>完事，运行，可以看到机器人跑步的过程中泡泡变大变小</p>
<h2 id="2-4-动画层"><a href="#2-4-动画层" class="headerlink" title="2.4 动画层"></a>2.4 动画层</h2><p>动画层就是多个动画叠加，能同时展现，比如边走路边开枪</p>
<h3 id="2-4-1-动画层的添加"><a href="#2-4-1-动画层的添加" class="headerlink" title="2.4.1 动画层的添加"></a>2.4.1 动画层的添加</h3><p>新建场景，添加机器人，新建animition controller，添加新状态，添加走路动作</p>
<p>默认有个动画层，现在新建一个层比如叫ArmUp 抬手</p>
<p><img src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210727234912.png" alt="image-20210727234912509"></p>
<p>新建状态Jump，添加motion JumpUp</p>
<p><img src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210727234920.png" alt="image-20210727234920061"></p>
<p>运行发现并没有叠加动画，因为第二个动画没有添加权重</p>
<p><img src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210727234928.png" alt="image-20210727234928179"></p>
<p>需要注意的是，blending采用的是override模式，所以ArmUp权重越大，手抬得越高，<strong>但是BaseLayer中的walk速度变慢了！！！</strong></p>
<p>而如果采用addtive，则是叠加，整个人都被抬起来，效果就会变得走起路来一震一震的</p>
<h3 id="2-4-2-遮罩mask"><a href="#2-4-2-遮罩mask" class="headerlink" title="2.4.2 遮罩mask"></a>2.4.2 遮罩mask</h3><p>如上所说，如果要某一部分不受影响怎么做呢？<em>手臂抬起来，但是同时也要正常走路</em>，就需要mask遮罩</p>
<p>新建avatar mask，并打开</p>
<p><img src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210727235011.png" alt="image-20210727235011384"></p>
<p>如下图所示将下半身的活动屏蔽</p>
<p><img src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210727235023.png" alt="image-20210727235023829"></p>
<p>为该层的动作选择一层遮罩</p>
<p><img src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210727235032.png" alt="image-20210727235032104"></p>
<p>这时候运行，就可以看到手抬到了最高（权重为1），walk也正常走路</p>
<p><img src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210727235051.png" alt="image-20210727235051059"></p>
<h3 id="2-4-3同步Sync"><a href="#2-4-3同步Sync" class="headerlink" title="2.4.3同步Sync"></a>2.4.3同步Sync</h3><p>Sync按钮的意思是当前层不使用自己的动画状态机，而是用别的层已有的动画状态机。举个例子：走路，如果人物被击中那么走路的姿势就不太一样了，而其他的逻辑一样（如果其他逻辑比较复杂），那么就可以在其他层使用Sync，方便逻辑的复用</p>
<h3 id="2-4-2-脚本方式叠加层"><a href="#2-4-2-脚本方式叠加层" class="headerlink" title="2.4.2 脚本方式叠加层"></a>2.4.2 脚本方式叠加层</h3><p>很多时候需要通过脚本的方式完成更加复杂的动画层逻辑，比如和鼠标交互</p>
<p>下面示例是按下鼠标左键，增加armUp的权重，最后增加到1</p>
<p>新建脚本</p>
<p><img src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210727235104.png" alt="image-20210727235104723"></p>
<p>将脚本拖拽给机器人，并将一开始的ArmUp层权重设置为0，运行就可以看见效果了</p>
<p>一开始手放下，鼠标长按慢慢抬起，松开又慢慢放下</p>
<h2 id="2-5-逆向运动学：注释动画"><a href="#2-5-逆向运动学：注释动画" class="headerlink" title="2.5 逆向运动学：注释动画"></a>2.5 逆向运动学：注释动画</h2><p>前面的场景动画和骨骼动画都属于前向运动学，也就是说每一个骨骼节点的动画效果其实是一层一层推出来的，比如抬起股关节，再抬起膝关节那么就表现为抬腿动作。</p>
<p>但有些情况下需要逆向推导，比如已知前面有个苹果，手指要碰到，那么肘关节和肩关节怎么转才显得比较自然呢？又或者已知一个方位（比如看像鼠标移动的位置），那么逆推头和腰的转向。这种，依靠终端节点（指关节）逆向推演其他节点如何配置的过程就叫做逆向运动学（IK，全称inverse kinematics）</p>
<p>下面的示例就展示机器人的注视点跟随鼠标移动</p>
<p>新建场景、animator controller，添加状态和motion为idle（一种悠闲自然站立，身体轻轻摇动的动作）并拖拽给机器人，新建脚本</p>
<p><img src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210727235125.png" alt="image-20210727235125029"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">void OnAnimatorIK()</span><br><span class="line">&#123;</span><br><span class="line">    Ray ray &#x3D; Camera.main.ScreenPointToRay(Input.mousePosition);    &#x2F;&#x2F; 以MainCamera为起点，mousePosition为方向</span><br><span class="line">    Plane plane &#x3D; new Plane(Vector3.up, transform.position);        &#x2F;&#x2F; 以机器人的中心为平面上一点，(0,1,0)为法线做一个水平面</span><br><span class="line">    float enter &#x3D; 0.0f;                                             &#x2F;&#x2F; 距离</span><br><span class="line">    if (plane.Raycast(ray, out enter))          &#x2F;&#x2F; 平面的方法：计算交点，并将交点和ray原点的距离赋值给enter变量</span><br><span class="line">    &#123;</span><br><span class="line">        Vector3 target &#x3D; ray.GetPoint(enter);   &#x2F;&#x2F; 射线的方法：从原点走enter的距离的点</span><br><span class="line">        anim.SetLookAtPosition(target);         &#x2F;&#x2F; 和相机LookAt不同，是anim中的方法</span><br><span class="line">        anim.SetLookAtWeight(0.3f);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>在动画层勾选IK Pass，表示允许使用IK方式确定角色姿态</p>
<p><img src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210727235153.png" alt="image-20210727235153038"></p>
<p>效果：机器人目光跟随鼠标，实际上是相机和鼠标形成的射线和机器人水平面的交点</p>
<p><img src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210727235206.png" alt="image-20210727235206717"></p>
<p>SetLookAtWeight这个函数可以有多个参数，使得身体，头，眼睛都运动起来</p>
<p>anim.SetLookAtWeight(0.5f, 0.3f, 0.6f, 0.2f);</p>
<p><img src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210727235217.png" alt="image-20210727235217929"></p>
<h2 id="2-6-逆向运动学：末端节点动画"><a href="#2-6-逆向运动学：末端节点动画" class="headerlink" title="2.6 逆向运动学：末端节点动画"></a>2.6 逆向运动学：末端节点动画</h2><p>前面提到，除了注视动画，还有逆向计算手触碰物体时手肘等节点的动画，当然脚也一样。这就是另一种：末端节点动画。</p>
<p>脚本如下</p>
<p><img src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210727235227.png" alt="image-20210727235227527"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line">using System.Collections;</span><br><span class="line">using System.Collections.Generic;</span><br><span class="line">using UnityEngine;</span><br><span class="line"></span><br><span class="line">[RequireComponent(typeof(Animator))]</span><br><span class="line">public class IK2 : MonoBehaviour</span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">    private Animator animator;</span><br><span class="line">    public Transform target;    &#x2F;&#x2F; 手或者其他末端节点需要触碰到的位置</span><br><span class="line">    public Transform hint;      &#x2F;&#x2F; 参考位置：表示手不够长时，需要肘部也改变，肘部节点触碰到的位置</span><br><span class="line">    public bool isHand &#x3D; true;  &#x2F;&#x2F; 我们做一个手和脚的，这个变量判断是手还是脚</span><br><span class="line"></span><br><span class="line">    &#x2F;&#x2F; Start is called before the first frame update</span><br><span class="line">    void Start()</span><br><span class="line">    &#123;</span><br><span class="line">        animator &#x3D; GetComponent&lt;Animator&gt;();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    private void OnAnimatorIK(int layerIndex)</span><br><span class="line">    &#123;</span><br><span class="line">        AvatarIKGoal g &#x3D; isHand ? AvatarIKGoal.RightHand : AvatarIKGoal.RightFoot;  &#x2F;&#x2F; 末端节点</span><br><span class="line">        AvatarIKHint h &#x3D; isHand ? AvatarIKHint.RightElbow : AvatarIKHint.RightKnee; &#x2F;&#x2F; 参考节点</span><br><span class="line">        &#x2F;&#x2F; 末端节点信息：其中的权重表示：是完全触碰目标点还是更多的照顾姿态的自然度</span><br><span class="line">        animator.SetIKPositionWeight(g, 1f);    &#x2F;&#x2F;全部交给ik控制则1，否则在0-1之间</span><br><span class="line">        animator.SetIKPosition(g, target.position);</span><br><span class="line">        animator.SetIKRotationWeight(g, 1f);</span><br><span class="line">        animator.SetIKRotation(g, target.rotation);</span><br><span class="line"></span><br><span class="line">        &#x2F;&#x2F; 参考节点信息</span><br><span class="line">        animator.SetIKHintPositionWeight(h, 1f);</span><br><span class="line">        animator.SetIKHintPosition(h, hint.position); ;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    &#x2F;&#x2F; Update is called once per frame</span><br><span class="line">    void Update()</span><br><span class="line">    &#123;</span><br><span class="line">        </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>新建一个target小球</p>
<p><img src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210727235310.png" alt="image-20210727235310158"></p>
<p><img src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210727235319.png" alt="image-20210727235319062"></p>
<p>为其制作小球掉落再弹起的动画</p>
<p>新建空GameObject作为辅助结点的位置（手臂，膝盖的位置）并放入机器人内部</p>
<p><img src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210727235329.png" alt="image-20210727235329022"></p>
<p>运行</p>
<p><img src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210727235340.png" alt="image-20210727235340732"></p>
<p><img src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210727235346.png" alt="image-20210727235346245"></p>
<p>(脚朝内是小球的方向问题，将小球绕y轴转180即可)</p>
<p>点击isHand切换成手也类似</p>
<p><img src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210727235400.png" alt="image-20210727235400082"></p>
<p><img src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210727235408.png" alt="image-20210727235408612"></p>
<p>可以看出hint节点的位置就是中间节点（手肘，膝盖）触碰的位置</p>
<h2 id="2-7-子状态"><a href="#2-7-子状态" class="headerlink" title="2.7 子状态"></a>2.7 子状态</h2><p>我们已知animator controller可以新建一个状态，unity支持新建子状态，一个状态包含多个子状态，也就是将这几个子状态封装成一个整体。比如有一个状态是 idel-&gt;walk-&gt;run-&gt;idel，也就是将这几个动作封装成一个状态。</p>
<h3 id="2-7-1-创建子状态"><a href="#2-7-1-创建子状态" class="headerlink" title="2.7.1 创建子状态"></a>2.7.1 创建子状态</h3><p>新建场景，放置机器人，新建animation controller，新建状态，新建子状态</p>
<p><img src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210727235423.png" alt="image-20210727235423773"></p>
<p>让idle拥有motion为humannoid idle，make transtion使得idle指向子状态，双击子状态</p>
<p>发现又是一个类似的controller界面</p>
<p><img src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210727235434.png" alt="image-20210727235434507"></p>
<p>创建walk,run,jump动作并连线，最后指向base layer的idle动作</p>
<p><img src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210727235446.png" alt="image-20210727235446200"></p>
<p>这样就完成了类似一个函数栈的效果，返回base layer就可以看到下面的效果</p>
<p><img src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210727235458.png" alt="image-20210727235458083"></p>
<p>将这个controller拖拽给机器人，并使得原地运动，运行</p>
<p>就可以看到一连执行了一串动画，你可能说不用子状态也行，直接全部写外面，当然可以，又不是编程新手了，封不封装都可以的，如果觉得某几个动作都是固定连续发生，可以视为一个动作，就封装吧</p>
<h3 id="2-7-2-带条件转换"><a href="#2-7-2-带条件转换" class="headerlink" title="2.7.2 带条件转换"></a>2.7.2 带条件转换</h3><p>当然也可以指定触发条件</p>
<p>添加trigger类型的参数</p>
<p><img src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210727235522.png" alt="image-20210727235522117"></p>
<p>新建脚本</p>
<p><img src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210727235529.png" alt="image-20210727235528975"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">void Update()</span><br><span class="line">&#123;</span><br><span class="line">    if (Input.GetKeyUp(KeyCode.Space))&#123;</span><br><span class="line">        GetComponent&lt;Animator&gt;().SetTrigger(&quot;start&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>将脚本挂接给机器人，运行，默认idle，只有按下空格才依次进入：walk-&gt;run-&gt;jumpup</p>
<p>同样的可以选择立即触发</p>
<p><img src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210727235550.png" alt="image-20210727235550077"></p>
<h2 id="2-8-blend-tree"><a href="#2-8-blend-tree" class="headerlink" title="2.8 blend tree"></a>2.8 blend tree</h2><p>混合树，和transition类似，可以在多个动画片段之间进行叠加和转换，比如走路过渡到跑步。区别在于transition是一个状态到另一个状态，blend tree可以多个状态作用于角色，各动画可以有自己的权重，然后进行叠加。</p>
<h3 id="2-8-1-创建blend-tree"><a href="#2-8-1-创建blend-tree" class="headerlink" title="2.8.1 创建blend tree"></a>2.8.1 创建blend tree</h3><p>新建场景，添加机器人，新建Animator controller，创建BlendTree状态</p>
<p><img src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210727235603.png" alt="image-20210727235602996"></p>
<p>双击打开，对BlendTree右键可以新建motion，这里建3个</p>
<p><img src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210727235612.png" alt="image-20210727235612097"></p>
<p>添加motion如下：分别是猫腰走（蹲走），正常走和跑步，同时这里修改了参数名称</p>
<p><img src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210727235625.png" alt="image-20210727235625545"></p>
<p>在右上角可以看到blend默认是一维的1D，将controller拖拽到机器人身上，运行，运行过程中可以不断调整Speed，就可以发现在三个动作之间平滑的转换动作了。</p>
<p><img src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210727235633.png" alt="image-20210727235632951"></p>
<p>因此1D的混合树实际效果和transition差不多，只是可能更直观一些。</p>
<h3 id="2-8-2-direct类型"><a href="#2-8-2-direct类型" class="headerlink" title="2.8.2 direct类型"></a>2.8.2 direct类型</h3><p>下面我们将1D改成Direct</p>
<p><img src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210727235642.png" alt="image-20210727235642006"></p>
<p>从每个动作右边栏的变化可以看出，Direct是可以为每个动作添加自己的权重的，我们可以建立3个参数分别赋值给三个动作</p>
<p><img src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210727235650.png" alt="image-20210727235650035"></p>
<p>运行，我们可以在运行的过程中调整各自到合适的权重，运行起来有点奇怪，因为是叠加</p>
<p><img src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210727235659.png" alt="image-20210727235659640"></p>
<p>我们可以对它归一化</p>
<p><img src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210727235707.png" alt="image-20210727235707410"></p>
<p>这样我们就可以自由组合出：猫腰跑，慢跑（或者更像竞走）之类的动作</p>
<p><img src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210727235714.png" alt="image-20210727235714724"></p>
<h3 id="2-8-3-二维笛卡尔坐标"><a href="#2-8-3-二维笛卡尔坐标" class="headerlink" title="2.8.3 二维笛卡尔坐标"></a>2.8.3 二维笛卡尔坐标</h3><p>是以x y轴的二维布点方式，点和点中间的空白通过插值进行。</p>
<p>这里我们xy轴设置的好，可以当成俯视图来进行布点，因此轴的意义定义很重要</p>
<p><img src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210727235732.png" alt="image-20210727235732217"></p>
<p>运行并调参，向左向右跑步或者走路</p>
<p><img src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210727235737.png" alt="image-20210727235737611"></p>
<p>简单的做一个脚本进行交互</p>
<p><img src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210727235746.png" alt="image-20210727235746264"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">using System.Collections;</span><br><span class="line">using System.Collections.Generic;</span><br><span class="line">using UnityEngine;</span><br><span class="line">using UnityStandardAssets.CrossPlatformInput;</span><br><span class="line"></span><br><span class="line">[RequireComponent(typeof(Animator))]</span><br><span class="line">public class BlendTree : MonoBehaviour</span><br><span class="line">&#123;</span><br><span class="line">    Animator anim &#x3D; null;</span><br><span class="line">    &#x2F;&#x2F; Start is called before the first frame update</span><br><span class="line">    void Start()</span><br><span class="line">    &#123;</span><br><span class="line">        anim &#x3D; GetComponent&lt;Animator&gt;();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    &#x2F;&#x2F; Update is called once per frame</span><br><span class="line">    void Update()</span><br><span class="line">    &#123;</span><br><span class="line">        &#x2F;&#x2F; 跨平台的wsad控制</span><br><span class="line">        float h &#x3D; CrossPlatformInputManager.GetAxis(&quot;Horizontal&quot;);</span><br><span class="line">        float v &#x3D; CrossPlatformInputManager.GetAxis(&quot;Vertical&quot;);</span><br><span class="line">        Vector3 move &#x3D; v * Vector3.forward + h * Vector3.right;</span><br><span class="line"></span><br><span class="line">        if (Input.GetKey(KeyCode.LeftShift)) move.z *&#x3D; 0.5f;    &#x2F;&#x2F; 当按下左shift键时从跑步变为走路，变慢</span><br><span class="line"></span><br><span class="line">        float turn &#x3D; move.x;</span><br><span class="line">        float forward &#x3D; move.z;</span><br><span class="line">        anim.SetFloat(&quot;Speed&quot;, forward, 0.1f, Time.deltaTime);</span><br><span class="line">        anim.SetFloat(&quot;turn&quot;, turn, 0.1f, Time.deltaTime);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>拖拽给机器人，运行，按下wad，和左shift，自己体验吧</p>
<h1 id="3-图形渲染"><a href="#3-图形渲染" class="headerlink" title="3. 图形渲染"></a>3. 图形渲染</h1><h2 id="3-1-全局光照明效果"><a href="#3-1-全局光照明效果" class="headerlink" title="3.1 全局光照明效果"></a>3.1 全局光照明效果</h2><p>光照分为方向光（新建场景时默认那个太阳就是方向光），点光源，聚光灯和面积光</p>
<p>前三种都属于直接光源，也就是对物体表面产生了直接的影响，用于实时光照，计算量小</p>
<p>为了渲染出更加真实的效果，面积光可以进行预计算，这种计算量很大，通常用于静态渲染，因为物体移动了就会破坏预计算的效果。</p>
<p>当我们创建一种光照的时候，是没有阴影的，如果需要阴影可以自己打开</p>
<p><img src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210727235812.png" alt="image-20210727235812635"></p>
<p>soft会模糊阴影的边缘。</p>
<p>对于预计算的光照，结果会被烘焙成light map保存，在window-&gt;rendering-&gt;lighting中可以看到auto general这个框框，如果打上，会对场景中勾选了static的物体进行自动烘焙，当然，为了开发时的性能，可以关闭，在发布之前进行一次烘焙。因此，对于不动的物体，我们最好设置为static，可以得到光照效果的优化。</p>
<p><img src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210727235820.png" alt="image-20210727235820794"></p>
<p>如下图，可以看到设置成static后，绿的的物体的阴影有一点点的绿色，其他物体也一样，更加富有表现力，如果没有static的物体，是不参与这种晕染的</p>
<p><img src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210727235831.png" alt="image-20210727235831205"></p>
<h2 id="3-2-材质，着色器和纹理"><a href="#3-2-材质，着色器和纹理" class="headerlink" title="3.2 材质，着色器和纹理"></a>3.2 材质，着色器和纹理</h2><p>光影计算中很重要的三个概念：material，shader，texture</p>
<p>新建一个材质，可以看见材质中包含了shader和uv纹理贴图等各种信息</p>
<p><img src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210727235839.png" alt="image-20210727235838928"></p>
<p>着色器：像素着色器是负责渲染材质颜色的程序片段，顶点着色器就负责材质表面纹理，法线贴图（粗糙程度），反射率等东西。默认是标准</p>
<p>rendering mode：Opaque是不透明，cutout可以选透明度，fade是消隐可以实现淡入淡出，transparent是透明可以设置透明通道</p>
<p>albedo是基本的颜色，点击圆圈可以选纹理</p>
<p><img src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210727235848.png" alt="image-20210727235848225"></p>
<p>cutout透明，可以调节透明度</p>
<p><img src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210727235856.png" alt="image-20210727235856496"></p>
<p>fade，可以根据alpha通道（RGBA中的A）逐步消隐掉物体，跟多的用于魔法效果</p>
<p>transparent也一样，不过会保留光照信息，更多的用于玻璃效果</p>
<p><img src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210727235906.png" alt="image-20210727235906433"></p>
<p>metallic可以控制金属效果</p>
<p>smoothness可以控制平滑程度，更加接近镜面</p>
<p>normal map保存了法线信息，用于法线贴图</p>
<p>height map 和法线贴图类似，需要和nomal map结合使用，normalmap只是效果改变了，而heightmap使得几何体实际表面受到影响</p>
<p>当然上述所有效果都是基于standard的shader，unity其实自带了许多比如卡通效果，手绘或者简笔画效果等着色器</p>
<p><img src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210727235916.png" alt="image-20210727235916052"></p>
<h2 id="3-3-摄像机设置"><a href="#3-3-摄像机设置" class="headerlink" title="3.3 摄像机设置"></a>3.3 摄像机设置</h2><p>可以建立多个摄像机（比如很多游戏的小地图其实是个顶视角摄像机），创建方法和创建普通GameObject一样。</p>
<p>默认主相机main camera会被覆盖，是根据depth覆盖的，主相机的depth是最小的-1，后面建立的相机依次是0，1，2…</p>
<p><img src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210727235924.png" alt="image-20210727235924781"></p>
<p>如果要多个相机并存，只需要缩小其他摄像机的宽高。因为原理是这样的：其实相机覆盖，就是有一个宽度和默认相机一样的视图直接覆盖了底部的…（我觉得unity是不是有点随便？？）</p>
<p><img src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210727235931.png" alt="image-20210727235931797"></p>
<h2 id="3-4-剔除"><a href="#3-4-剔除" class="headerlink" title="3.4 剔除"></a>3.4 剔除</h2><p>也就是不渲染相机看不到的地方</p>
<p><img src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210727235942.png" alt="image-20210727235942858"></p>
<p>点击右下角的bake，unity会对static物体进行剔除（消隐），注意一定要是static的</p>
<p><img src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210727235951.png" alt="image-20210727235951019"></p>
<p>除了视野外，还有遮挡，试试创建一个巨大的物体挡住相机并重新bake一下，发现也挡住了</p>
<p><img src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210728000003.png" alt="image-20210728000003264"></p>
<p>当把物体去除后需要重新bake，否则会维持原效果</p>
<p><img src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210728000010.png" alt="image-20210728000010022"></p>
<h2 id="3-5-后处理效果PostProcess"><a href="#3-5-后处理效果PostProcess" class="headerlink" title="3.5 后处理效果PostProcess"></a>3.5 后处理效果PostProcess</h2><p>又叫做全屏幕处理效果，在真正渲染到屏幕之前对后备缓存里的图像处理。可以添加一些比如色调啊之类的。</p>
<p>1.为摄像机添加后处理层</p>
<p>Component-&gt;Rendering-&gt;Post-Process Layer</p>
<p>如果没有这个组件，先在package manager下载</p>
<p><img src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210728000020.png" alt="image-20210728000020419"></p>
<p><img src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210728000025.png" alt="image-20210728000025140"></p>
<p>Layer选择PostProcessing，没有就自己新建自定义一个</p>
<p>2.在场景中添加后处理体</p>
<p><img src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210728000038.png" alt="image-20210728000038279"></p>
<p>是一个大大的绿色cube，不过多了box collider组件</p>
<p><img src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210728000046.png" alt="image-20210728000046090"></p>
<p><img src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210728000050.png" alt="image-20210728000050851"></p>
<p>而Profile就是具体的后处理方法，直接新建，双击定位，打开</p>
<p><img src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210728000058.png" alt="image-20210728000058884"></p>
<p>双击后如下图添加一个，</p>
<p><img src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210728000106.png" alt="image-20210728000106289"></p>
<p><img src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210728000112.png" alt="image-20210728000112760"></p>
<h2 id="3-6-探针"><a href="#3-6-探针" class="headerlink" title="3.6 探针"></a>3.6 探针</h2><p>预处理只能用于静态物体，对于非静态物体，如果需要效果优化，可以使用探针。</p>
<p>探针是在场景中提前布点，如果运动物体移动到了探针区域内，就进行渲染效果优化。</p>
<h3 id="3-6-1-光照探针"><a href="#3-6-1-光照探针" class="headerlink" title="3.6.1 光照探针"></a>3.6.1 光照探针</h3><p>建立如下场景</p>
<p><img src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210728000122.png" alt="image-20210728000122021"></p>
<p>为框框中的两个物体添加左右移动动画，接下来添加探针组</p>
<p><img src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210728000129.png" alt="image-20210728000129190"></p>
<p><img src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210728000133.png" alt="image-20210728000133772"></p>
<p>这些黄色的点就是探针，场景复杂的时候可以添加的密一点（探针组属性页面可以看到add probe选项，添加探针）</p>
<p><img src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210728000141.png" alt="image-20210728000141862"></p>
<p>想改变探针布点位置或者添加探针都要先点上图那个允许修改，下面运行，可以看到物体移动时会检测受影响的探针</p>
<p>移动的物体左边有轻微的晕染绿色，右边有轻微的晕染红色效果</p>
<p><img src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210728000155.png" alt="image-20210728000154921"></p>
<h3 id="3-6-2-反射探针"><a href="#3-6-2-反射探针" class="headerlink" title="3.6.2 反射探针"></a>3.6.2 反射探针</h3><p>需要注意的是开启全局光照烘焙，最好一直都开（虽然很吃电脑性能），否则看不到反射效果，将圆变为透明度反射球体</p>
<p><img src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210728000203.png" alt="image-20210728000203801"></p>
<p>运行，透明球效果比较生硬，不会改变</p>
<p><img src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210728000210.png" alt="image-20210728000210634"></p>
<p>点击添加多个反射探针</p>
<p><img src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210728000218.png" alt="image-20210728000218776"></p>
<p>运行，发现移动时反射球会改变了</p>
<p><img src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210728000228.png" alt="image-20210728000227951"></p>
<p><img src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210728000233.png" alt="image-20210728000233408"></p>
<p><img src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210728000246.png" alt="image-20210728000246321"></p>
<p>不管是反射探针还是光照探针，其实就是预处理渲染信息存储在探针中，等到运行的时候将附近各探针的存储的信息进行一个叠加融合作为当前运动到某个位置时的渲染信息，从而提高场景的真实感。</p>
<h2 id="3-7-视频播放"><a href="#3-7-视频播放" class="headerlink" title="3.7 视频播放"></a>3.7 视频播放</h2><p>选中墙壁平面，component-&gt;video-&gt;video player，视频播放的原理是改变了墙壁的材质..</p>
<p><img src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210728000258.png" alt="image-20210728000258675"></p>
<p>也可以选择URL</p>
<p><img src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210728000306.png" alt="image-20210728000306789"></p>
<p>当然，以上不涉及到视频的控制，但有时候我们需要对视频进行控制。比如空格暂停</p>
<p>新建c#脚本</p>
<p><img src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210728000313.png" alt="image-20210728000313216"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">using System.Collections;</span><br><span class="line">using System.Collections.Generic;</span><br><span class="line">using UnityEngine;</span><br><span class="line">using UnityEngine.Video;</span><br><span class="line"></span><br><span class="line">public class VedioCOntrol : MonoBehaviour</span><br><span class="line">&#123;</span><br><span class="line">    VideoPlayer videoPlayer;</span><br><span class="line">    &#x2F;&#x2F; Start is called before the first frame update</span><br><span class="line">    void Start()</span><br><span class="line">    &#123;</span><br><span class="line">        videoPlayer &#x3D; GetComponent&lt;VideoPlayer&gt;();</span><br><span class="line">        Debug.Assert(videoPlayer);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    &#x2F;&#x2F; Update is called once per frame</span><br><span class="line">    void Update()</span><br><span class="line">    &#123;</span><br><span class="line">        if (Input.GetKeyDown(KeyCode.Space))</span><br><span class="line">        &#123;</span><br><span class="line">            if (videoPlayer.isPlaying) videoPlayer.Pause();</span><br><span class="line">            else videoPlayer.Play();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="3-8-粒子系统"><a href="#3-8-粒子系统" class="headerlink" title="3.8 粒子系统"></a>3.8 粒子系统</h2><p>用于廉价而实用的特效，比如爆炸，烟雾，沙尘。会比直接贴多帧图效果好很多</p>
<p><img src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210728000336.png" alt="image-20210728000336326"></p>
<p><img src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210728000340.png" alt="image-20210728000340375"></p>
<p>直接就能看到效果，雪花往上飘</p>
<p>我们制作别的效果只需要编辑参数，比如制作火焰</p>
<p>右边很多选项卡的</p>
<p>基本选项卡：start speed 往上升的速度慢点，start color颜色调为火焰色</p>
<p>shape选项卡：angle是往上升的时候的散发度，调为0，radius是出生点那个圈的范围大小，适当调小，使得火焰更集中</p>
<p>随时间的函数选项卡：</p>
<p><img src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210728000347.png" alt="image-20210728000347742"></p>
<p>可以为其添加子GameObject橙色点光源就可以照亮，也可以将火焰的纹理拖拽给它，是图片的形式，背景要透明，类似布告板，虽然是图片，但是面向摄像机，效果就好像立体的。</p>
<p>当然这样做出来的效果都比较简单，标准资源包有一些预实现，可以拉出来看看，做的很完备，像什么爆炸呀，火焰呀，沙尘暴，烟雾之类的</p>
<p><img src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210728000357.png" alt="image-20210728000357069"></p>
<h1 id="4-UI"><a href="#4-UI" class="headerlink" title="4. UI"></a>4. UI</h1><p>UI不是指3D的物体，而是游戏开始界面的按钮呀，图片呀，文字之类的，当然游戏里面也有。</p>
<p>新建GameObject-&gt;UI-&gt;Text/Image/Button</p>
<p>为Text新建脚本，内容是一个函数，当函数调用时改变文本</p>
<p>选中button，属性框onclick点击+号，选择Text控件，并选择刚刚写的函数</p>
<p>canvas有个属性叫render mode 可以选择是delay永远显示在屏幕空间，还是camera某个相机的屏幕空间，还是世界空间（虽然是二维的，实际上变成了3D的物体）</p>
<p><img src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210728000411.png" alt="image-20210728000411262"></p>
<h1 id="5-物理系统"><a href="#5-物理系统" class="headerlink" title="5. 物理系统"></a>5. 物理系统</h1><h2 id="5-1-物理仿真基础"><a href="#5-1-物理仿真基础" class="headerlink" title="5.1 物理仿真基础"></a>5.1 物理仿真基础</h2><p>collider：碰撞检测</p>
<p>regid：刚体（比如重力，或者其他力）</p>
<p>新建如下场景，为墙壁添加材质并画好颜色</p>
<p><img src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210728000425.png" alt="image-20210728000425064"></p>
<p>给小球添加rigid body</p>
<p><img src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210728000433.png" alt="image-20210728000433181"></p>
<p>运行，小球会自由落体</p>
<p><img src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210728000440.png" alt="image-20210728000440257"></p>
<p>在collider里可以看到材质，这个材质不同于普通材质，叫做物理材质，类比生活来说，这个应该叫做“材料”，而普通材质应该对应“涂料”</p>
<p><img src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210728000447.png" alt="image-20210728000447041"></p>
<p>添加物理材质</p>
<p><img src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210728000453.png" alt="image-20210728000453437"></p>
<p>拖拽给球体可以自动复制material，双击可以设置摩擦力和弹跳，弹跳为0~1</p>
<p>运行，可以看见皮球效果</p>
<p><img src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210728000503.png" alt="image-20210728000503172"></p>
<p>为小球添加一个恒力（固定方向的力）</p>
<p><img src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210728000511.png" alt="image-20210728000511382"></p>
<p><img src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210728000517.png" alt="image-20210728000517169"></p>
<p>这四个力参数依次是世界空间，局部空间，世界空间力矩，局部空间力矩</p>
<p>可以把小球靠近一点墙，在掉落过程中撞到地面，运行</p>
<p><img src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210728000524.png" alt="image-20210728000524328"></p>
<p>发现坐标轴会来回转动，这是因为小球落地后会有摩擦和滚动效果（是的添加材质后就自动带有这些功能），导致局部的坐标一直随着滚动变化</p>
<p>可以在rigid body属性中进行约束，阻止滚动</p>
<p><img src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210728000530.png" alt="image-20210728000530079"></p>
<h2 id="5-2-仿真子弹效果"><a href="#5-2-仿真子弹效果" class="headerlink" title="5.2 仿真子弹效果"></a>5.2 仿真子弹效果</h2><p>制作根据蓄力发射子弹的效果，蓄力时间越长射的越远</p>
<h3 id="5-2-1-预制件"><a href="#5-2-1-预制件" class="headerlink" title="5.2.1 预制件"></a>5.2.1 预制件</h3><p>将小球直接拖拽到unity资源管理器窗口即可让某个GameObject及其附带的所有属性称为一个可复用的预制件</p>
<p><img src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210728000539.png" alt="image-20210728000539211"></p>
<p>新建脚本，脚本完成的功能是：利用子弹的恒力组件来施加蓄力效果</p>
<p>利用射线查询功能计算生成的子弹方向</p>
<p><img src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210728000545.png" alt="image-20210728000545515"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">public class fire : MonoBehaviour</span><br><span class="line">&#123;</span><br><span class="line">    public ConstantForce bullet;    &#x2F;&#x2F; bullet不能用Transform，而是ConstantForce属性</span><br><span class="line">    private float pressedTime &#x3D; 0f;</span><br><span class="line">    </span><br><span class="line">    &#x2F;&#x2F; Start is called before the first frame update</span><br><span class="line">    void Start()</span><br><span class="line">    &#123;</span><br><span class="line">        </span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    &#x2F;&#x2F; Update is called once per frame</span><br><span class="line">    void Update()</span><br><span class="line">    &#123;</span><br><span class="line">        if (Input.GetButton(&quot;Fire1&quot;))</span><br><span class="line">        &#123;</span><br><span class="line">            pressedTime +&#x3D; Time.deltaTime;</span><br><span class="line">        &#125;</span><br><span class="line">        if (Input.GetButtonUp(&quot;Fire1&quot;))</span><br><span class="line">        &#123;</span><br><span class="line">            &#x2F;&#x2F; 从摄像机到鼠标点生成一条射线</span><br><span class="line">            Ray ray &#x3D; Camera.main.ScreenPointToRay(Input.mousePosition);</span><br><span class="line">            RaycastHit hit; &#x2F;&#x2F;存储射线和xx的交点</span><br><span class="line">            if (Physics.Raycast(ray, out hit))</span><br><span class="line">            &#123;</span><br><span class="line">                &#x2F;&#x2F; 不能是GetComponent而是Instantiate表示从预制件复制出一个子弹，起始位置为射线的起点（相机），方向为射线方向</span><br><span class="line">                ConstantForce cf &#x3D; Instantiate&lt;ConstantForce&gt;(bullet, ray.origin, </span><br><span class="line">                    Quaternion.LookRotation(hit.point - ray.origin));</span><br><span class="line">                &#x2F;&#x2F; 添加局部空间恒力</span><br><span class="line">                cf.relativeForce &#x3D; new Vector3(0f, 0f, pressedTime * 10);</span><br><span class="line">            &#125;</span><br><span class="line">            pressedTime &#x3D; 0f;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>如果子弹偏了是因为预制件复制的子弹默认恒力不是z轴的10</p>
<h2 id="5-3-关节结构"><a href="#5-3-关节结构" class="headerlink" title="5.3 关节结构"></a>5.3 关节结构</h2><p>joint可以约束一些物理运动</p>
<p>使用空物体作为约束体</p>
<p>建立两个空物体并分别赋予hinge和spring的joint属性</p>
<p><img src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210728000607.png" alt="image-20210728000607459"></p>
<p><img src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210728000614.png" alt="image-20210728000614203"></p>
<h3 id="hinge-joint"><a href="#hinge-joint" class="headerlink" title="hinge joint"></a>hinge joint</h3><p>hinge joint就是类似肘关节这样的关节，绕轴转，或者理解为能挂在空气中的挂钩/钉子</p>
<p>hinge自带rigid body，其中的connected body是要约束的物体</p>
<p>新建一个cube并赋予rigid body属性，放在hinge joint附近位置，拖拽进入connected body</p>
<p><img src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210728000621.png" alt="image-20210728000621476"></p>
<p><img src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210728000625.png" alt="image-20210728000625828"></p>
<h3 id="spring-joint"><a href="#spring-joint" class="headerlink" title="spring joint"></a>spring joint</h3><p>空间中的弹簧，能够悬挂物体，操作都类似</p>
<p>悬挂物体后，可以对物体进行子弹打击，尤其是弹簧悬挂的物体，效果很有趣</p>
<h3 id="破坏joint"><a href="#破坏joint" class="headerlink" title="破坏joint"></a>破坏joint</h3><p>joint有个break force属性，就是说收到多少力的时候断开约束，我们可以给hinge一个较大的断开力比如1000，spring joint设置为30</p>
<p><img src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210728000633.png" alt="image-20210728000633200"></p>
<p>运行，就能发现spring joint悬挂的方块被子弹一打击就掉落，而hinge悬挂的方块需要一定的蓄力才能打掉</p>
<p>脚本，破坏事件可以通过脚本捕获到，我们写一个脚本捕获打击的力度</p>
<p>这里直接在unity控制台打印</p>
<p><img src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210728000643.png" alt="image-20210728000643677"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">private void OnJointBreak(float breakForce)</span><br><span class="line">&#123;</span><br><span class="line">    Debug.Log(&quot;this force is: &quot; + breakForce);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>运行</p>
<p><img src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210728000659.png" alt="image-20210728000659707"></p>
<p>当然可以试试使用UI空间在屏幕空间右上角记录分数等简单游戏</p>
<h2 id="5-4-碰撞事件"><a href="#5-4-碰撞事件" class="headerlink" title="5.4 碰撞事件"></a>5.4 碰撞事件</h2><p>比如我们玩游戏时遇到的反弹或者突然加速效果，本质都是检测到碰撞之后施加特殊的物理效果。新建一个cube并赋予透明材质</p>
<p><img src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210728000707.png" alt="image-20210728000707090"></p>
<p>cube有个属性叫isTrigger</p>
<p><img src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210728000714.png" alt="image-20210728000714861"></p>
<p>也就是触发碰撞，如果勾选，那么碰撞时物体不会碰撞而是会穿透物体，适合做一些水面效果。</p>
<p>下面我们模拟一个加速带效果：当穿透这个半透明物体时给子弹进行一个赋力，使子弹加速</p>
<p>首先给子弹添加tag，方便我们控制所有子弹</p>
<p><img src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210728000721.png" alt="image-20210728000721527"></p>
<p>新建脚本</p>
<p><img src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210728000731.png" alt="image-20210728000730938"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">private void OnCollisionEnter(Collision collision)</span><br><span class="line">    &#123;</span><br><span class="line">        if (collision.gameObject.tag !&#x3D; &quot;Bullet&quot;)</span><br><span class="line">            return;</span><br><span class="line">        Destroy(collision.gameObject);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    private void OnTriggerStay(Collider other)</span><br><span class="line">    &#123;</span><br><span class="line">        if (other.tag !&#x3D; &quot;Bullet&quot;)</span><br><span class="line">            return;</span><br><span class="line">        if (other.attachedRigidbody)</span><br><span class="line">            other.attachedRigidbody.AddForce(Vector3.up * 30);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p>运行，碰到半透明方块时就会弹起</p>
<h1 id="6-人工智能"><a href="#6-人工智能" class="headerlink" title="6. 人工智能"></a>6. 人工智能</h1><h2 id="6-1-自动寻路"><a href="#6-1-自动寻路" class="headerlink" title="6.1 自动寻路"></a>6.1 自动寻路</h2><p>先建立如下场景，胶囊体模拟小人</p>
<p><img src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210728000749.png" alt="image-20210728000749892"></p>
<p>同时为小人添加NavMeshAgent属性</p>
<p><img src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210728000756.png" alt="image-20210728000756620"></p>
<p>接下来我们编写一个脚本让小人移动到指定位置，需要用到一个AI库中的NavMeshAgent属性</p>
<p><img src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210728000808.png" alt="image-20210728000808721"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">using System.Collections;</span><br><span class="line">using System.Collections.Generic;</span><br><span class="line">using UnityEngine;</span><br><span class="line">using UnityEngine.AI;</span><br><span class="line"></span><br><span class="line">public class Actor : MonoBehaviour</span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">    public Transform goal;  &#x2F;&#x2F; 目标</span><br><span class="line">    private NavMeshAgent agent; &#x2F;&#x2F;AI库的一个寻路属性类</span><br><span class="line"></span><br><span class="line">    &#x2F;&#x2F; Start is called before the first frame update</span><br><span class="line">    void Start()</span><br><span class="line">    &#123;</span><br><span class="line">        agent &#x3D; GetComponent&lt;NavMeshAgent&gt;();</span><br><span class="line">        agent.destination &#x3D; goal.position;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    &#x2F;&#x2F; Update is called once per frame</span><br><span class="line">    void Update()</span><br><span class="line">    &#123;</span><br><span class="line">        </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>将脚本挂接到胶囊身上，可以看到有个public的参数，也就是目标，我们可以创建一个空GameObject作为目标</p>
<p>现在运行还不会自动寻路，还需要一些预计算：</p>
<p><img src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210728000825.png" alt="image-20210728000825526"></p>
<p><img src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210728000830.png" alt="image-20210728000830261"></p>
<p>也就是说，所谓的自动寻路算法需要对现有场景进行烘焙（预计算），那么我们就需要将一些不动的物体设置为static属性（地面，障碍物等），如果障碍物没有被静态烘焙，那么会直接穿过去（也就是没有绕过障碍物进行寻路）</p>
<p>运行，就能自动寻路了，除了避障之外，还会自动寻找最短的路径</p>
<p><img src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210728000843.png" alt="image-20210728000843780"></p>
<p>修改脚本，实现点击移动到鼠标指定位置</p>
<p><img src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210728000851.png" alt="image-20210728000851702"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">void Update()</span><br><span class="line">&#123;</span><br><span class="line">    if (Input.GetMouseButtonDown(0)) &#123;</span><br><span class="line">        RaycastHit hit;</span><br><span class="line">        if (Physics.Raycast(Camera.main.ScreenPointToRay(Input.mousePosition), out hit, 100)) &#123;</span><br><span class="line">            agent.destination &#x3D; hit.point;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>运行点击鼠标左键可以看到效果</p>
<h3 id="台阶跳跃"><a href="#台阶跳跃" class="headerlink" title="台阶跳跃"></a>台阶跳跃</h3><p>当我们点击高台的时候发现不能跳上去，只能寻路到离高台最近的位置</p>
<h4 id="方式1：设置set-height"><a href="#方式1：设置set-height" class="headerlink" title="方式1：设置set height"></a>方式1：设置set height</h4><p>属性框有个设置跳跃高度，每次设置完都要bake</p>
<p><img src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210728000908.png" alt="image-20210728000908614"></p>
<p>当我们看到bake后线没了就说明能跳上去了</p>
<p><img src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210728000914.png" alt="image-20210728000914397"></p>
<h4 id="方式2：使用off-mesh-link连接"><a href="#方式2：使用off-mesh-link连接" class="headerlink" title="方式2：使用off mesh link连接"></a>方式2：使用off mesh link连接</h4><p>如果觉得方式1的跳跃不够真实，或者想实现部分游戏里的传送效果（参考马里奥大炮，lol娱乐模式大炮，远程跳跃或者不能直接连接），off mesh link就是这样建立两个物体之间的曲线</p>
<p>下面我们实现直接从地面跳跃到蓝色物体</p>
<p>场景中建立跳跃的起点和终点（cube，终点最好是看得见的..方便演示）</p>
<p><img src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210728000921.png" alt="image-20210728000921715"></p>
<p>并给其中一个跳跃点添加off mesh link组件</p>
<p><img src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210728000928.png" alt="image-20210728000928291"></p>
<p>拖入起点和终点</p>
<p><img src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210728000933.png" alt="image-20210728000933415"></p>
<h3 id="移动的障碍物"><a href="#移动的障碍物" class="headerlink" title="移动的障碍物"></a>移动的障碍物</h3><p>对于移动的障碍物，没有办法设置static，需要通过nav mesh obstacle</p>
<p>在场景中新建一面墙，我们都知道如果不配置static的话运动路线穿过墙的话就会直接穿过去。因此我们为墙添加nav mesh obstacle组件</p>
<p>运行，就能避开这个非static的物体了（虽然这个墙并没有为其添加animation，可以自己添加）</p>
<p><img src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210728000941.png" alt="image-20210728000941454"></p>
<p>说一下carve属性，carve属性能让动态物体也加入烘焙当中</p>
<p><img src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210728000948.png" alt="image-20210728000948334"></p>
<p>勾选以后我们可以看到bake时这面墙周围也有禁止触碰的区域了</p>
<p><img src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210728000954.png" alt="image-20210728000954292"></p>
<p>我们都知道bake是提前计算一些复杂的渲染效果，运行时就可以不再计算，那非static的物体勾选这个carve有什么用呢？那就是针对动态生成但生成以后静止的物体</p>
<p>综上：</p>
<p>static：静止物体</p>
<p>非static：移动物体</p>
<p>非static但carve：动态生成但生成以后静止的物体</p>
<h2 id="6-2-敌人巡逻"><a href="#6-2-敌人巡逻" class="headerlink" title="6.2 敌人巡逻"></a>6.2 敌人巡逻</h2><p>通常游戏里的敌人都有巡逻逻辑，固定的移动某些空间点，遇到玩家后就会追赶，玩家离开范围后回到自己的巡逻路径</p>
<p>在场景中建立敌人，并建立几个巡逻路径点，左上角的为敌人，右下角的为玩家，用一个父GameObject来管理路径点，路径点位置大致如下</p>
<p><img src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210728001002.png" alt="image-20210728001002712"></p>
<p>下面通过脚本使其能按规定移动到各个巡逻点</p>
<p><img src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210728001014.png" alt="image-20210728001014518"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line">using System;</span><br><span class="line">using System.Collections;</span><br><span class="line">using System.Collections.Generic;</span><br><span class="line">using UnityEngine;</span><br><span class="line">using UnityEngine.AI;</span><br><span class="line"></span><br><span class="line">public class Enemy : MonoBehaviour</span><br><span class="line">&#123;</span><br><span class="line">    public float patrolSpeed &#x3D; 3f;      &#x2F;&#x2F; 巡逻移动速度</span><br><span class="line">    public float patrolWaitTime &#x3D; 0.5f; &#x2F;&#x2F; 到达每个巡逻点停一下</span><br><span class="line">    public Transform patrolWayPoints;   &#x2F;&#x2F; 巡逻点都在这个父物体里了，我们直接获取父物体</span><br><span class="line"></span><br><span class="line">    private NavMeshAgent agent;</span><br><span class="line">    private float patrolTimer &#x3D; 0f;     &#x2F;&#x2F; 记录已经停留的时间，大于patrolWaitTime就移动到下一个巡逻点</span><br><span class="line">    private int wayPointIndex &#x3D; 0;      &#x2F;&#x2F; 巡逻点下标</span><br><span class="line"></span><br><span class="line">    &#x2F;&#x2F; Start is called before the first frame update</span><br><span class="line">    void Start()</span><br><span class="line">    &#123;</span><br><span class="line">        agent &#x3D; GetComponent&lt;NavMeshAgent&gt;();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    &#x2F;&#x2F; Update is called once per frame</span><br><span class="line">    void Update()</span><br><span class="line">    &#123;</span><br><span class="line">        Patrolling();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    private void Patrolling()</span><br><span class="line">    &#123;</span><br><span class="line">        agent.isStopped &#x3D; false;</span><br><span class="line">        agent.speed &#x3D; patrolSpeed;</span><br><span class="line">        &#x2F;&#x2F; 判断是否到达某个巡逻点(agent考虑了误差，所以是范围小于该停止的范围)</span><br><span class="line">        if (agent.remainingDistance &lt; agent.stoppingDistance)</span><br><span class="line">        &#123;</span><br><span class="line">            patrolTimer +&#x3D; Time.deltaTime;</span><br><span class="line">            if(patrolTimer &gt; patrolWaitTime)</span><br><span class="line">            &#123;</span><br><span class="line">                if (wayPointIndex &#x3D;&#x3D; patrolWayPoints.childCount - 1)</span><br><span class="line">                    wayPointIndex &#x3D; 0;</span><br><span class="line">                else</span><br><span class="line">                    wayPointIndex++;</span><br><span class="line">                patrolTimer &#x3D; 0f;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        else</span><br><span class="line">        &#123;</span><br><span class="line">            patrolTimer &#x3D; 0f;</span><br><span class="line">        &#125;</span><br><span class="line">        agent.destination &#x3D; patrolWayPoints.GetChild(wayPointIndex).position;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>关于第34行的那个stopping distance是误差范围判断，其实是nav mesh agent提供的一个误差判断，在脚本挂接到敌人后，还需要调整stopping distance的属性值，最好大于0，以为地形可能有高有矮之类的，存在误差，寻路算法可能没有办法完全达到</p>
<p><img src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210728001033.png" alt="image-20210728001033023"></p>
<h2 id="6-3-敌人视野"><a href="#6-3-敌人视野" class="headerlink" title="6.3 敌人视野"></a>6.3 敌人视野</h2><p>下面实现敌人发现玩家的功能</p>
<p>视野功能的本质是collider</p>
<p>创建一个空物体作为敌人的子物体（视野），添加box collider并调整到合适的视野大小，勾选isTrigger仅作为触发器使用，可以避免物理碰撞</p>
<p><img src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210728001043.png" alt="image-20210728001043208"></p>
<p>编写脚本，注意脚本是给这个EnemySight的</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line">using System.Collections;</span><br><span class="line">using System.Collections.Generic;</span><br><span class="line">using UnityEngine;</span><br><span class="line"></span><br><span class="line">public class EnemySight : MonoBehaviour</span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">    public float filedOfView &#x3D; 100f;        &#x2F;&#x2F; 视野角度</span><br><span class="line">    public bool playerInsight &#x3D; false;      &#x2F;&#x2F; 是否发现</span><br><span class="line">    public Vector3 playerLastPos;         &#x2F;&#x2F; 玩家最后位置</span><br><span class="line">    public Vector3 resetPos &#x3D; Vector3.back; &#x2F;&#x2F; 玩家默认位置</span><br><span class="line"></span><br><span class="line">    private BoxCollider col;                &#x2F;&#x2F; 敌人视野碰撞体</span><br><span class="line">    private GameObject player;              &#x2F;&#x2F; 玩家</span><br><span class="line"></span><br><span class="line">    &#x2F;&#x2F; Start is called before the first frame update</span><br><span class="line">    void Start()</span><br><span class="line">    &#123;</span><br><span class="line">        col &#x3D; GetComponent&lt;BoxCollider&gt;();</span><br><span class="line">        player &#x3D; GameObject.FindGameObjectWithTag(&quot;Player&quot;);</span><br><span class="line">        playerLastPos &#x3D; resetPos;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    &#x2F;&#x2F; 碰撞体检测函数</span><br><span class="line">    void OnTriggerStay(Collider other)</span><br><span class="line">    &#123;</span><br><span class="line">        if(other.gameObject &#x3D;&#x3D; player)</span><br><span class="line">        &#123;</span><br><span class="line">            playerInsight &#x3D; false;</span><br><span class="line">            &#x2F;&#x2F; 获得玩家和敌人的连线</span><br><span class="line">            Vector3 dir &#x3D; other.transform.position - transform.position;</span><br><span class="line">            &#x2F;&#x2F; 判断该连线和敌人前方的向量夹角，若大于视野角度的一半（左右两边），就说明玩家可能被看到了</span><br><span class="line">            float angle &#x3D; Vector3.Angle(dir, transform.forward);</span><br><span class="line">            if(angle &lt;&#x3D; filedOfView * 0.5)</span><br><span class="line">            &#123;</span><br><span class="line">                &#x2F;&#x2F; 只是可能被看到而已，还需要判断是否有障碍物，可以构造一条射线，raycast是否仅有玩家而没有别的物体</span><br><span class="line">                RaycastHit hit;</span><br><span class="line">                if(Physics.Raycast(transform.position + transform.up, dir.normalized, out hit, col.size.z))</span><br><span class="line">                &#123;</span><br><span class="line">                    if(hit.collider.gameObject &#x3D;&#x3D; player)</span><br><span class="line">                    &#123;</span><br><span class="line">                        playerInsight &#x3D; true;</span><br><span class="line">                        playerLastPos &#x3D; player.transform.position;</span><br><span class="line">                        Debug.Log(&quot;Find Player&quot;);</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    private void OnTriggerExit(Collider other)</span><br><span class="line">    &#123;</span><br><span class="line">        if(other.gameObject &#x3D;&#x3D; player)</span><br><span class="line">        &#123;</span><br><span class="line">            playerInsight &#x3D; false;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    &#x2F;&#x2F; Update is called once per frame</span><br><span class="line">    void Update()</span><br><span class="line">    &#123;</span><br><span class="line">        </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>需要注意，collider碰撞检测，当然要求player持有rigid body属性，因此要注意给玩家和敌人添加rigid body属性，除此之外还要勾选isKinematic，表示不受动力学影响（比如被墙壁撞开后受了推力，直接被撞开到地图外）</p>
<p><img src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210728001112.png" alt="image-20210728001112392"></p>
<h2 id="6-4-攻击与追踪"><a href="#6-4-攻击与追踪" class="headerlink" title="6.4 攻击与追踪"></a>6.4 攻击与追踪</h2><p>我们将要修改敌人的脚本逻辑，使其除了巡逻功能外还能拥有追踪和射击动作</p>
<p>整个过程如下：1敌人巡逻，2视野发现玩家，3掉头朝向玩家，4开枪射击，5玩家脱离视野，6敌人追踪，返回2直至追不上，返回1</p>
<p><img src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210728001119.png" alt="image-20210728001119408"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line">using System;</span><br><span class="line">using System.Collections;</span><br><span class="line">using System.Collections.Generic;</span><br><span class="line">using UnityEngine;</span><br><span class="line">using UnityEngine.AI;</span><br><span class="line"></span><br><span class="line">public class Enemy : MonoBehaviour</span><br><span class="line">&#123;</span><br><span class="line">    public float patrolSpeed &#x3D; 3f;      &#x2F;&#x2F; 巡逻移动速度</span><br><span class="line">    public float patrolWaitTime &#x3D; 0.5f; &#x2F;&#x2F; 到达每个巡逻点停一下</span><br><span class="line">    public Transform patrolWayPoints;   &#x2F;&#x2F; 巡逻点都在这个父物体里了，我们直接获取父物体</span><br><span class="line"></span><br><span class="line">    private NavMeshAgent agent;</span><br><span class="line">    private float patrolTimer &#x3D; 0f;     &#x2F;&#x2F; 记录已经停留的时间，大于patrolWaitTime就移动到下一个巡逻点</span><br><span class="line">    private int wayPointIndex &#x3D; 0;      &#x2F;&#x2F; 巡逻点下标</span><br><span class="line"></span><br><span class="line">    public float chaseSpeed &#x3D; 6f;       &#x2F;&#x2F; 追踪速度</span><br><span class="line">    public float chaseWaitTime &#x3D; 5f;    &#x2F;&#x2F; 允许追踪时间（超过就判定为追不到）</span><br><span class="line">    private float chaseTimer &#x3D; 0f;      &#x2F;&#x2F; 已经追踪的时间</span><br><span class="line">    public float sqrPlayerDist &#x3D; 4f;     &#x2F;&#x2F; 距离平方，平方是为了简化计算</span><br><span class="line">    private bool chase &#x3D; false;         &#x2F;&#x2F; 是否追到</span><br><span class="line"></span><br><span class="line">    public float shootRotSpeed &#x3D; 4f;    &#x2F;&#x2F; 发现敌人要先掉头</span><br><span class="line">    public float shootFreeTime &#x3D; 2f;    &#x2F;&#x2F; 子弹冷却时间（换弹），不能无线发射子弹</span><br><span class="line">    private float shootTimer &#x3D; 0f;      &#x2F;&#x2F; 已经冷却的时间</span><br><span class="line"></span><br><span class="line">    private EnemySight enemySight;      &#x2F;&#x2F; 直接获取视野所用脚本</span><br><span class="line">    private Transform player;           &#x2F;&#x2F; 玩家</span><br><span class="line"></span><br><span class="line">    public Rigidbody bullet;            &#x2F;&#x2F; 子弹</span><br><span class="line"></span><br><span class="line">    &#x2F;&#x2F; Start is called before the first frame update</span><br><span class="line">    void Start()</span><br><span class="line">    &#123;</span><br><span class="line">        agent &#x3D; GetComponent&lt;NavMeshAgent&gt;();</span><br><span class="line">        enemySight &#x3D; transform.Find(&quot;EnemySight&quot;).GetComponent&lt;EnemySight&gt;();</span><br><span class="line">        player &#x3D; GameObject.FindGameObjectWithTag(&quot;Player&quot;).transform;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    &#x2F;&#x2F; Update is called once per frame</span><br><span class="line">    void Update()</span><br><span class="line">    &#123;</span><br><span class="line">        &#x2F;&#x2F; 在视野内：射击，没视野了：追踪，追不上了：巡逻</span><br><span class="line">        if(enemySight.playerInsight)</span><br><span class="line">        &#123;</span><br><span class="line">            Shoting();  &#x2F;&#x2F; 射击</span><br><span class="line">            chase &#x3D; true;</span><br><span class="line">        &#125;</span><br><span class="line">        else if(chase)</span><br><span class="line">        &#123;</span><br><span class="line">            Chasing();  &#x2F;&#x2F; 追踪</span><br><span class="line">        &#125;</span><br><span class="line">        else</span><br><span class="line">        &#123;</span><br><span class="line">            Patrolling();   &#x2F;&#x2F; 巡逻</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>射击函数</p>
<p><img src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210728001136.png" alt="image-20210728001136236"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">private void Shoting()</span><br><span class="line">&#123;</span><br><span class="line">    &#x2F;&#x2F; 首先掉头朝向玩家</span><br><span class="line">    Vector3 lookPos &#x3D; player.position;</span><br><span class="line">    lookPos.y &#x3D; transform.position.y;   &#x2F;&#x2F; 这里为了简便不进行抬头低头</span><br><span class="line">    Vector3 targetDir &#x3D; lookPos - transform.position;</span><br><span class="line">    transform.rotation &#x3D; Quaternion.Slerp(transform.rotation, Quaternion.LookRotation(targetDir), Mathf.Min(1f, Time.deltaTime * shootRotSpeed));   &#x2F;&#x2F; 使用四元数在xx时间内变成指定方向</span><br><span class="line">    agent.isStopped &#x3D; true;    &#x2F;&#x2F; 寻路过程暂时停止</span><br><span class="line"></span><br><span class="line">    &#x2F;&#x2F; 发动攻击</span><br><span class="line">    if(Vector3.Angle(transform.forward, targetDir) &lt; 2) &#x2F;&#x2F; 不一定要完全面向玩家，大家都会动，允许一定误差</span><br><span class="line">    &#123;</span><br><span class="line">        if(shootTimer &gt; shootFreeTime)</span><br><span class="line">        &#123;</span><br><span class="line">            Instantiate(bullet, transform.position, Quaternion.LookRotation(player.position - transform.position));  &#x2F;&#x2F; 从预制件中创建子弹，并指定位置和方向</span><br><span class="line">            shootTimer &#x3D; 0f;</span><br><span class="line">        &#125;</span><br><span class="line">        shootTimer +&#x3D; Time.deltaTime;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>制作子弹和预制件</p>
<p>子弹不要太大，调整缩放</p>
<p>子弹不受物理系统的碰撞影响，勾选isTrigger</p>
<p>为了方便子弹不受重力影响，取消勾选gravity</p>
<p>给子弹一个往前的恒力，局部坐标z为5</p>
<p><img src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210728001154.png" alt="image-20210728001154154"></p>
<p>为子弹编写脚本</p>
<p><img src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210728001202.png" alt="image-20210728001202232"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">private void OnTriggerEnter(Collider other)</span><br><span class="line">&#123;</span><br><span class="line">    if(other.tag &#x3D;&#x3D; &quot;Player&quot;)</span><br><span class="line">    &#123;</span><br><span class="line">        GameObject.Destroy(other.gameObject);   &#x2F;&#x2F; 一枪直接能打爆玩家狗头</span><br><span class="line">        GameObject.Destroy(gameObject);         &#x2F;&#x2F; 销毁子弹本身</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>挂接给子弹，然后创建预制件并删除默认子弹</p>
<p>将子弹预制件作为参数拖拽给Enemy脚本中的bullet参数</p>
<p><img src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210728001223.png" alt="image-20210728001223408"></p>
<p>现在运行可以看到敌人发射子弹打死玩家了，但是敌人还不会追踪，且射击函数让寻路功能暂停，所以视野捕捉到玩家后就会停下</p>
<p><img src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210728001233.png" alt="image-20210728001232971"></p>
<p>追踪函数</p>
<p><img src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210728001242.png" alt="image-20210728001242525"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">private void Chasing()</span><br><span class="line">&#123;</span><br><span class="line">    &#x2F;&#x2F; 寻路</span><br><span class="line">    agent.isStopped &#x3D; false;    &#x2F;&#x2F; 重新打开寻路功能</span><br><span class="line">    Vector3 sightDeltaVec &#x3D; enemySight.playerLastPos - transform.position;</span><br><span class="line">    if(sightDeltaVec.sqrMagnitude &gt; sqrPlayerDist)  &#x2F;&#x2F; 计算当前敌人和玩家的距离，其实玩家是上一帧因为不可能知道玩家0.几帧的位置</span><br><span class="line">    &#123;</span><br><span class="line">        agent.destination &#x3D; enemySight.playerLastPos;</span><br><span class="line">    &#125;</span><br><span class="line">    agent.speed &#x3D; chaseSpeed;   &#x2F;&#x2F; 将巡逻速度换成追踪速度</span><br><span class="line">    if (agent.remainingDistance &lt; agent.stoppingDistance)</span><br><span class="line">    &#123;</span><br><span class="line">        &#x2F;&#x2F; 走到目标destination的位置时，四处张望一下，如果玩家不见了，就回到巡逻</span><br><span class="line">        chaseTimer +&#x3D; Time.deltaTime;</span><br><span class="line">        if (chaseTimer &gt; chaseWaitTime)</span><br><span class="line">        &#123;</span><br><span class="line">            chase &#x3D; false;</span><br><span class="line">            chaseTimer &#x3D; 0f;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    else</span><br><span class="line">        chaseTimer &#x3D; 0f;    &#x2F;&#x2F; 一直处于追踪状态，不可能因为时间就不追了，一直归0</span><br><span class="line"></span><br><span class="line">    enemySight.playerInsight &#x3D; false;</span><br><span class="line">    return;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>运行，可以看到敌人可以巡逻，追踪，射击，重新巡逻</p>
<h1 id="7-音频"><a href="#7-音频" class="headerlink" title="7. 音频"></a>7. 音频</h1><h2 id="7-1-音频基础"><a href="#7-1-音频基础" class="headerlink" title="7.1 音频基础"></a>7.1 音频基础</h2><p>可以直接将音频文件拖拽到场景，会自动建立一个GameObject，附带Audio Source组件，其中的AudioClip属性就是这段音频，而output可以指定一个audio listener，audio listener是音频接收器来模拟人的耳朵，添加音频时默认为main camera添加一个audio listener组件</p>
<p><img src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210728001305.png" alt="image-20210728001305357"></p>
<p>3D音效：spatial blend拉成3D就可以，运行时镜头的位置决定了声音方向在哪里</p>
<p>mute：暂时静音</p>
<p>Bypass Effects：忽略音效（音效和音量是不一样的）</p>
<p>Play On Awake：自动播放</p>
<p>Loop：循环播放</p>
<p>Priority：优先级0~256</p>
<p>Volume：音量</p>
<p>Pitch：声音播放频率（倍速）</p>
<p>Stereo Pan：声音方向，只对2D声音有影响，3D情况下只跟位置有关</p>
<p>Reverb Zone Mix：决定多少输出信号给回声区域</p>
<p>Doppler Level：多普勒效应</p>
<blockquote>
<p><a href="https://baike.baidu.com/item/%E5%A4%9A%E6%99%AE%E5%8B%92%E6%95%88%E5%BA%94/115710?fr=aladdin">https://baike.baidu.com/item/%E5%A4%9A%E6%99%AE%E5%8B%92%E6%95%88%E5%BA%94/115710?fr=aladdin</a></p>
</blockquote>
<p>Spread：3D音源的发射角度</p>
<p>Volume Rolloff：距离和音量的函数</p>
<p>Max Distance：声音传播最大距离</p>
<h2 id="7-2-混音器"><a href="#7-2-混音器" class="headerlink" title="7.2 混音器"></a>7.2 混音器</h2><p>对多个声音进行控制</p>
<p><img src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210728001336.png" alt="image-20210728001336769"></p>
<p>可以通过不同的组来控制不同的音源（属性中的output对应这里不同的组）</p>
<p><img src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210728001345.png" alt="image-20210728001345366"></p>
<p><img src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210728001349.png" alt="image-20210728001349876"></p>
<p>运行，就可以发现多个组对应的音源同时播放了，可以编辑各个组的音频文件的权重，达到混音效果。</p>
<p>父group的调整会影响他的所有子物体</p>
<p>SMB按钮的意思是</p>
<p>S：solo单独播放</p>
<p>M：mute静音</p>
<p>B：bypass取消音效</p>
<p>当我们调整到觉得适合的混音效果时，可以点击Snapshots，保存当前的参数快照</p>
<p>Views：也是可以保存多份，但是保存的是group可见性的自由组合，比如第一份屏蔽了effect，第二份屏蔽了background</p>
<p>Mixer也可以有层次关系：一个混音器控制另一个混音器，比如我们想玩家点空格的时候一种音效，点回车的时候另一种音效</p>
<p>首先拖拽两个音源shoot和explode模拟开枪和跳跃，并管理在父controller下（译为玩家控制音频），创建一个audio mixer对应这个控制音频（这里名字是SoundEffect），两个音频都将output设置为SoundEffect</p>
<p><img src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210728001359.png" alt="image-20210728001359598"></p>
<p>接下来添加一个组PlayerSound，再将刚才的SoundEffect混音器作为Music混音器的子混音器，并选择组为PlayerSound</p>
<p><img src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210728001406.png" alt="image-20210728001406036"></p>
<p>当然，交互需要脚本</p>
<p><img src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210728001414.png" alt="image-20210728001414870"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">public class Controller : MonoBehaviour &#123;</span><br><span class="line">    public AudioSource shootSnd;</span><br><span class="line">    public AudioSource explodeSnd;</span><br><span class="line">    </span><br><span class="line">	&#x2F;&#x2F; Update is called once per frame</span><br><span class="line">	void Update () &#123;</span><br><span class="line">        if (Input.GetMouseButtonDown(0))</span><br><span class="line">            shootSnd.Play();</span><br><span class="line">        if (Input.GetKeyDown(KeyCode.Space))</span><br><span class="line">            explodeSnd.Play();</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>挂接给controller并将对应的音源GameObject作为参数传递进去，运行，便可以发现既有背景音乐，也有子物体（用户操作时的音源）了</p>
<p><img src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210728001433.png" alt="image-20210728001433227"></p>
<h2 id="7-3-音效"><a href="#7-3-音效" class="headerlink" title="7.3 音效"></a>7.3 音效</h2><p>音效和音频不一样，音频是一段mp3，音效是比如回音，空旷，人声之类的</p>
<p>新建场景，拖入背景音乐音频，并创建一个混音器（这里叫AudioEffectDemo），混音器添加两个group分别作为音乐和音效</p>
<p><img src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210728001440.png" alt="image-20210728001440811"></p>
<p>将music作为音频的output，运行测试music的参数是否能调整声音大小</p>
<p>下面对effect组点击Add添加音效，unity为我们提供了许多内置音效，这里选择SFX Reverb（回声）</p>
<p><img src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210728001452.png" alt="image-20210728001451952"></p>
<p>回声需要知道来自什么的回声，所以我们给effects添加一个Receive，给music添加一个send</p>
<p><img src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210728001501.png" alt="image-20210728001501813"></p>
<p>有了接口后，点击music，在send里选择effects的Receive接口，就可以把音频发送给接收者</p>
<p><img src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210728001509.png" alt="image-20210728001509089"></p>
<p><strong>注意，音效是有处理顺序的，必须先接收，再回声，因此要调整顺序如下图</strong></p>
<p><img src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210728001521.png" alt="image-20210728001520973"></p>
<p>运行，还不行，需要点击这里调整回声强度</p>
<p><img src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210728001529.png" alt="image-20210728001529682"></p>
<p>如果回声效果不明显，可以调整SFX Reverb的参数，比如Room房间大小和Reverb回声强度</p>
<p><img src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210728001536.png" alt="image-20210728001536569"></p>
<p>除了回声效果，unity也提供了许多其他音效，比如低通滤波器（可以过滤低音保留高音）等等，自己可以尝试，但是要注意顺序，music要先低通再send回音，否则回音接受到的是原音</p>
<h3 id="脚本控制"><a href="#脚本控制" class="headerlink" title="脚本控制"></a>脚本控制</h3><p>以上，都是在unity编辑器中设置的，那如果需要动态设置呢？，比如在游戏场景中人物可以调整某个收音机的音量之类，因此可以暴露混音器设置给脚本</p>
<p><img src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210728001546.png" alt="image-20210728001546102"></p>
<p>因为master可以控制所有子音频，所以我们暴露master的控制脚本，<strong>注意是对着Volume点右键而不是对着Attention点右键</strong></p>
<p>完成之后这里会出现一个Exposed Parameters，也就是自定义参数</p>
<p><img src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210728001558.png" alt="image-20210728001558353"></p>
<p>新建脚本，这里通过键盘上下键来控制音量</p>
<p><img src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210728001607.png" alt="image-20210728001607742"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">using System.Collections;</span><br><span class="line">using System.Collections.Generic;</span><br><span class="line">using UnityEngine;</span><br><span class="line">using UnityEngine.Audio;</span><br><span class="line"></span><br><span class="line">public class Adjust : MonoBehaviour &#123;</span><br><span class="line">    public AudioMixer audioMixer;</span><br><span class="line"></span><br><span class="line">	&#x2F;&#x2F; Update is called once per frame</span><br><span class="line">	void Update () &#123;</span><br><span class="line">        float v;</span><br><span class="line">        audioMixer.GetFloat(&quot;MyVolume&quot;, out v);</span><br><span class="line">        Debug.Log(v);</span><br><span class="line">        if (Input.GetKeyDown(KeyCode.UpArrow))</span><br><span class="line">            audioMixer.SetFloat(&quot;MyVolume&quot;, v + 1);</span><br><span class="line">        if (Input.GetKeyDown(KeyCode.DownArrow))</span><br><span class="line">            audioMixer.SetFloat(&quot;MyVolume&quot;, v - 1);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>脚本挂接到main canera，mix audio作为参数</p>
<p><img src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210728001625.png" alt="image-20210728001625897"></p>
<p>运行，通过键盘↑↓调整音量大小</p>
<p>至此音效介绍完毕</p>
<h1 id="8-网络"><a href="#8-网络" class="headerlink" title="8. 网络"></a>8. 网络</h1><p>2019以后的unity版本现在这里点击一下安装</p>
<p><img src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210728001636.png" alt="image-20210728001636004"></p>
<h2 id="8-1-双玩家连线"><a href="#8-1-双玩家连线" class="headerlink" title="8.1 双玩家连线"></a>8.1 双玩家连线</h2><ul>
<li><p>双玩家连线：这种模式下，服务端其实也是其中一个客户端（也是一个unity程序），也就是说，客户端操作一个小人，服务端也有操作小人的功能。但是还是必须先启动服务端。</p>
</li>
<li><p>多玩家连线：这种模式下，服务端通常只做数据的接收、转发和广播，本身并不具有客户端的功能，但是会存储客户端的列表，操作对应的数据是单播还是广播</p>
</li>
</ul>
<ol>
<li>添加网络管理器</li>
</ol>
<p>新建场景，添加一个第三人称预实现小人，添加一个空object，为空物体添加network manager和network manager HUD组件</p>
<p><img src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210728001702.png" alt="image-20210728001702120"></p>
<ol start="2">
<li>为人物添加网络实体和网络广播</li>
</ol>
<p>为小人复制出预制件</p>
<p>对小人添加 networkIdentity组件，表示该小人是网络实体</p>
<p><img src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210728001711.png" alt="image-20210728001711488"></p>
<p>勾选下面这个选项，由于在网络游戏中，不宜传输太多数据，比如人物可以在自己本地可以控制的，一个客户端只有一个玩家。只需要向网络广播自己的一些信息即可，因此就可以勾选下面这个选项。</p>
<p><img src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210728001722.png" alt="image-20210728001722884"></p>
<p>那勾选了本地操作之后，怎么向网络广播自己的位置信息呢？</p>
<p>为小人添加network transform组件</p>
<p><img src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210728001730.png" alt="image-20210728001729928"></p>
<p>就可以向网络中发送自己的transform了</p>
<p>完成之后，点击apply all可以应用到对应的预制件</p>
<p><img src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210728002145.png" alt="image-20210728002138028"></p>
<p>现在运行并不是真正的网络数据，还需要修改人物脚本，进入这个脚本</p>
<p><img src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210728002152.png" alt="image-20210728002152705"></p>
<p>打开可以看到MonoBehaviour，这是单人游戏的意思</p>
<p><img src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210728002200.png" alt="image-20210728002200786"></p>
<p>需要改成如下：网络游戏</p>
<p><img src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210728002207.png" alt="image-20210728002207350"></p>
<p>这个类就可以调用一些联网功能</p>
<p>我们对其修改，目的是：人物动作只在本地，但是一些位置等信息需要向网络广播</p>
<p><img src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210728002215.png" alt="image-20210728002215358"></p>
<p>保存，apply all后就可以删除场景中的小人了，咱们只保留预制件，小人交由服务端生成</p>
<p>\3. 服务端生成预制件</p>
<p>刚刚说了小人应该在服务端生成而不是一开始就在客户端中</p>
<p><img src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210728002223.png" alt="image-20210728002223807"></p>
<p>\4. 运行</p>
<p>现在一切已经就绪，那么我们怎么模拟联机呢，当然可以找两台同一wifi/局域网下的电脑，也可以本机模拟，我们直接build一下作为一个，然后编辑器中运行作为另一个（当然你也可以build后运行两个）。总之无论如何，打开两个就行了</p>
<p>需要注意的是，必须先启动服务端，再启动客户端连接它</p>
<p><img src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210728002232.png" alt="image-20210728002232572"></p>
<p>我们可以看到成功联机了，但是只有位置联机了，动作没有改变（A端自己的小人会在B端移动，但不会在B端做动作）</p>
<p><img src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210728002240.png" alt="image-20210728002240525"></p>
<p>unity为网络游戏优化的规则就是默认不传输所有数据，至于位置信息是因为我们添加了network transform组件才进行传输</p>
<p>怎么样才能让动作也作为网络数据传输呢？动作其实就是动画animation，到这里就明白了：network animation，是的</p>
<p><img src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210728002247.png" alt="image-20210728002247837"></p>
<h3 id="踩坑：预制件的修改"><a href="#踩坑：预制件的修改" class="headerlink" title="踩坑：预制件的修改"></a>踩坑：预制件的修改</h3><p>但是要修改预制件的东西，最好先将预制件拖入场景中变为实体，改动完再apply all，再删除场景中的GameObject</p>
<p>因为参数通常是传入GameObject，如下</p>
<p><img src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210728002257.png" alt="image-20210728002257617"></p>
<p>如果只有Player预制件没有生成一个Player的GameObject实体，那么这里会发现没有Player可选</p>
<p>将上述所有修改完成再apply all，删除场景中的实体即可</p>
<p>重新build，联机，发现动作也有了，延迟取决于网络！！！！</p>
<h2 id="8-2-联网子弹"><a href="#8-2-联网子弹" class="headerlink" title="8.2 联网子弹"></a>8.2 联网子弹</h2><p>准备工作：单机子弹和发射</p>
<p>下面制作子弹，先创建一个球体，属性如下</p>
<p><img src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210728002307.png" alt="image-20210728002306968"></p>
<p>并作为预制件，将场景中的子弹删除</p>
<p>编辑player脚本，使其可以发射子弹</p>
<p><img src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210728002316.png" alt="image-20210728002316200"></p>
<p><img src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210728002320.png" alt="image-20210728002320281"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">void Fire()</span><br><span class="line">&#123;</span><br><span class="line">    GameObject bullet &#x3D; Instantiate(bulletPrefab, transform.position + transform.up + transform.forward * 2, transform.rotation);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>这时候已经完成了单机发射子弹了，可以运行测试</p>
<p>下面继续制作联网子弹</p>
<p>将子弹预制件拖拽到场景编辑，添加network identity和network transform</p>
<p>由于我们不希望子弹的位置自动传输，因此将send rate设置为0</p>
<p>apply</p>
<p>将子弹预制件纳入到网络管理器的生成列表种，使得子弹由网络生成</p>
<p><img src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210728002341.png" alt="image-20210728002341869"></p>
<p><img src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210728002357.png" alt="image-20210728002357707"></p>
<p><strong>需要注意的是，由网络生成的列表必须带有[Command]，而有Command的函数必须是以Cmd开头</strong></p>
<p>新建血量脚本</p>
<p>我们想做一个功能是当血量为0时，重新生成一个玩家，我们知道现在Player是在服务端生成的，但是生成后是交给客户端来对这个Player执行</p>
<p>unity提供了一个由服务端调用，客户端执行的函数</p>
<p><img src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210728002413.png" alt="image-20210728002413241"></p>
<p>为子弹建立脚本，碰撞检测和调用血条减少（总的来说就是造成伤害）</p>
<p><img src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210728002422.png" alt="image-20210728002422534"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">private void OnTriggerEnter(Collider other)</span><br><span class="line">&#123;</span><br><span class="line">    &#x2F;&#x2F; 通过SendMessage方法尝试调用gameobject名为TakeDamage的脚本函数，如果该gameobject没有这个函数则DontRequireReceiver不执行</span><br><span class="line">    other.gameObject.SendMessage(&quot;takeDamage&quot;, 60, SendMessageOptions.DontRequireReceiver);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>这里说明一下，为什么没有用if(other.gameobject == “player”)，因为这个碰撞检测可能对player有效，对enemey也有效，后期可能对其他的物体也有效，那么这样设计是比较麻烦的，unity提供的这种消息机制就可以让所有的物体都接收，然后尝试调用TakeDamage方法，如果物品没有这个方法就不作为，如果物品有这个方法就调用。</strong></p>
<p>将脚本拖拽给bullet预制件，将health脚本拖拽给player，运行</p>
<h2 id="8-3-NPC"><a href="#8-3-NPC" class="headerlink" title="8.3 NPC"></a>8.3 NPC</h2><p>NPC就是共同的敌人，（或者在某些游戏中不是敌人，总之共同的就对了）</p>
<ol>
<li>重新制作预制件</li>
</ol>
<p>拖拽一个小人到场景中，重命名为NPC，并修改材质使其看起来有区别于enemy和player</p>
<p><img src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210728002455.png" alt="image-20210728002455249"></p>
<p>重新制作预制件并命名为NPC预制件，并将场景中的小人删除</p>
<ol start="2">
<li>为NPC添加网络管理器</li>
</ol>
<p>新建空物体，添加network identity组件，勾选server only（NPC应该设置为仅由服务端生成，不受客户端控制）</p>
<p><img src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210728002505.png" alt="image-20210728002505705"></p>
<ol start="3">
<li>动态随机生成多个NPC脚本</li>
</ol>
<p><img src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210728002519.png" alt="image-20210728002519323"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">public class NPCSpawner : NetworkBehaviour</span><br><span class="line">&#123;</span><br><span class="line">    public GameObject NPCPrefab;</span><br><span class="line">    public int numOfNPC;</span><br><span class="line"></span><br><span class="line">    &#x2F;&#x2F; 服务端启动时的一个生命周期虚函数</span><br><span class="line">    public override void OnStartServer()</span><br><span class="line">    &#123;</span><br><span class="line">        for(int i &#x3D; 0; i &lt; numOfNPC; i++)</span><br><span class="line">        &#123;</span><br><span class="line">            &#x2F;&#x2F; 随机位置和朝向</span><br><span class="line">            Vector3 spawnPos &#x3D; new Vector3(Random.Range(-5f, 5f), 0f, Random.Range(-5f, 5f));</span><br><span class="line">            Quaternion spawnRot &#x3D; Quaternion.Euler(0, Random.Range(0, 180), 0f);    &#x2F;&#x2F; 更习惯用欧拉角</span><br><span class="line">            GameObject NPC &#x3D; Instantiate(NPCPrefab, spawnPos, spawnRot);</span><br><span class="line">            NetworkServer.Spawn(NPC);</span><br><span class="line">        &#125;</span><br><span class="line">        base.OnStartServer();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>拖拽给生成器gameobject</p>
<p><img src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210728002547.png" alt="image-20210728002547216"></p>
<p>填入参数</p>
<p><img src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210728002553.png" alt="image-20210728002553809"></p>
<ol start="4">
<li>注册到网络生成器列表</li>
</ol>
<p><img src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210728002615.png" alt="image-20210728002615085"></p>
<ol start="5">
<li>为NPC添加血条效果</li>
</ol>
<p>现在运行可以正常生成NPC但不会收到伤害，因为Health是客户端的脚本功能</p>
<p><img src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210728002624.png" alt="image-20210728002624636"></p>
<p>修改如下</p>
<p><img src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210728002634.png" alt="image-20210728002634445"></p>
<p><img src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210728002639.png" alt="image-20210728002639459"></p>
<p>运行，可以联网打怪</p>
<p><img src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210728002649.png" alt="image-20210728002649385"></p>
<h1 id="9-时间轴"><a href="#9-时间轴" class="headerlink" title="9. 时间轴"></a>9. 时间轴</h1><h2 id="9-2-创建time-line"><a href="#9-2-创建time-line" class="headerlink" title="9.2 创建time line"></a>9.2 创建time line</h2><p>先来看看如何创建一个时间轴创建一个timeline</p>
<h2 id="9-1-和动画的异同"><a href="#9-1-和动画的异同" class="headerlink" title="9.1 和动画的异同"></a>9.1 和动画的异同</h2><p>timeline是引擎后来提供的一个新功能。相比于animation，timeline可以认为是控制场景的<strong>整体动画</strong>，既可以对单个物体也可以控制多个物体协同运动，同时可以播放声音，粒子效果，摄像机跟踪等等。而animation只可以控制<strong>单个物体</strong>，且该物体的多个动画片段需要animation controller协调进行叠加或者混合，多个物体的动画需要各自的animation。可以理解成timeline是横向的，一个object控制多个物体同时播放动画，animation是纵向的，每个物体能在自己的时刻播放自己的动画。</p>
<h3 id="动画轨道"><a href="#动画轨道" class="headerlink" title="动画轨道"></a>动画轨道</h3><p>新建一个空物体，添加Playable Director组件，另一种方式是window-&gt;timeline-&gt;create（这种方式就类似于animation）</p>
<p>如下图操作，拖拽两个物体进入animation轨道，由Director这个timeline物体的timeline组件控制</p>
<p><img src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210728002718.png" alt="image-20210728002718180"></p>
<p>在各自的轨道上创建自己的animation，可以像animation一样录制，也可以如下直接植入预制动画片段</p>
<p><img src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210728002724.png" alt="image-20210728002724881"></p>
<p><img src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210728002729.png" alt="image-20210728002729117"></p>
<p>需要注意的是：录制的话，对动画中需要变动的transform属性进行右键add key</p>
<p>录制完后，可以对某一段动画进行封装成一个完整的片段</p>
<p><img src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210728002737.png" alt="image-20210728002736908"></p>
<p>除了动画轨道，还可以有音频轨道和控制轨道</p>
<h3 id="音频轨道audio-track"><a href="#音频轨道audio-track" class="headerlink" title="音频轨道audio track"></a>音频轨道audio track</h3><p>和动画类似，创建音源，创建轨道，添加声音片段，可以融合</p>
<p><img src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210728002746.png" alt="image-20210728002746608"></p>
<h3 id="控制轨道-control-track"><a href="#控制轨道-control-track" class="headerlink" title="控制轨道 control track"></a>控制轨道 control track</h3><p>可以动态生成一个物体</p>
<p><img src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210728002755.png" alt="image-20210728002755453"></p>
<p><img src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210728002801.png" alt="image-20210728002801717"></p>
<h3 id="自定义轨道Playeable-track"><a href="#自定义轨道Playeable-track" class="headerlink" title="自定义轨道Playeable track"></a>自定义轨道Playeable track</h3><p>可以接收自定义脚本，脚本类需要集成PlayableAsset</p>
<p>下面实现一个UI空间Text显示当前轨道的播放状态</p>
<p><img src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210728002812.png" alt="image-20210728002812452"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">using System.Collections;</span><br><span class="line">using System.Collections.Generic;</span><br><span class="line">using UnityEngine;</span><br><span class="line">using UnityEngine.Playables;</span><br><span class="line">using UnityEngine.UI;</span><br><span class="line"></span><br><span class="line">public class MyplayableAsset : PlayableAsset &#123;</span><br><span class="line">    public ExposedReference&lt;Text&gt; myText;</span><br><span class="line">    public override Playable CreatePlayable(PlayableGraph graph, GameObject owner)</span><br><span class="line">    &#123;</span><br><span class="line">        var playable &#x3D; ScriptPlayable&lt;MyplayableBehaviour&gt;.Create(graph);</span><br><span class="line">        playable.GetBehaviour().status &#x3D; myText.Resolve(graph.GetResolver());</span><br><span class="line">        return playable;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">public class MyplayableBehaviour:PlayableBehaviour</span><br><span class="line">&#123;</span><br><span class="line">    public Text status;</span><br><span class="line">    public override void OnBehaviourPlay(Playable playable, FrameData info)</span><br><span class="line">    &#123;</span><br><span class="line">        if(status !&#x3D; null)</span><br><span class="line">        &#123;</span><br><span class="line">            status.text &#x3D; &quot;Playing&quot;;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    public override void OnBehaviourPause(Playable playable, FrameData info)</span><br><span class="line">    &#123;</span><br><span class="line">        if(status !&#x3D; null)</span><br><span class="line">        &#123;</span><br><span class="line">            status.text &#x3D; &quot;End playing&quot;;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>简单来说，timeline绑定了Text类型的控件，能够允许这个控件在某段时间生效，至于代码可能是固定写法，日后再探究</p>
<p>创建UI空间Text并拖入，运行</p>
<p><img src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210728002831.png" alt="image-20210728002830934"></p>
<h2 id="9-3-角色动画"><a href="#9-3-角色动画" class="headerlink" title="9.3 角色动画"></a>9.3 角色动画</h2><p>拖拽一个第三人称小人预实现，取消脚本和animator controller，运行，此时小人相当于静态模型，添加timeline，动画依次为idle-&gt;walk-&gt;run，运行，此时发现有两个问题</p>
<p>1.角色不能掉头，即使调整场景中的小人rotY为180，但是运行的时候还是会背对相机，这是因为角色的transform已经交给目前出于激活状态的timeline控制，需要在这个地方调整</p>
<p><img src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210728002839.png" alt="image-20210728002839165"></p>
<p>2.动画被重置，尤其是walk-&gt;run，walk已经走了一段距离，但是run的时候会自动先回到原点，而不是接着walk的位置跑。右击run片段选中如下选项</p>
<p><img src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210728002850.png" alt="image-20210728002850515"></p>
<p>3.动画过渡太僵硬，回顾之前animation的融合，timeline也提供了非常方便的过渡功能。只需要将两个动画片段交叉即可自动过渡。</p>
<p><img src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210728002858.png" alt="image-20210728002857991"></p>
<p>细节：由于动画片段的独立性，由于速度不同或者其他问题，导致自动融合中会出现比如walk-&gt;run时出现滑步的现象，自己对位置做一些微调即可</p>
<p><img src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210728002906.png" alt="image-20210728002906829"></p>
<p>可以像animation一样进行动画的叠加，比如在动画1的时候添加转身，遮罩（身体的某个部位做不一样的动画）</p>
<p><img src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210728002914.png" alt="image-20210728002914631"></p>
<p>如果动作部位冲突又没有遮罩的话，后面的轨道会覆盖前面的轨道</p>
<h2 id="9-4-脚本控制"><a href="#9-4-脚本控制" class="headerlink" title="9.4 脚本控制"></a>9.4 脚本控制</h2><p>通常timeline都是达到某个场景触发，下面我们模拟脚本控制timeline的触发，新建空物体并为其创建脚本如下</p>
<p><img src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210728002922.png" alt="image-20210728002922653"></p>
<p>关于第8行，其实写public也行，只是提一下有这么一种写法，既是private又可以在unity编辑器中暴露参数，像button一样传入参数</p>
<p><img src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210728002933.png" alt="image-20210728002933022"></p>
<p>运行，依次按下QE</p>
<h2 id="9-5-Cinemachine"><a href="#9-5-Cinemachine" class="headerlink" title="9.5 Cinemachine"></a>9.5 Cinemachine</h2><p>转场动画中经常见到的多摄像机动画。比如在游戏开始前，相机先展示敌人和一些特殊道具的位置，随后镜头才给到主角。其实就是Cinemachine在多个摄像机之间的转换。</p>
<p>timeline对多摄像机有很专业的动画调控支持</p>
<p>第一次使用需要先安装一下</p>
<p><img src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210728002947.png" alt="image-20210728002947208"></p>
<ol>
<li>新建cinemachine track</li>
</ol>
<p>添加后发现多了一个track，新建它</p>
<p><img src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210728002958.png" alt="image-20210728002958774"></p>
<p><strong>cinemachine其实是采用了虚拟摄像机来模拟多摄像机效果</strong></p>
<ol start="2">
<li>为主摄像机添加cinemachint brain组件</li>
</ol>
<p><img src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210728003010.png" alt="image-20210728003010383"></p>
<p>\3. 新建虚拟摄像机</p>
<p>如下，可以创建一个简单的虚拟摄像机，unity也为我们提供了许多具备一定功能的摄像机，这里我们选择一个freelook：这个虚拟摄像机允许我们角度自由的观察一些物体。</p>
<p>再建立一个带轨道的推拉摄像机：这个虚拟摄像机可以对一个物体前后推拉达到远近变化观察的效果</p>
<p><img src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210728003024.png" alt="image-20210728003024160"></p>
<p><img src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210728003028.png" alt="image-20210728003028592"></p>
<ol start="4">
<li>调整虚拟摄像机达到预期效果</li>
</ol>
<p>咱们目的是让推拉带轨道摄像机沿着设定的轨道移动，并时刻注释红色物体，自由摄像机注释蓝色物体。并在timeline中设置为先观察蓝物体，再观察红物体的效果</p>
<p><img src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210728003036.png" alt="image-20210728003036607"></p>
<p>推拉摄像机的路径设置如下</p>
<p><img src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210728003042.png" alt="image-20210728003042730"></p>
<p>推拉摄像机参数设置如下：其中Path offset设置成0表示摄像机严格按轨道移动</p>
<p><img src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210728003055.png" alt="image-20210728003055081"></p>
<p>设置完成后，推拉摄像机就可以在轨道上找到最近的点去观察红色物体了</p>
<p>另外，这里为了方便看到效果，要让红蓝物体在动画开始时自动运动（之前设置了要按下QE）</p>
<p><img src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210728003110.png" alt="image-20210728003110890"></p>
<ol start="5">
<li>调高main camera的优先级</li>
</ol>
<p>自己可以对比观察一下，是这样的，camerachine所谓的虚拟摄像机并不记录画面，而是将虚拟摄像机看到的画面传输给camera（类似于无人机，无人机在飞，拍到的画面是发送到操控者的屏幕上，无人机自己并没有保存照片的功能）。</p>
<p>如果不调高main camera的优先级，那么会显示虚拟摄像机开始的位置观察的画面，因为虚拟摄像机只有第一帧的画面，后面的画面不记录不更新，而是发送给了main camera，因此我们看到的就是虚拟摄像机似乎没动。所以我们应该一直看main camera，要将main camera的优先级调高，覆盖其他摄像机。</p>
<p><img src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210728003121.png" alt="image-20210728003120944"></p>
<ol start="6">
<li>timeline控制两个camerachine</li>
</ol>
<p><img src="images/loading.gif" data-original="C:%5CUsers%5Cwjw%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20210728003128455.png" alt="image-20210728003128455"></p>
<p>运行观看效果</p>
<h1 id="10-2D游戏"><a href="#10-2D游戏" class="headerlink" title="10. 2D游戏"></a>10. 2D游戏</h1><p>unity新建工程的时候，如果想要创建二维工程，需要在创建时点击2D</p>
<p><img src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210728003146.png" alt="image-20210728003146829"></p>
<p>长这样</p>
<p><img src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210728003154.png" alt="image-20210728003154116"></p>
<p>可以看见工具栏有个2D视图，其实只要换成3D就变成3D工程了，所谓2D游戏不过是把z轴去掉</p>
<h2 id="10-1-精灵"><a href="#10-1-精灵" class="headerlink" title="10.1 精灵"></a>10.1 精灵</h2><p>2D游戏中的纹理默认是精灵类型，2D游戏就是由一个个的图片（或者说纹理或者说精灵）+移动+脚本制作的</p>
<p>将一张图片拖拽到unity，可以看到默认是精灵类型</p>
<p><img src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210728003202.png" alt="image-20210728003202760"></p>
<p>如果图片本身就具有alpha透明通道，那么图片可能会不显示（透明嘛），可以如上图去除透明通道，<em>记得点击apply</em></p>
<p><img src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210728003212.png" alt="image-20210728003212754"></p>
<p>拖拽两个物体进入场景，发现被覆盖，可以手动调整sorting layer，下面的order in layer表示即使是同一层也有遮挡顺序</p>
<p><img src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210728003221.png" alt="image-20210728003221835"></p>
<p>点击三角形，点击add layer，并添加自定义层，下面的优先级高于上面</p>
<p><img src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210728003229.png" alt="image-20210728003229743"></p>
<p>编辑好后，将场景中的物体应用到各自的层，坦克就不会被背景遮住了</p>
<p><img src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210728003246.png" alt="image-20210728003245946"></p>
<p>当我们拖拽子弹后，发现是一连串的</p>
<p><img src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210728003253.png" alt="image-20210728003253713"></p>
<p>但我们知道这其实是多帧连续播放的动图，unity给我们提供了一个非常简便的切割方式</p>
<p><img src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210728003301.png" alt="image-20210728003301196"></p>
<p>其中slice提供了很多切割模式</p>
<p><img src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210728003308.png" alt="image-20210728003308281"></p>
<p>automatic是自动切割，采用了最小包围盒算法</p>
<p>size是指定长和宽的像素</p>
<p>count是指定几行几列</p>
<p><em>完成后记得点击apply</em></p>
<p>此时再拖拽到场景，会自动提示创建animation</p>
<p><img src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210728003321.png" alt="image-20210728003321609"></p>
<p>创建完动画后运行即可看到效果</p>
<p>多个物体批量调整大小</p>
<p><img src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210728003331.png" alt="image-20210728003331060"></p>
<p>创建发射子弹脚本</p>
<p><img src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210728003339.png" alt="image-20210728003339325"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">using System.Collections;</span><br><span class="line">using System.Collections.Generic;</span><br><span class="line">using UnityEngine;</span><br><span class="line"></span><br><span class="line">[RequireComponent(typeof(Rigidbody2D))]</span><br><span class="line">public class Bullet : MonoBehaviour</span><br><span class="line">&#123;</span><br><span class="line">    [SerializeField] private float speed &#x3D; 2.0f;</span><br><span class="line">    private Rigidbody2D body;</span><br><span class="line"></span><br><span class="line">    &#x2F;&#x2F; Start is called before the first frame update</span><br><span class="line">    void Start()</span><br><span class="line">    &#123;</span><br><span class="line">        body &#x3D; GetComponent&lt;Rigidbody2D&gt;();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    &#x2F;&#x2F; Update is called once per frame</span><br><span class="line">    void Update()</span><br><span class="line">    &#123;</span><br><span class="line">        body.MovePosition(transform.position - transform.right * speed * Time.deltaTime);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    private void OnCollisionEnter2D(Collision2D collision)</span><br><span class="line">    &#123;</span><br><span class="line">        if(collision.gameObject .tag &#x3D;&#x3D; &quot;Player&quot;)</span><br><span class="line">        &#123;</span><br><span class="line">            GameObject.Destroy(collision.gameObject);</span><br><span class="line">            GameObject.Destroy(gameObject);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>挂接到子弹，子弹会自动添加rigid body组件，还需要手动添加一个box collider组件用于碰撞检测，同时还需要把重力取消</p>
<p><img src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210728003359.png" alt="image-20210728003359001"></p>
<p>接下来完成坦克生成子弹，因此需要制作预制件，并reset位置（到时候作为坦克的子物体）</p>
<p><img src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210728003407.png" alt="image-20210728003407652"></p>
<p>新建发射脚本</p>
<p><img src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210728003415.png" alt="image-20210728003414971"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">using System.Collections;</span><br><span class="line">using System.Collections.Generic;</span><br><span class="line">using UnityEngine;</span><br><span class="line"></span><br><span class="line">public class Spawner : MonoBehaviour</span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">    [SerializeField] private float shootTimer &#x3D; 3f; &#x2F;&#x2F; 冷却时间</span><br><span class="line">    float timer &#x3D; 0f;   &#x2F;&#x2F; 已经冷却时间</span><br><span class="line">    [SerializeField] GameObject bullet; &#x2F;&#x2F; 实例化的子弹</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    &#x2F;&#x2F; Update is called once per frame</span><br><span class="line">    void Update()</span><br><span class="line">    &#123;</span><br><span class="line">        if(timer &gt; shootTimer)</span><br><span class="line">        &#123;</span><br><span class="line">            Instantiate(bullet, transform); &#x2F;&#x2F; 从transform位置生成子弹</span><br><span class="line">            timer &#x3D; 0f;</span><br><span class="line">        &#125;</span><br><span class="line">        timer +&#x3D; Time.deltaTime;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>挂接给Spawner发射器，并将子弹预制件参数拖拽进去，运行</p>
<p>颜色：</p>
<p>可以调整color属性</p>
<p>光照：</p>
<p>2D游戏默认没有光照，因为材质默认不会受到光照效果，可以手动添加光源，并添加材质，选择漫反射</p>
<p><img src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210728003433.png" alt="image-20210728003433219"></p>
<p>将材质拖拽给2D物体，就可以看到光照效果，如果没有，注意光源是否离得太远（调整z值）<strong>和角度</strong>（这个要注意，比如点光源默认rotX是90，建议切换成3D视图来调整）</p>
<p><img src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210728003448.png" alt="image-20210728003448422"></p>
<h2 id="10-2-瓦片地图"><a href="#10-2-瓦片地图" class="headerlink" title="10.2 瓦片地图"></a>10.2 瓦片地图</h2><p>tilemap，是为了2D游戏经常需要的一种格子排列布局</p>
<p><img src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210728003457.png" alt="image-20210728003457334"></p>
<p>但是这样很费时间，于是有了瓦片地图功能</p>
<ol>
<li>新建瓦片地图tilemap</li>
</ol>
<p><img src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210728003504.png" alt="image-20210728003504817"></p>
<p>除了tilemap，下面还有六边形等</p>
<p><img src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210728003514.png" alt="image-20210728003514418"></p>
<p><strong>记得将这个tilemap图层覆盖在background之上</strong></p>
<p><img src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210728003527.png" alt="image-20210728003527618"></p>
<ol start="2">
<li>调出瓦片调色板tile palette</li>
</ol>
<p><img src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210728003538.png" alt="image-20210728003537970"></p>
<p><img src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210728003543.png" alt="image-20210728003543552"></p>
<ol start="3">
<li>拖拽到调色板</li>
</ol>
<p><img src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210728003556.png" alt="image-20210728003556032"></p>
<p>用笔刷刷出连续的效果</p>
<p><img src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210728003603.png" alt="image-20210728003603506"></p>
<p>点击edit可以调整调色板上的瓦片效果，可以用多个物体组装成一个瓦片，鼠标框选后作为一个整体再使用笔刷</p>
<h3 id="10-2-1-碰撞体"><a href="#10-2-1-碰撞体" class="headerlink" title="10.2.1 碰撞体"></a>10.2.1 碰撞体</h3><p><img src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210728003616.png" alt="image-20210728003615993"></p>
<p>可以为tilemap中的每一片瓦片里的每一个方块都添加碰撞体 </p>
<p>这时候我们可能需要进行一些碰撞体的融合</p>
<p><img src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210728003623.png" alt="image-20210728003623887"></p>
<p>添加这个会自动添加rigid body，如果是地形的话，不受重力影响，最好直接设置成静态</p>
<p><img src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210728003631.png" alt="image-20210728003631293"></p>
<p>tilemap允许使用碰撞组合</p>
<p><img src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210728003644.png" alt="image-20210728003644698"></p>
<h2 id="10-3-角色控制"><a href="#10-3-角色控制" class="headerlink" title="10.3 角色控制"></a>10.3 角色控制</h2><p>下面我们学习2D下的游戏角色控制</p>
<ol>
<li>先添加资源包，只需要添加这几张图片就行</li>
</ol>
<p><img src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210728003700.png" alt="image-20210728003700545"></p>
<p>如果打开sprite editer就可以发现都切割好了</p>
<ol start="2">
<li>拖拽idle动画<strong>（一定要记得是拖拽到场景而不能是Hierarchy）</strong>，起名Player作为角色，修改为actor层，设置tag为Player，添加capsule collider 2D并调整大小到包裹小人范围，添加rigid body2D组件，不希望旋转所以锁定旋转轴</li>
</ol>
<p><img src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210728003740.png" alt="image-20210728003740511"></p>
<ol start="3">
<li>动画修改</li>
</ol>
<p>不多说了，编辑ide的状态机，添加walk run jump 并创建三个参数，添加转换条件</p>
<p>speed：速度，Ground：是否触碰地面，vSpeed：纵向跳跃速度</p>
<p>idel-&gt;walk：速度大于0.01 反之亦然</p>
<p>walk-&gt;run：速度大于0.1，反之亦然</p>
<p><img src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210728003753.png" alt="image-20210728003753861"></p>
<p>最后状态机如下图</p>
<p><img src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210728003800.png" alt="image-20210728003800252"></p>
<p>添加对应的Motion（如果没有的话就先将几个png拉入场景，因为这个不是从资源包弄出来的动画，而是从png里面通过sprite editor切割出来的）</p>
<ol start="4">
<li>创建player脚本</li>
</ol>
<p>这个脚本比较复杂，但目的只有一个，就是通过按键改变animator动画中这几个参数，剩下的不用理会，动画都做好了。</p>
<p><img src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210728003813.png" alt="image-20210728003813871"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br></pre></td><td class="code"><pre><span class="line">using System.Collections;</span><br><span class="line">using System.Collections.Generic;</span><br><span class="line">using UnityEngine;</span><br><span class="line"></span><br><span class="line">public class Character : MonoBehaviour</span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">    [SerializeField] float maxSpeed &#x3D; 10f;</span><br><span class="line">    [SerializeField] float jumpForce &#x3D; 400f;</span><br><span class="line">    [SerializeField] LayerMask whatIsGround;    &#x2F;&#x2F; 哪些层需要地面检测</span><br><span class="line"></span><br><span class="line">    Transform groundCheck;  &#x2F;&#x2F; 我们会在小人脚的位置建立一个空子物体用于碰撞检测</span><br><span class="line">    float groundRadius &#x3D; 0.5f;     &#x2F;&#x2F; 距离地面多少判断为着地</span><br><span class="line">    bool grounded &#x3D; false;</span><br><span class="line">    Animator anim;</span><br><span class="line">    Rigidbody2D body;   </span><br><span class="line">    bool facingRight;   &#x2F;&#x2F; 面朝右边</span><br><span class="line">    bool jump &#x3D; true;   &#x2F;&#x2F; 是否在跳跃</span><br><span class="line"></span><br><span class="line">    private void Awake()</span><br><span class="line">    &#123;</span><br><span class="line">        &#x2F;&#x2F; 这里没有用start而是用awake</span><br><span class="line">        groundCheck &#x3D; transform.Find(&quot;GroundCheck&quot;);</span><br><span class="line">        anim &#x3D; GetComponent&lt;Animator&gt;();</span><br><span class="line">        body &#x3D; GetComponent&lt;Rigidbody2D&gt;();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    private void FixedUpdate()</span><br><span class="line">    &#123;</span><br><span class="line">        grounded &#x3D; false;</span><br><span class="line">        &#x2F;&#x2F; OverlapCircleAll的作用是从某个点开始，在多大范围内（二维平面的圈），在某个层是否有相交物体</span><br><span class="line">        Collider2D[] colliders &#x3D; Physics2D.OverlapCircleAll(groundCheck.position, groundRadius, whatIsGround);</span><br><span class="line">        foreach (Collider2D collider in colliders)</span><br><span class="line">        &#123;</span><br><span class="line">            if (collider.gameObject !&#x3D; gameObject)  &#x2F;&#x2F; 养成习惯，碰撞体不是自己，其实这里还要检测是否是敌人或者别的什么</span><br><span class="line">                grounded &#x3D; true;                    &#x2F;&#x2F; 总之这里就先简单的认为碰撞了且不是自己就说明是地面</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        anim.SetBool(&quot;Ground&quot;, grounded);</span><br><span class="line">        anim.SetFloat(&quot;vSpeed&quot;, body.velocity.y);   &#x2F;&#x2F; 这个可以获取速度</span><br><span class="line"></span><br><span class="line">        float h &#x3D; Input.GetAxis(&quot;Horizontal&quot;);      &#x2F;&#x2F; 这个可以获取用户是按下←（-1）还是→（1）</span><br><span class="line">        if (!jump)  &#x2F;&#x2F; 这样做可以禁止连跳</span><br><span class="line">        &#123;</span><br><span class="line">            jump &#x3D; Input.GetButtonDown(&quot;Jump&quot;);     &#x2F;&#x2F; 这个可以获取用户是否按下↑</span><br><span class="line">        &#125;</span><br><span class="line">        Move(h, jump);  &#x2F;&#x2F; 移动函数，在下面给出实现</span><br><span class="line">        jump &#x3D; false;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    &#x2F;**</span><br><span class="line">     * 移动函数，判断move是往左还是往右，有没有发生跳跃</span><br><span class="line">     *&#x2F;</span><br><span class="line">    void Move(float move, bool jumping)</span><br><span class="line">    &#123;</span><br><span class="line">        if (grounded)   &#x2F;&#x2F; 很细节，着地了才判断速度，否则在空中速度够了就跑起来了，打断了跳跃动作</span><br><span class="line">        &#123;</span><br><span class="line">            anim.SetFloat(&quot;Speed&quot;, Mathf.Abs(move));</span><br><span class="line">            body.velocity &#x3D; new Vector2(move * maxSpeed, body.velocity.y);  &#x2F;&#x2F; 新速度</span><br><span class="line">            &#x2F;&#x2F; 改变朝向</span><br><span class="line">            if (move &gt; 0 &amp;&amp; !facingRight)</span><br><span class="line">            &#123;</span><br><span class="line">                Flip();     &#x2F;&#x2F; 掉头方法</span><br><span class="line">            &#125;</span><br><span class="line">            else if (move &lt; 0 &amp;&amp; facingRight)</span><br><span class="line">            &#123;</span><br><span class="line">                Flip();</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            &#x2F;&#x2F; 跳跃判断</span><br><span class="line">            if (jumping &amp;&amp; anim.GetBool(&quot;Ground&quot;))</span><br><span class="line">            &#123;</span><br><span class="line">                grounded &#x3D; false;</span><br><span class="line">                anim.SetBool(&quot;Ground&quot;, false);</span><br><span class="line">                body.AddForce(new Vector2(0f, jumpForce));</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    &#x2F;**</span><br><span class="line">     * 掉头方法</span><br><span class="line">     *&#x2F;</span><br><span class="line">    void Flip()</span><br><span class="line">    &#123;</span><br><span class="line">        facingRight &#x3D; !facingRight;</span><br><span class="line">        Vector3 scale &#x3D; transform.localScale;</span><br><span class="line">        scale.x *&#x3D; -1;</span><br><span class="line">        transform.localScale &#x3D; scale;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>脚本挂接给小人</p>
<p>这里为了方便我们先选Everything，如果游戏做的细的话可以是地面Terrain和一些被认为地面的一些层</p>
<p><img src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210728003843.png" alt="image-20210728003842929"></p>
<p>添加脚本中提到的用于碰撞检测的子物体</p>
<p><img src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210728003849.png" alt="image-20210728003849611"></p>
<p>运行发现有延迟，应该把转换调成立即转换</p>
<p><img src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210728003856.png" alt="image-20210728003856744"></p>
<p>相机跟随</p>
<p>这个比较简单的一种做法是让main camera作为Player的子物体</p>
<p>当然这里由于子弹碰撞后销毁Player及其子物体导致撞到子弹后报如下错误，这里先不管他（解决方法是要么碰撞时判断不销毁相机，要么摄像机的移动不采用这种方式，而是脚本移动相机的transform的position）</p>
<p><img src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210728003904.png" alt="image-20210728003904121"></p>
<p>单方向碰撞检测</p>
<p>通常这种2D游戏都是可以从下面穿上去的，unity为我们提供了这个功能</p>
<p>选中两个tilemap并添加如下组件</p>
<p><img src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210728003919.png" alt="image-20210728003919285"></p>
<p>勾选如下两个选项</p>
<p><img src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210728003927.png" alt="image-20210728003927487"></p>
<p>运行</p>
<h1 id="11-天空盒"><a href="#11-天空盒" class="headerlink" title="11. 天空盒"></a>11. 天空盒</h1><p><img src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210728003939.png" alt="image-20210728003939740"></p>
<h1 id="12-忽略碰撞检测"><a href="#12-忽略碰撞检测" class="headerlink" title="12. 忽略碰撞检测"></a>12. 忽略碰撞检测</h1><p>部分物体是不需要碰撞检测的，unity提供了非常方便的选项供我们忽略而不需要在脚本中判断。</p>
<p>首先我们添加一个tag专门标识忽略碰撞检测的物体比如IgnoreCollider</p>
<p>如下图</p>
<p><img src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210728003953.png" alt="image-20210728003953715"></p>
<p>矩阵少一半，说明不支持单向碰撞检测（A可以碰撞B，B不可以碰撞A），因此如果有其他复杂的需要仍然通过脚本实现，只推荐勾选图片中的一个，除非确定某物体完全不受碰撞</p>

        </div>
        
        <div class="level is-size-7 is-uppercase">
            <div class="level-start">
                <div class="level-item">
                    <span class="is-size-6 has-text-grey has-mr-7">#</span>
                    <a class="has-link-grey -link" href="/tags/%E6%B8%B8%E6%88%8F%E5%92%8C%E5%BC%95%E6%93%8E/" rel="tag">游戏和引擎</a>
                </div>
            </div>
        </div>
        
        
        
    </div>
</div>





<div class="card card-transparent">
    <div class="level post-navigation is-flex-wrap is-mobile">
        
        <div class="level-start">
            <a class="level level-item has-link-grey  article-nav-prev" href="/Others/line-it-node-editor/">
                <i class="level-item fas fa-chevron-left"></i>
                <span class="level-item">Line-It 节点编辑器</span>
            </a>
        </div>
        
        
        <div class="level-end">
            <a class="level level-item has-link-grey  article-nav-next" href="/life/%E4%B8%BA%E6%AF%95%E4%B8%9A%E5%81%9A%E5%87%86%E5%A4%87/">
                <span class="level-item">为毕业做准备</span>
                <i class="level-item fas fa-chevron-right"></i>
            </a>
        </div>
        
    </div>
</div>



<div class="card">
    <div class="card-content">
        <h3 class="title is-5 has-text-weight-normal">评论</h3>
        
<div id="valine-thread" class="content"></div>
<script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/valine@1.3.10/dist/Valine.min.js"></script>
<script>
    new Valine({
        el: '#valine-thread' ,
        notify: false,
        verify: false,
        app_id: 'JK6SpCImIdMNJd75JUpXY0ee-gzGzoHsz',
        app_key: 'Do5gvzKuVTiSa5Woy1bXzbYv',
        placeholder: '留下评论吧~'
    });
</script>

    </div>
</div>
</div>
                




<div class="column is-4-tablet is-4-desktop is-3-widescreen  has-order-1 column-left ">
    
        
<div class="card widget">
    <div class="card-content">
        <nav class="level">
            <div class="level-item has-text-centered" style="flex-shrink: 1">
                <div>
                    
                    <figure class="image is-128x128 has-mb-6">
                        <img class="is-rounded" src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210717231547.jpeg" alt="wjwABCDEFG">
                    </figure>
                    
                    <p class="is-size-4 is-block">
                        wjwABCDEFG
                    </p>
                    
                    
                    
                    <p class="is-size-6 is-flex is-flex-center has-text-grey">
                        <i class="fas fa-map-marker-alt has-mr-7"></i>
                        <span>Shaoguan, China</span>
                    </p>
                    
                </div>
            </div>
        </nav>
        <nav class="level is-mobile">
            <div class="level-item has-text-centered is-marginless">
                <div>
                    <p class="heading">
                        文章
                    </p>
                    <a href="/archives">
                        <p class="title has-text-weight-normal">
                            103
                        </p>
                    </a>
                </div>
            </div>
            <div class="level-item has-text-centered is-marginless">
                <div>
                    <p class="heading">
                        分类
                    </p>
                    <a href="/categories">
                        <p class="title has-text-weight-normal">
                            14
                        </p>
                    </a>
                </div>
            </div>
            <div class="level-item has-text-centered is-marginless">
                <div>
                    <p class="heading">
                        标签
                    </p>
                    <a href="/tags">
                        <p class="title has-text-weight-normal">
                            26
                        </p>
                    </a>
                </div>
            </div>
        </nav>
        
        <div class="level">
            <a class="level-item button is-link is-rounded" href="https://github.com/wjwABCDEFG" target="_blank" rel="noopener">
                关注我</a>
        </div>
        
        
        
    </div>
</div>
    
        
<div class="card widget">
    <div class="card-content">
        <div class="menu">
            <h3 class="menu-label">
                分类
            </h3>
            <ul class="menu-list">
            <li>
        <a class="level is-marginless" href="/categories/Java%E5%9F%BA%E7%A1%80/">
            <span class="level-start">
                <span class="level-item">Java基础</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">7</span>
            </span>
        </a></li><li>
        <a class="level is-marginless" href="/categories/Mysql/">
            <span class="level-start">
                <span class="level-item">Mysql</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">3</span>
            </span>
        </a></li><li>
        <a class="level is-marginless" href="/categories/Others/">
            <span class="level-start">
                <span class="level-item">Others</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">8</span>
            </span>
        </a></li><li>
        <a class="level is-marginless" href="/categories/Spring/">
            <span class="level-start">
                <span class="level-item">Spring</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">6</span>
            </span>
        </a></li><li>
        <a class="level is-marginless" href="/categories/SpringCloud/">
            <span class="level-start">
                <span class="level-item">SpringCloud</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">4</span>
            </span>
        </a></li><li>
        <a class="level is-marginless" href="/categories/util/">
            <span class="level-start">
                <span class="level-item">Util工具类</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">3</span>
            </span>
        </a></li><li>
        <a class="level is-marginless" href="/categories/redis/">
            <span class="level-start">
                <span class="level-item">redis</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">1</span>
            </span>
        </a></li><li>
        <a class="level is-marginless" href="/categories/frontend/">
            <span class="level-start">
                <span class="level-item">前端</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">3</span>
            </span>
        </a></li><li>
        <a class="level is-marginless" href="/categories/algorithms/">
            <span class="level-start">
                <span class="level-item">数据结构和算法</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">60</span>
            </span>
        </a></li><li>
        <a class="level is-marginless" href="/categories/games/">
            <span class="level-start">
                <span class="level-item">游戏和引擎</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">2</span>
            </span>
        </a></li><li>
        <a class="level is-marginless" href="/categories/deeplearning/">
            <span class="level-start">
                <span class="level-item">玄学</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">1</span>
            </span>
        </a></li><li>
        <a class="level is-marginless" href="/categories/life/">
            <span class="level-start">
                <span class="level-item">生活随笔</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">6</span>
            </span>
        </a></li><li>
        <a class="level is-marginless" href="/categories/cs/">
            <span class="level-start">
                <span class="level-item">计算机基础</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">1</span>
            </span>
        </a></li><li>
        <a class="level is-marginless" href="/categories/designpattern/">
            <span class="level-start">
                <span class="level-item">设计模式</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">1</span>
            </span>
        </a></li>
            </ul>
        </div>
    </div>
</div>
    
        <div class="card widget">
    <div class="card-content">
        <h3 class="menu-label">
            标签云
        </h3>
        <a href="/tags/DL-ML/" style="font-size: 10px;">DL/ML</a> <a href="/tags/http/" style="font-size: 10px;">http</a> <a href="/tags/lintcode/" style="font-size: 10px;">lintcode</a> <a href="/tags/markdown/" style="font-size: 10px;">markdown</a> <a href="/tags/mysql/" style="font-size: 11.67px;">mysql</a> <a href="/tags/spring/" style="font-size: 11.67px;">spring</a> <a href="/tags/springcloud/" style="font-size: 10px;">springcloud</a> <a href="/tags/%E4%BA%8C%E5%88%86%E6%9F%A5%E6%89%BE/" style="font-size: 10px;">二分查找</a> <a href="/tags/%E5%89%91%E6%8C%87offer/" style="font-size: 10px;">剑指offer</a> <a href="/tags/%E5%8A%9B%E6%89%A3/" style="font-size: 20px;">力扣</a> <a href="/tags/%E5%8A%A0%E5%AF%86/" style="font-size: 10px;">加密</a> <a href="/tags/%E5%8A%A8%E6%80%81%E8%A7%84%E5%88%92/" style="font-size: 13.33px;">动态规划</a> <a href="/tags/%E5%8D%95%E8%B0%83%E6%A0%88/" style="font-size: 15px;">单调栈</a> <a href="/tags/%E5%9B%9E%E6%BA%AF/" style="font-size: 16.67px;">回溯</a> <a href="/tags/%E5%AD%97%E7%AC%A6%E4%B8%B2/" style="font-size: 10px;">字符串</a> <a href="/tags/%E5%AD%A6%E4%B9%A0%E8%AE%B0%E5%BD%95/" style="font-size: 10px;">学习记录</a> <a href="/tags/%E5%BC%80%E5%8F%91/" style="font-size: 18.33px;">开发</a> <a href="/tags/%E6%8E%92%E5%BA%8F/" style="font-size: 10px;">排序</a> <a href="/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/" style="font-size: 13.33px;">数据结构</a> <a href="/tags/%E6%A0%88/" style="font-size: 10px;">栈</a> <a href="/tags/%E6%A0%91/" style="font-size: 15px;">树</a> <a href="/tags/%E6%B8%B8%E6%88%8F%E5%92%8C%E5%BC%95%E6%93%8E/" style="font-size: 11.67px;">游戏和引擎</a> <a href="/tags/%E7%AC%94%E8%AF%95/" style="font-size: 10px;">笔试</a> <a href="/tags/%E7%AC%94%E8%AF%95%E9%9D%A2%E8%AF%95/" style="font-size: 13.33px;">笔试面试</a> <a href="/tags/%E7%AE%97%E6%B3%95/" style="font-size: 10px;">算法</a> <a href="/tags/%E9%80%92%E5%BD%92/" style="font-size: 10px;">递归</a>
    </div>
</div>
    
    
        <div class="column-right-shadow is-hidden-widescreen is-sticky">
        
            

    <div class="card widget" id="toc">
        <div class="card-content">
            <div class="menu">
                <h3 class="menu-label">
                    目录
                </h3>
                <ul class="menu-list"><li>
        <a class="is-flex" href="#一、基础">
        <!-- 目录是否自动编号 -->
        <!-- <span class="has-mr-6">1</span> -->
        <span>一、基础</span>
        </a><ul class="menu-list"><li>
        <a class="is-flex" href="#1-1-unity编辑器">
        <!-- 目录是否自动编号 -->
        <!-- <span class="has-mr-6">1.1</span> -->
        <span>1.1 unity编辑器</span>
        </a></li><li>
        <a class="is-flex" href="#1-2-地形系统">
        <!-- 目录是否自动编号 -->
        <!-- <span class="has-mr-6">1.2</span> -->
        <span>1.2 地形系统</span>
        </a></li><li>
        <a class="is-flex" href="#1-3-标准资源包">
        <!-- 目录是否自动编号 -->
        <!-- <span class="has-mr-6">1.3</span> -->
        <span>1.3 标准资源包</span>
        </a></li><li>
        <a class="is-flex" href="#1-4-脚本">
        <!-- 目录是否自动编号 -->
        <!-- <span class="has-mr-6">1.4</span> -->
        <span>1.4 脚本</span>
        </a></li><li>
        <a class="is-flex" href="#1-5-发布">
        <!-- 目录是否自动编号 -->
        <!-- <span class="has-mr-6">1.5</span> -->
        <span>1.5 发布</span>
        </a><ul class="menu-list"><li>
        <a class="is-flex" href="#1-5-1制作游戏欢迎页面">
        <!-- 目录是否自动编号 -->
        <!-- <span class="has-mr-6">1.5.1</span> -->
        <span>1.5.1制作游戏欢迎页面</span>
        </a></li><li>
        <a class="is-flex" href="#1-5-2-非全屏">
        <!-- 目录是否自动编号 -->
        <!-- <span class="has-mr-6">1.5.2</span> -->
        <span>1.5.2 非全屏</span>
        </a></li></ul></li></ul></li><li>
        <a class="is-flex" href="#二、动画">
        <!-- 目录是否自动编号 -->
        <!-- <span class="has-mr-6">2</span> -->
        <span>二、动画</span>
        </a><ul class="menu-list"><li>
        <a class="is-flex" href="#2-1-场景动画">
        <!-- 目录是否自动编号 -->
        <!-- <span class="has-mr-6">2.1</span> -->
        <span>2.1 场景动画</span>
        </a><ul class="menu-list"><li>
        <a class="is-flex" href="#2-1-1-录制">
        <!-- 目录是否自动编号 -->
        <!-- <span class="has-mr-6">2.1.1</span> -->
        <span>2.1.1 录制</span>
        </a></li><li>
        <a class="is-flex" href="#2-1-2-多段动画的状态机转换">
        <!-- 目录是否自动编号 -->
        <!-- <span class="has-mr-6">2.1.2</span> -->
        <span>2.1.2 多段动画的状态机转换</span>
        </a></li><li>
        <a class="is-flex" href="#2-1-3-event">
        <!-- 目录是否自动编号 -->
        <!-- <span class="has-mr-6">2.1.3</span> -->
        <span>2.1.3 event</span>
        </a></li></ul></li><li>
        <a class="is-flex" href="#2-2-骨骼动画">
        <!-- 目录是否自动编号 -->
        <!-- <span class="has-mr-6">2.2</span> -->
        <span>2.2 骨骼动画</span>
        </a><ul class="menu-list"><li>
        <a class="is-flex" href="#2-2-1-space-robot-kyle资源包和配置">
        <!-- 目录是否自动编号 -->
        <!-- <span class="has-mr-6">2.2.1</span> -->
        <span>2.2.1 space robot kyle资源包和配置</span>
        </a></li><li>
        <a class="is-flex" href="#2-2-2-骨骼动画交互效果说明">
        <!-- 目录是否自动编号 -->
        <!-- <span class="has-mr-6">2.2.2</span> -->
        <span>2.2.2 骨骼动画交互效果说明</span>
        </a></li></ul></li><li>
        <a class="is-flex" href="#2-3-曲线">
        <!-- 目录是否自动编号 -->
        <!-- <span class="has-mr-6">2.3</span> -->
        <span>2.3 曲线</span>
        </a></li><li>
        <a class="is-flex" href="#2-4-动画层">
        <!-- 目录是否自动编号 -->
        <!-- <span class="has-mr-6">2.4</span> -->
        <span>2.4 动画层</span>
        </a><ul class="menu-list"><li>
        <a class="is-flex" href="#2-4-1-动画层的添加">
        <!-- 目录是否自动编号 -->
        <!-- <span class="has-mr-6">2.4.1</span> -->
        <span>2.4.1 动画层的添加</span>
        </a></li><li>
        <a class="is-flex" href="#2-4-2-遮罩mask">
        <!-- 目录是否自动编号 -->
        <!-- <span class="has-mr-6">2.4.2</span> -->
        <span>2.4.2 遮罩mask</span>
        </a></li><li>
        <a class="is-flex" href="#2-4-3同步Sync">
        <!-- 目录是否自动编号 -->
        <!-- <span class="has-mr-6">2.4.3</span> -->
        <span>2.4.3同步Sync</span>
        </a></li><li>
        <a class="is-flex" href="#2-4-2-脚本方式叠加层">
        <!-- 目录是否自动编号 -->
        <!-- <span class="has-mr-6">2.4.4</span> -->
        <span>2.4.2 脚本方式叠加层</span>
        </a></li></ul></li><li>
        <a class="is-flex" href="#2-5-逆向运动学：注释动画">
        <!-- 目录是否自动编号 -->
        <!-- <span class="has-mr-6">2.5</span> -->
        <span>2.5 逆向运动学：注释动画</span>
        </a></li><li>
        <a class="is-flex" href="#2-6-逆向运动学：末端节点动画">
        <!-- 目录是否自动编号 -->
        <!-- <span class="has-mr-6">2.6</span> -->
        <span>2.6 逆向运动学：末端节点动画</span>
        </a></li><li>
        <a class="is-flex" href="#2-7-子状态">
        <!-- 目录是否自动编号 -->
        <!-- <span class="has-mr-6">2.7</span> -->
        <span>2.7 子状态</span>
        </a><ul class="menu-list"><li>
        <a class="is-flex" href="#2-7-1-创建子状态">
        <!-- 目录是否自动编号 -->
        <!-- <span class="has-mr-6">2.7.1</span> -->
        <span>2.7.1 创建子状态</span>
        </a></li><li>
        <a class="is-flex" href="#2-7-2-带条件转换">
        <!-- 目录是否自动编号 -->
        <!-- <span class="has-mr-6">2.7.2</span> -->
        <span>2.7.2 带条件转换</span>
        </a></li></ul></li><li>
        <a class="is-flex" href="#2-8-blend-tree">
        <!-- 目录是否自动编号 -->
        <!-- <span class="has-mr-6">2.8</span> -->
        <span>2.8 blend tree</span>
        </a><ul class="menu-list"><li>
        <a class="is-flex" href="#2-8-1-创建blend-tree">
        <!-- 目录是否自动编号 -->
        <!-- <span class="has-mr-6">2.8.1</span> -->
        <span>2.8.1 创建blend tree</span>
        </a></li><li>
        <a class="is-flex" href="#2-8-2-direct类型">
        <!-- 目录是否自动编号 -->
        <!-- <span class="has-mr-6">2.8.2</span> -->
        <span>2.8.2 direct类型</span>
        </a></li><li>
        <a class="is-flex" href="#2-8-3-二维笛卡尔坐标">
        <!-- 目录是否自动编号 -->
        <!-- <span class="has-mr-6">2.8.3</span> -->
        <span>2.8.3 二维笛卡尔坐标</span>
        </a></li></ul></li></ul></li><li>
        <a class="is-flex" href="#3-图形渲染">
        <!-- 目录是否自动编号 -->
        <!-- <span class="has-mr-6">3</span> -->
        <span>3. 图形渲染</span>
        </a><ul class="menu-list"><li>
        <a class="is-flex" href="#3-1-全局光照明效果">
        <!-- 目录是否自动编号 -->
        <!-- <span class="has-mr-6">3.1</span> -->
        <span>3.1 全局光照明效果</span>
        </a></li><li>
        <a class="is-flex" href="#3-2-材质，着色器和纹理">
        <!-- 目录是否自动编号 -->
        <!-- <span class="has-mr-6">3.2</span> -->
        <span>3.2 材质，着色器和纹理</span>
        </a></li><li>
        <a class="is-flex" href="#3-3-摄像机设置">
        <!-- 目录是否自动编号 -->
        <!-- <span class="has-mr-6">3.3</span> -->
        <span>3.3 摄像机设置</span>
        </a></li><li>
        <a class="is-flex" href="#3-4-剔除">
        <!-- 目录是否自动编号 -->
        <!-- <span class="has-mr-6">3.4</span> -->
        <span>3.4 剔除</span>
        </a></li><li>
        <a class="is-flex" href="#3-5-后处理效果PostProcess">
        <!-- 目录是否自动编号 -->
        <!-- <span class="has-mr-6">3.5</span> -->
        <span>3.5 后处理效果PostProcess</span>
        </a></li><li>
        <a class="is-flex" href="#3-6-探针">
        <!-- 目录是否自动编号 -->
        <!-- <span class="has-mr-6">3.6</span> -->
        <span>3.6 探针</span>
        </a><ul class="menu-list"><li>
        <a class="is-flex" href="#3-6-1-光照探针">
        <!-- 目录是否自动编号 -->
        <!-- <span class="has-mr-6">3.6.1</span> -->
        <span>3.6.1 光照探针</span>
        </a></li><li>
        <a class="is-flex" href="#3-6-2-反射探针">
        <!-- 目录是否自动编号 -->
        <!-- <span class="has-mr-6">3.6.2</span> -->
        <span>3.6.2 反射探针</span>
        </a></li></ul></li><li>
        <a class="is-flex" href="#3-7-视频播放">
        <!-- 目录是否自动编号 -->
        <!-- <span class="has-mr-6">3.7</span> -->
        <span>3.7 视频播放</span>
        </a></li><li>
        <a class="is-flex" href="#3-8-粒子系统">
        <!-- 目录是否自动编号 -->
        <!-- <span class="has-mr-6">3.8</span> -->
        <span>3.8 粒子系统</span>
        </a></li></ul></li><li>
        <a class="is-flex" href="#4-UI">
        <!-- 目录是否自动编号 -->
        <!-- <span class="has-mr-6">4</span> -->
        <span>4. UI</span>
        </a></li><li>
        <a class="is-flex" href="#5-物理系统">
        <!-- 目录是否自动编号 -->
        <!-- <span class="has-mr-6">5</span> -->
        <span>5. 物理系统</span>
        </a><ul class="menu-list"><li>
        <a class="is-flex" href="#5-1-物理仿真基础">
        <!-- 目录是否自动编号 -->
        <!-- <span class="has-mr-6">5.1</span> -->
        <span>5.1 物理仿真基础</span>
        </a></li><li>
        <a class="is-flex" href="#5-2-仿真子弹效果">
        <!-- 目录是否自动编号 -->
        <!-- <span class="has-mr-6">5.2</span> -->
        <span>5.2 仿真子弹效果</span>
        </a><ul class="menu-list"><li>
        <a class="is-flex" href="#5-2-1-预制件">
        <!-- 目录是否自动编号 -->
        <!-- <span class="has-mr-6">5.2.1</span> -->
        <span>5.2.1 预制件</span>
        </a></li></ul></li><li>
        <a class="is-flex" href="#5-3-关节结构">
        <!-- 目录是否自动编号 -->
        <!-- <span class="has-mr-6">5.3</span> -->
        <span>5.3 关节结构</span>
        </a><ul class="menu-list"><li>
        <a class="is-flex" href="#hinge-joint">
        <!-- 目录是否自动编号 -->
        <!-- <span class="has-mr-6">5.3.1</span> -->
        <span>hinge joint</span>
        </a></li><li>
        <a class="is-flex" href="#spring-joint">
        <!-- 目录是否自动编号 -->
        <!-- <span class="has-mr-6">5.3.2</span> -->
        <span>spring joint</span>
        </a></li><li>
        <a class="is-flex" href="#破坏joint">
        <!-- 目录是否自动编号 -->
        <!-- <span class="has-mr-6">5.3.3</span> -->
        <span>破坏joint</span>
        </a></li></ul></li><li>
        <a class="is-flex" href="#5-4-碰撞事件">
        <!-- 目录是否自动编号 -->
        <!-- <span class="has-mr-6">5.4</span> -->
        <span>5.4 碰撞事件</span>
        </a></li></ul></li><li>
        <a class="is-flex" href="#6-人工智能">
        <!-- 目录是否自动编号 -->
        <!-- <span class="has-mr-6">6</span> -->
        <span>6. 人工智能</span>
        </a><ul class="menu-list"><li>
        <a class="is-flex" href="#6-1-自动寻路">
        <!-- 目录是否自动编号 -->
        <!-- <span class="has-mr-6">6.1</span> -->
        <span>6.1 自动寻路</span>
        </a><ul class="menu-list"><li>
        <a class="is-flex" href="#台阶跳跃">
        <!-- 目录是否自动编号 -->
        <!-- <span class="has-mr-6">6.1.1</span> -->
        <span>台阶跳跃</span>
        </a></li><li>
        <a class="is-flex" href="#移动的障碍物">
        <!-- 目录是否自动编号 -->
        <!-- <span class="has-mr-6">6.1.2</span> -->
        <span>移动的障碍物</span>
        </a></li></ul></li><li>
        <a class="is-flex" href="#6-2-敌人巡逻">
        <!-- 目录是否自动编号 -->
        <!-- <span class="has-mr-6">6.2</span> -->
        <span>6.2 敌人巡逻</span>
        </a></li><li>
        <a class="is-flex" href="#6-3-敌人视野">
        <!-- 目录是否自动编号 -->
        <!-- <span class="has-mr-6">6.3</span> -->
        <span>6.3 敌人视野</span>
        </a></li><li>
        <a class="is-flex" href="#6-4-攻击与追踪">
        <!-- 目录是否自动编号 -->
        <!-- <span class="has-mr-6">6.4</span> -->
        <span>6.4 攻击与追踪</span>
        </a></li></ul></li><li>
        <a class="is-flex" href="#7-音频">
        <!-- 目录是否自动编号 -->
        <!-- <span class="has-mr-6">7</span> -->
        <span>7. 音频</span>
        </a><ul class="menu-list"><li>
        <a class="is-flex" href="#7-1-音频基础">
        <!-- 目录是否自动编号 -->
        <!-- <span class="has-mr-6">7.1</span> -->
        <span>7.1 音频基础</span>
        </a></li><li>
        <a class="is-flex" href="#7-2-混音器">
        <!-- 目录是否自动编号 -->
        <!-- <span class="has-mr-6">7.2</span> -->
        <span>7.2 混音器</span>
        </a></li><li>
        <a class="is-flex" href="#7-3-音效">
        <!-- 目录是否自动编号 -->
        <!-- <span class="has-mr-6">7.3</span> -->
        <span>7.3 音效</span>
        </a><ul class="menu-list"><li>
        <a class="is-flex" href="#脚本控制">
        <!-- 目录是否自动编号 -->
        <!-- <span class="has-mr-6">7.3.1</span> -->
        <span>脚本控制</span>
        </a></li></ul></li></ul></li><li>
        <a class="is-flex" href="#8-网络">
        <!-- 目录是否自动编号 -->
        <!-- <span class="has-mr-6">8</span> -->
        <span>8. 网络</span>
        </a><ul class="menu-list"><li>
        <a class="is-flex" href="#8-1-双玩家连线">
        <!-- 目录是否自动编号 -->
        <!-- <span class="has-mr-6">8.1</span> -->
        <span>8.1 双玩家连线</span>
        </a><ul class="menu-list"><li>
        <a class="is-flex" href="#踩坑：预制件的修改">
        <!-- 目录是否自动编号 -->
        <!-- <span class="has-mr-6">8.1.1</span> -->
        <span>踩坑：预制件的修改</span>
        </a></li></ul></li><li>
        <a class="is-flex" href="#8-2-联网子弹">
        <!-- 目录是否自动编号 -->
        <!-- <span class="has-mr-6">8.2</span> -->
        <span>8.2 联网子弹</span>
        </a></li><li>
        <a class="is-flex" href="#8-3-NPC">
        <!-- 目录是否自动编号 -->
        <!-- <span class="has-mr-6">8.3</span> -->
        <span>8.3 NPC</span>
        </a></li></ul></li><li>
        <a class="is-flex" href="#9-时间轴">
        <!-- 目录是否自动编号 -->
        <!-- <span class="has-mr-6">9</span> -->
        <span>9. 时间轴</span>
        </a><ul class="menu-list"><li>
        <a class="is-flex" href="#9-2-创建time-line">
        <!-- 目录是否自动编号 -->
        <!-- <span class="has-mr-6">9.1</span> -->
        <span>9.2 创建time line</span>
        </a></li><li>
        <a class="is-flex" href="#9-1-和动画的异同">
        <!-- 目录是否自动编号 -->
        <!-- <span class="has-mr-6">9.2</span> -->
        <span>9.1 和动画的异同</span>
        </a><ul class="menu-list"><li>
        <a class="is-flex" href="#动画轨道">
        <!-- 目录是否自动编号 -->
        <!-- <span class="has-mr-6">9.2.1</span> -->
        <span>动画轨道</span>
        </a></li><li>
        <a class="is-flex" href="#音频轨道audio-track">
        <!-- 目录是否自动编号 -->
        <!-- <span class="has-mr-6">9.2.2</span> -->
        <span>音频轨道audio track</span>
        </a></li><li>
        <a class="is-flex" href="#控制轨道-control-track">
        <!-- 目录是否自动编号 -->
        <!-- <span class="has-mr-6">9.2.3</span> -->
        <span>控制轨道 control track</span>
        </a></li><li>
        <a class="is-flex" href="#自定义轨道Playeable-track">
        <!-- 目录是否自动编号 -->
        <!-- <span class="has-mr-6">9.2.4</span> -->
        <span>自定义轨道Playeable track</span>
        </a></li></ul></li><li>
        <a class="is-flex" href="#9-3-角色动画">
        <!-- 目录是否自动编号 -->
        <!-- <span class="has-mr-6">9.3</span> -->
        <span>9.3 角色动画</span>
        </a></li><li>
        <a class="is-flex" href="#9-4-脚本控制">
        <!-- 目录是否自动编号 -->
        <!-- <span class="has-mr-6">9.4</span> -->
        <span>9.4 脚本控制</span>
        </a></li><li>
        <a class="is-flex" href="#9-5-Cinemachine">
        <!-- 目录是否自动编号 -->
        <!-- <span class="has-mr-6">9.5</span> -->
        <span>9.5 Cinemachine</span>
        </a></li></ul></li><li>
        <a class="is-flex" href="#10-2D游戏">
        <!-- 目录是否自动编号 -->
        <!-- <span class="has-mr-6">10</span> -->
        <span>10. 2D游戏</span>
        </a><ul class="menu-list"><li>
        <a class="is-flex" href="#10-1-精灵">
        <!-- 目录是否自动编号 -->
        <!-- <span class="has-mr-6">10.1</span> -->
        <span>10.1 精灵</span>
        </a></li><li>
        <a class="is-flex" href="#10-2-瓦片地图">
        <!-- 目录是否自动编号 -->
        <!-- <span class="has-mr-6">10.2</span> -->
        <span>10.2 瓦片地图</span>
        </a><ul class="menu-list"><li>
        <a class="is-flex" href="#10-2-1-碰撞体">
        <!-- 目录是否自动编号 -->
        <!-- <span class="has-mr-6">10.2.1</span> -->
        <span>10.2.1 碰撞体</span>
        </a></li></ul></li><li>
        <a class="is-flex" href="#10-3-角色控制">
        <!-- 目录是否自动编号 -->
        <!-- <span class="has-mr-6">10.3</span> -->
        <span>10.3 角色控制</span>
        </a></li></ul></li><li>
        <a class="is-flex" href="#11-天空盒">
        <!-- 目录是否自动编号 -->
        <!-- <span class="has-mr-6">11</span> -->
        <span>11. 天空盒</span>
        </a></li><li>
        <a class="is-flex" href="#12-忽略碰撞检测">
        <!-- 目录是否自动编号 -->
        <!-- <span class="has-mr-6">12</span> -->
        <span>12. 忽略碰撞检测</span>
        </a></li></ul>
            </div>
        </div>
    </div>

        
            <div class="card widget">
    <div class="card-content">
        <h3 class="menu-label">
            推荐阅读
        </h3>
        
        <article class="media">
            
            <a href="/Others/line-it-node-editor/" class="media-left">
                <p class="image is-64x64">
                    <img class="thumbnail" src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20250401154214355.jpeg" alt="Line-It 节点编辑器">
                </p>
            </a>
            
            <div class="media-content">
                <div class="content">
                    <div><time class="has-text-grey is-size-7 is-uppercase" datetime="2025-04-01T07:28:20.000Z">2025-04-01</time></div>
                    <a href="/Others/line-it-node-editor/" class="title has-link-black-ter is-size-6 has-text-weight-normal">Line-It 节点编辑器</a>
                    <p class="is-size-7 is-uppercase">
                        <a class="has-link-grey -link" href="/categories/Others/">Others</a>
                    </p>
                </div>
            </div>
        </article>
        
        <article class="media">
            
            <a href="/games/Unity3D-note/" class="media-left">
                <p class="image is-64x64">
                    <img class="thumbnail" src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210728004637.jpg" alt="Unity3D学习笔记">
                </p>
            </a>
            
            <div class="media-content">
                <div class="content">
                    <div><time class="has-text-grey is-size-7 is-uppercase" datetime="2021-07-28T12:42:07.000Z">2021-07-28</time></div>
                    <a href="/games/Unity3D-note/" class="title has-link-black-ter is-size-6 has-text-weight-normal">Unity3D学习笔记</a>
                    <p class="is-size-7 is-uppercase">
                        <a class="has-link-grey -link" href="/categories/games/">游戏和引擎</a>
                    </p>
                </div>
            </div>
        </article>
        
        <article class="media">
            
            <a href="/life/%E4%B8%BA%E6%AF%95%E4%B8%9A%E5%81%9A%E5%87%86%E5%A4%87/" class="media-left">
                <p class="image is-64x64">
                    <img class="thumbnail" src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210717225951.jpeg" alt="为毕业做准备">
                </p>
            </a>
            
            <div class="media-content">
                <div class="content">
                    <div><time class="has-text-grey is-size-7 is-uppercase" datetime="2021-03-31T13:13:32.000Z">2021-03-31</time></div>
                    <a href="/life/%E4%B8%BA%E6%AF%95%E4%B8%9A%E5%81%9A%E5%87%86%E5%A4%87/" class="title has-link-black-ter is-size-6 has-text-weight-normal">为毕业做准备</a>
                    <p class="is-size-7 is-uppercase">
                        <a class="has-link-grey -link" href="/categories/life/">生活随笔</a>
                    </p>
                </div>
            </div>
        </article>
        
        <article class="media">
            
            <a href="/life/mhxy-experience/" class="media-left">
                <p class="image is-64x64">
                    <img class="thumbnail" src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210717223725.png" alt="梦幻西游游戏体验">
                </p>
            </a>
            
            <div class="media-content">
                <div class="content">
                    <div><time class="has-text-grey is-size-7 is-uppercase" datetime="2021-03-31T08:29:35.000Z">2021-03-31</time></div>
                    <a href="/life/mhxy-experience/" class="title has-link-black-ter is-size-6 has-text-weight-normal">梦幻西游游戏体验</a>
                    <p class="is-size-7 is-uppercase">
                        <a class="has-link-grey -link" href="/categories/life/">生活随笔</a>
                    </p>
                </div>
            </div>
        </article>
        
        <article class="media">
            
            <a href="/games/3DMath-Primerfor-Graphics-and-Game-Development-note/" class="media-left">
                <p class="image is-64x64">
                    <img class="thumbnail" src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210717223435.jpeg" alt="3D数学基础图形与游戏研发笔记">
                </p>
            </a>
            
            <div class="media-content">
                <div class="content">
                    <div><time class="has-text-grey is-size-7 is-uppercase" datetime="2021-03-06T10:55:07.000Z">2021-03-06</time></div>
                    <a href="/games/3DMath-Primerfor-Graphics-and-Game-Development-note/" class="title has-link-black-ter is-size-6 has-text-weight-normal">3D数学基础图形与游戏研发笔记</a>
                    <p class="is-size-7 is-uppercase">
                        <a class="has-link-grey -link" href="/categories/games/">游戏和引擎</a>
                    </p>
                </div>
            </div>
        </article>
        
    </div>
</div>
        
        </div>
    
</div>

                




<div class="column is-4-tablet is-4-desktop is-3-widescreen is-hidden-touch is-hidden-desktop-only has-order-3 column-right is-sticky">
    
        

    <div class="card widget" id="toc">
        <div class="card-content">
            <div class="menu">
                <h3 class="menu-label">
                    目录
                </h3>
                <ul class="menu-list"><li>
        <a class="is-flex" href="#一、基础">
        <!-- 目录是否自动编号 -->
        <!-- <span class="has-mr-6">1</span> -->
        <span>一、基础</span>
        </a><ul class="menu-list"><li>
        <a class="is-flex" href="#1-1-unity编辑器">
        <!-- 目录是否自动编号 -->
        <!-- <span class="has-mr-6">1.1</span> -->
        <span>1.1 unity编辑器</span>
        </a></li><li>
        <a class="is-flex" href="#1-2-地形系统">
        <!-- 目录是否自动编号 -->
        <!-- <span class="has-mr-6">1.2</span> -->
        <span>1.2 地形系统</span>
        </a></li><li>
        <a class="is-flex" href="#1-3-标准资源包">
        <!-- 目录是否自动编号 -->
        <!-- <span class="has-mr-6">1.3</span> -->
        <span>1.3 标准资源包</span>
        </a></li><li>
        <a class="is-flex" href="#1-4-脚本">
        <!-- 目录是否自动编号 -->
        <!-- <span class="has-mr-6">1.4</span> -->
        <span>1.4 脚本</span>
        </a></li><li>
        <a class="is-flex" href="#1-5-发布">
        <!-- 目录是否自动编号 -->
        <!-- <span class="has-mr-6">1.5</span> -->
        <span>1.5 发布</span>
        </a><ul class="menu-list"><li>
        <a class="is-flex" href="#1-5-1制作游戏欢迎页面">
        <!-- 目录是否自动编号 -->
        <!-- <span class="has-mr-6">1.5.1</span> -->
        <span>1.5.1制作游戏欢迎页面</span>
        </a></li><li>
        <a class="is-flex" href="#1-5-2-非全屏">
        <!-- 目录是否自动编号 -->
        <!-- <span class="has-mr-6">1.5.2</span> -->
        <span>1.5.2 非全屏</span>
        </a></li></ul></li></ul></li><li>
        <a class="is-flex" href="#二、动画">
        <!-- 目录是否自动编号 -->
        <!-- <span class="has-mr-6">2</span> -->
        <span>二、动画</span>
        </a><ul class="menu-list"><li>
        <a class="is-flex" href="#2-1-场景动画">
        <!-- 目录是否自动编号 -->
        <!-- <span class="has-mr-6">2.1</span> -->
        <span>2.1 场景动画</span>
        </a><ul class="menu-list"><li>
        <a class="is-flex" href="#2-1-1-录制">
        <!-- 目录是否自动编号 -->
        <!-- <span class="has-mr-6">2.1.1</span> -->
        <span>2.1.1 录制</span>
        </a></li><li>
        <a class="is-flex" href="#2-1-2-多段动画的状态机转换">
        <!-- 目录是否自动编号 -->
        <!-- <span class="has-mr-6">2.1.2</span> -->
        <span>2.1.2 多段动画的状态机转换</span>
        </a></li><li>
        <a class="is-flex" href="#2-1-3-event">
        <!-- 目录是否自动编号 -->
        <!-- <span class="has-mr-6">2.1.3</span> -->
        <span>2.1.3 event</span>
        </a></li></ul></li><li>
        <a class="is-flex" href="#2-2-骨骼动画">
        <!-- 目录是否自动编号 -->
        <!-- <span class="has-mr-6">2.2</span> -->
        <span>2.2 骨骼动画</span>
        </a><ul class="menu-list"><li>
        <a class="is-flex" href="#2-2-1-space-robot-kyle资源包和配置">
        <!-- 目录是否自动编号 -->
        <!-- <span class="has-mr-6">2.2.1</span> -->
        <span>2.2.1 space robot kyle资源包和配置</span>
        </a></li><li>
        <a class="is-flex" href="#2-2-2-骨骼动画交互效果说明">
        <!-- 目录是否自动编号 -->
        <!-- <span class="has-mr-6">2.2.2</span> -->
        <span>2.2.2 骨骼动画交互效果说明</span>
        </a></li></ul></li><li>
        <a class="is-flex" href="#2-3-曲线">
        <!-- 目录是否自动编号 -->
        <!-- <span class="has-mr-6">2.3</span> -->
        <span>2.3 曲线</span>
        </a></li><li>
        <a class="is-flex" href="#2-4-动画层">
        <!-- 目录是否自动编号 -->
        <!-- <span class="has-mr-6">2.4</span> -->
        <span>2.4 动画层</span>
        </a><ul class="menu-list"><li>
        <a class="is-flex" href="#2-4-1-动画层的添加">
        <!-- 目录是否自动编号 -->
        <!-- <span class="has-mr-6">2.4.1</span> -->
        <span>2.4.1 动画层的添加</span>
        </a></li><li>
        <a class="is-flex" href="#2-4-2-遮罩mask">
        <!-- 目录是否自动编号 -->
        <!-- <span class="has-mr-6">2.4.2</span> -->
        <span>2.4.2 遮罩mask</span>
        </a></li><li>
        <a class="is-flex" href="#2-4-3同步Sync">
        <!-- 目录是否自动编号 -->
        <!-- <span class="has-mr-6">2.4.3</span> -->
        <span>2.4.3同步Sync</span>
        </a></li><li>
        <a class="is-flex" href="#2-4-2-脚本方式叠加层">
        <!-- 目录是否自动编号 -->
        <!-- <span class="has-mr-6">2.4.4</span> -->
        <span>2.4.2 脚本方式叠加层</span>
        </a></li></ul></li><li>
        <a class="is-flex" href="#2-5-逆向运动学：注释动画">
        <!-- 目录是否自动编号 -->
        <!-- <span class="has-mr-6">2.5</span> -->
        <span>2.5 逆向运动学：注释动画</span>
        </a></li><li>
        <a class="is-flex" href="#2-6-逆向运动学：末端节点动画">
        <!-- 目录是否自动编号 -->
        <!-- <span class="has-mr-6">2.6</span> -->
        <span>2.6 逆向运动学：末端节点动画</span>
        </a></li><li>
        <a class="is-flex" href="#2-7-子状态">
        <!-- 目录是否自动编号 -->
        <!-- <span class="has-mr-6">2.7</span> -->
        <span>2.7 子状态</span>
        </a><ul class="menu-list"><li>
        <a class="is-flex" href="#2-7-1-创建子状态">
        <!-- 目录是否自动编号 -->
        <!-- <span class="has-mr-6">2.7.1</span> -->
        <span>2.7.1 创建子状态</span>
        </a></li><li>
        <a class="is-flex" href="#2-7-2-带条件转换">
        <!-- 目录是否自动编号 -->
        <!-- <span class="has-mr-6">2.7.2</span> -->
        <span>2.7.2 带条件转换</span>
        </a></li></ul></li><li>
        <a class="is-flex" href="#2-8-blend-tree">
        <!-- 目录是否自动编号 -->
        <!-- <span class="has-mr-6">2.8</span> -->
        <span>2.8 blend tree</span>
        </a><ul class="menu-list"><li>
        <a class="is-flex" href="#2-8-1-创建blend-tree">
        <!-- 目录是否自动编号 -->
        <!-- <span class="has-mr-6">2.8.1</span> -->
        <span>2.8.1 创建blend tree</span>
        </a></li><li>
        <a class="is-flex" href="#2-8-2-direct类型">
        <!-- 目录是否自动编号 -->
        <!-- <span class="has-mr-6">2.8.2</span> -->
        <span>2.8.2 direct类型</span>
        </a></li><li>
        <a class="is-flex" href="#2-8-3-二维笛卡尔坐标">
        <!-- 目录是否自动编号 -->
        <!-- <span class="has-mr-6">2.8.3</span> -->
        <span>2.8.3 二维笛卡尔坐标</span>
        </a></li></ul></li></ul></li><li>
        <a class="is-flex" href="#3-图形渲染">
        <!-- 目录是否自动编号 -->
        <!-- <span class="has-mr-6">3</span> -->
        <span>3. 图形渲染</span>
        </a><ul class="menu-list"><li>
        <a class="is-flex" href="#3-1-全局光照明效果">
        <!-- 目录是否自动编号 -->
        <!-- <span class="has-mr-6">3.1</span> -->
        <span>3.1 全局光照明效果</span>
        </a></li><li>
        <a class="is-flex" href="#3-2-材质，着色器和纹理">
        <!-- 目录是否自动编号 -->
        <!-- <span class="has-mr-6">3.2</span> -->
        <span>3.2 材质，着色器和纹理</span>
        </a></li><li>
        <a class="is-flex" href="#3-3-摄像机设置">
        <!-- 目录是否自动编号 -->
        <!-- <span class="has-mr-6">3.3</span> -->
        <span>3.3 摄像机设置</span>
        </a></li><li>
        <a class="is-flex" href="#3-4-剔除">
        <!-- 目录是否自动编号 -->
        <!-- <span class="has-mr-6">3.4</span> -->
        <span>3.4 剔除</span>
        </a></li><li>
        <a class="is-flex" href="#3-5-后处理效果PostProcess">
        <!-- 目录是否自动编号 -->
        <!-- <span class="has-mr-6">3.5</span> -->
        <span>3.5 后处理效果PostProcess</span>
        </a></li><li>
        <a class="is-flex" href="#3-6-探针">
        <!-- 目录是否自动编号 -->
        <!-- <span class="has-mr-6">3.6</span> -->
        <span>3.6 探针</span>
        </a><ul class="menu-list"><li>
        <a class="is-flex" href="#3-6-1-光照探针">
        <!-- 目录是否自动编号 -->
        <!-- <span class="has-mr-6">3.6.1</span> -->
        <span>3.6.1 光照探针</span>
        </a></li><li>
        <a class="is-flex" href="#3-6-2-反射探针">
        <!-- 目录是否自动编号 -->
        <!-- <span class="has-mr-6">3.6.2</span> -->
        <span>3.6.2 反射探针</span>
        </a></li></ul></li><li>
        <a class="is-flex" href="#3-7-视频播放">
        <!-- 目录是否自动编号 -->
        <!-- <span class="has-mr-6">3.7</span> -->
        <span>3.7 视频播放</span>
        </a></li><li>
        <a class="is-flex" href="#3-8-粒子系统">
        <!-- 目录是否自动编号 -->
        <!-- <span class="has-mr-6">3.8</span> -->
        <span>3.8 粒子系统</span>
        </a></li></ul></li><li>
        <a class="is-flex" href="#4-UI">
        <!-- 目录是否自动编号 -->
        <!-- <span class="has-mr-6">4</span> -->
        <span>4. UI</span>
        </a></li><li>
        <a class="is-flex" href="#5-物理系统">
        <!-- 目录是否自动编号 -->
        <!-- <span class="has-mr-6">5</span> -->
        <span>5. 物理系统</span>
        </a><ul class="menu-list"><li>
        <a class="is-flex" href="#5-1-物理仿真基础">
        <!-- 目录是否自动编号 -->
        <!-- <span class="has-mr-6">5.1</span> -->
        <span>5.1 物理仿真基础</span>
        </a></li><li>
        <a class="is-flex" href="#5-2-仿真子弹效果">
        <!-- 目录是否自动编号 -->
        <!-- <span class="has-mr-6">5.2</span> -->
        <span>5.2 仿真子弹效果</span>
        </a><ul class="menu-list"><li>
        <a class="is-flex" href="#5-2-1-预制件">
        <!-- 目录是否自动编号 -->
        <!-- <span class="has-mr-6">5.2.1</span> -->
        <span>5.2.1 预制件</span>
        </a></li></ul></li><li>
        <a class="is-flex" href="#5-3-关节结构">
        <!-- 目录是否自动编号 -->
        <!-- <span class="has-mr-6">5.3</span> -->
        <span>5.3 关节结构</span>
        </a><ul class="menu-list"><li>
        <a class="is-flex" href="#hinge-joint">
        <!-- 目录是否自动编号 -->
        <!-- <span class="has-mr-6">5.3.1</span> -->
        <span>hinge joint</span>
        </a></li><li>
        <a class="is-flex" href="#spring-joint">
        <!-- 目录是否自动编号 -->
        <!-- <span class="has-mr-6">5.3.2</span> -->
        <span>spring joint</span>
        </a></li><li>
        <a class="is-flex" href="#破坏joint">
        <!-- 目录是否自动编号 -->
        <!-- <span class="has-mr-6">5.3.3</span> -->
        <span>破坏joint</span>
        </a></li></ul></li><li>
        <a class="is-flex" href="#5-4-碰撞事件">
        <!-- 目录是否自动编号 -->
        <!-- <span class="has-mr-6">5.4</span> -->
        <span>5.4 碰撞事件</span>
        </a></li></ul></li><li>
        <a class="is-flex" href="#6-人工智能">
        <!-- 目录是否自动编号 -->
        <!-- <span class="has-mr-6">6</span> -->
        <span>6. 人工智能</span>
        </a><ul class="menu-list"><li>
        <a class="is-flex" href="#6-1-自动寻路">
        <!-- 目录是否自动编号 -->
        <!-- <span class="has-mr-6">6.1</span> -->
        <span>6.1 自动寻路</span>
        </a><ul class="menu-list"><li>
        <a class="is-flex" href="#台阶跳跃">
        <!-- 目录是否自动编号 -->
        <!-- <span class="has-mr-6">6.1.1</span> -->
        <span>台阶跳跃</span>
        </a></li><li>
        <a class="is-flex" href="#移动的障碍物">
        <!-- 目录是否自动编号 -->
        <!-- <span class="has-mr-6">6.1.2</span> -->
        <span>移动的障碍物</span>
        </a></li></ul></li><li>
        <a class="is-flex" href="#6-2-敌人巡逻">
        <!-- 目录是否自动编号 -->
        <!-- <span class="has-mr-6">6.2</span> -->
        <span>6.2 敌人巡逻</span>
        </a></li><li>
        <a class="is-flex" href="#6-3-敌人视野">
        <!-- 目录是否自动编号 -->
        <!-- <span class="has-mr-6">6.3</span> -->
        <span>6.3 敌人视野</span>
        </a></li><li>
        <a class="is-flex" href="#6-4-攻击与追踪">
        <!-- 目录是否自动编号 -->
        <!-- <span class="has-mr-6">6.4</span> -->
        <span>6.4 攻击与追踪</span>
        </a></li></ul></li><li>
        <a class="is-flex" href="#7-音频">
        <!-- 目录是否自动编号 -->
        <!-- <span class="has-mr-6">7</span> -->
        <span>7. 音频</span>
        </a><ul class="menu-list"><li>
        <a class="is-flex" href="#7-1-音频基础">
        <!-- 目录是否自动编号 -->
        <!-- <span class="has-mr-6">7.1</span> -->
        <span>7.1 音频基础</span>
        </a></li><li>
        <a class="is-flex" href="#7-2-混音器">
        <!-- 目录是否自动编号 -->
        <!-- <span class="has-mr-6">7.2</span> -->
        <span>7.2 混音器</span>
        </a></li><li>
        <a class="is-flex" href="#7-3-音效">
        <!-- 目录是否自动编号 -->
        <!-- <span class="has-mr-6">7.3</span> -->
        <span>7.3 音效</span>
        </a><ul class="menu-list"><li>
        <a class="is-flex" href="#脚本控制">
        <!-- 目录是否自动编号 -->
        <!-- <span class="has-mr-6">7.3.1</span> -->
        <span>脚本控制</span>
        </a></li></ul></li></ul></li><li>
        <a class="is-flex" href="#8-网络">
        <!-- 目录是否自动编号 -->
        <!-- <span class="has-mr-6">8</span> -->
        <span>8. 网络</span>
        </a><ul class="menu-list"><li>
        <a class="is-flex" href="#8-1-双玩家连线">
        <!-- 目录是否自动编号 -->
        <!-- <span class="has-mr-6">8.1</span> -->
        <span>8.1 双玩家连线</span>
        </a><ul class="menu-list"><li>
        <a class="is-flex" href="#踩坑：预制件的修改">
        <!-- 目录是否自动编号 -->
        <!-- <span class="has-mr-6">8.1.1</span> -->
        <span>踩坑：预制件的修改</span>
        </a></li></ul></li><li>
        <a class="is-flex" href="#8-2-联网子弹">
        <!-- 目录是否自动编号 -->
        <!-- <span class="has-mr-6">8.2</span> -->
        <span>8.2 联网子弹</span>
        </a></li><li>
        <a class="is-flex" href="#8-3-NPC">
        <!-- 目录是否自动编号 -->
        <!-- <span class="has-mr-6">8.3</span> -->
        <span>8.3 NPC</span>
        </a></li></ul></li><li>
        <a class="is-flex" href="#9-时间轴">
        <!-- 目录是否自动编号 -->
        <!-- <span class="has-mr-6">9</span> -->
        <span>9. 时间轴</span>
        </a><ul class="menu-list"><li>
        <a class="is-flex" href="#9-2-创建time-line">
        <!-- 目录是否自动编号 -->
        <!-- <span class="has-mr-6">9.1</span> -->
        <span>9.2 创建time line</span>
        </a></li><li>
        <a class="is-flex" href="#9-1-和动画的异同">
        <!-- 目录是否自动编号 -->
        <!-- <span class="has-mr-6">9.2</span> -->
        <span>9.1 和动画的异同</span>
        </a><ul class="menu-list"><li>
        <a class="is-flex" href="#动画轨道">
        <!-- 目录是否自动编号 -->
        <!-- <span class="has-mr-6">9.2.1</span> -->
        <span>动画轨道</span>
        </a></li><li>
        <a class="is-flex" href="#音频轨道audio-track">
        <!-- 目录是否自动编号 -->
        <!-- <span class="has-mr-6">9.2.2</span> -->
        <span>音频轨道audio track</span>
        </a></li><li>
        <a class="is-flex" href="#控制轨道-control-track">
        <!-- 目录是否自动编号 -->
        <!-- <span class="has-mr-6">9.2.3</span> -->
        <span>控制轨道 control track</span>
        </a></li><li>
        <a class="is-flex" href="#自定义轨道Playeable-track">
        <!-- 目录是否自动编号 -->
        <!-- <span class="has-mr-6">9.2.4</span> -->
        <span>自定义轨道Playeable track</span>
        </a></li></ul></li><li>
        <a class="is-flex" href="#9-3-角色动画">
        <!-- 目录是否自动编号 -->
        <!-- <span class="has-mr-6">9.3</span> -->
        <span>9.3 角色动画</span>
        </a></li><li>
        <a class="is-flex" href="#9-4-脚本控制">
        <!-- 目录是否自动编号 -->
        <!-- <span class="has-mr-6">9.4</span> -->
        <span>9.4 脚本控制</span>
        </a></li><li>
        <a class="is-flex" href="#9-5-Cinemachine">
        <!-- 目录是否自动编号 -->
        <!-- <span class="has-mr-6">9.5</span> -->
        <span>9.5 Cinemachine</span>
        </a></li></ul></li><li>
        <a class="is-flex" href="#10-2D游戏">
        <!-- 目录是否自动编号 -->
        <!-- <span class="has-mr-6">10</span> -->
        <span>10. 2D游戏</span>
        </a><ul class="menu-list"><li>
        <a class="is-flex" href="#10-1-精灵">
        <!-- 目录是否自动编号 -->
        <!-- <span class="has-mr-6">10.1</span> -->
        <span>10.1 精灵</span>
        </a></li><li>
        <a class="is-flex" href="#10-2-瓦片地图">
        <!-- 目录是否自动编号 -->
        <!-- <span class="has-mr-6">10.2</span> -->
        <span>10.2 瓦片地图</span>
        </a><ul class="menu-list"><li>
        <a class="is-flex" href="#10-2-1-碰撞体">
        <!-- 目录是否自动编号 -->
        <!-- <span class="has-mr-6">10.2.1</span> -->
        <span>10.2.1 碰撞体</span>
        </a></li></ul></li><li>
        <a class="is-flex" href="#10-3-角色控制">
        <!-- 目录是否自动编号 -->
        <!-- <span class="has-mr-6">10.3</span> -->
        <span>10.3 角色控制</span>
        </a></li></ul></li><li>
        <a class="is-flex" href="#11-天空盒">
        <!-- 目录是否自动编号 -->
        <!-- <span class="has-mr-6">11</span> -->
        <span>11. 天空盒</span>
        </a></li><li>
        <a class="is-flex" href="#12-忽略碰撞检测">
        <!-- 目录是否自动编号 -->
        <!-- <span class="has-mr-6">12</span> -->
        <span>12. 忽略碰撞检测</span>
        </a></li></ul>
            </div>
        </div>
    </div>

    
        <div class="card widget">
    <div class="card-content">
        <h3 class="menu-label">
            推荐阅读
        </h3>
        
        <article class="media">
            
            <a href="/Others/line-it-node-editor/" class="media-left">
                <p class="image is-64x64">
                    <img class="thumbnail" src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20250401154214355.jpeg" alt="Line-It 节点编辑器">
                </p>
            </a>
            
            <div class="media-content">
                <div class="content">
                    <div><time class="has-text-grey is-size-7 is-uppercase" datetime="2025-04-01T07:28:20.000Z">2025-04-01</time></div>
                    <a href="/Others/line-it-node-editor/" class="title has-link-black-ter is-size-6 has-text-weight-normal">Line-It 节点编辑器</a>
                    <p class="is-size-7 is-uppercase">
                        <a class="has-link-grey -link" href="/categories/Others/">Others</a>
                    </p>
                </div>
            </div>
        </article>
        
        <article class="media">
            
            <a href="/games/Unity3D-note/" class="media-left">
                <p class="image is-64x64">
                    <img class="thumbnail" src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210728004637.jpg" alt="Unity3D学习笔记">
                </p>
            </a>
            
            <div class="media-content">
                <div class="content">
                    <div><time class="has-text-grey is-size-7 is-uppercase" datetime="2021-07-28T12:42:07.000Z">2021-07-28</time></div>
                    <a href="/games/Unity3D-note/" class="title has-link-black-ter is-size-6 has-text-weight-normal">Unity3D学习笔记</a>
                    <p class="is-size-7 is-uppercase">
                        <a class="has-link-grey -link" href="/categories/games/">游戏和引擎</a>
                    </p>
                </div>
            </div>
        </article>
        
        <article class="media">
            
            <a href="/life/%E4%B8%BA%E6%AF%95%E4%B8%9A%E5%81%9A%E5%87%86%E5%A4%87/" class="media-left">
                <p class="image is-64x64">
                    <img class="thumbnail" src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210717225951.jpeg" alt="为毕业做准备">
                </p>
            </a>
            
            <div class="media-content">
                <div class="content">
                    <div><time class="has-text-grey is-size-7 is-uppercase" datetime="2021-03-31T13:13:32.000Z">2021-03-31</time></div>
                    <a href="/life/%E4%B8%BA%E6%AF%95%E4%B8%9A%E5%81%9A%E5%87%86%E5%A4%87/" class="title has-link-black-ter is-size-6 has-text-weight-normal">为毕业做准备</a>
                    <p class="is-size-7 is-uppercase">
                        <a class="has-link-grey -link" href="/categories/life/">生活随笔</a>
                    </p>
                </div>
            </div>
        </article>
        
        <article class="media">
            
            <a href="/life/mhxy-experience/" class="media-left">
                <p class="image is-64x64">
                    <img class="thumbnail" src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210717223725.png" alt="梦幻西游游戏体验">
                </p>
            </a>
            
            <div class="media-content">
                <div class="content">
                    <div><time class="has-text-grey is-size-7 is-uppercase" datetime="2021-03-31T08:29:35.000Z">2021-03-31</time></div>
                    <a href="/life/mhxy-experience/" class="title has-link-black-ter is-size-6 has-text-weight-normal">梦幻西游游戏体验</a>
                    <p class="is-size-7 is-uppercase">
                        <a class="has-link-grey -link" href="/categories/life/">生活随笔</a>
                    </p>
                </div>
            </div>
        </article>
        
        <article class="media">
            
            <a href="/games/3DMath-Primerfor-Graphics-and-Game-Development-note/" class="media-left">
                <p class="image is-64x64">
                    <img class="thumbnail" src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210717223435.jpeg" alt="3D数学基础图形与游戏研发笔记">
                </p>
            </a>
            
            <div class="media-content">
                <div class="content">
                    <div><time class="has-text-grey is-size-7 is-uppercase" datetime="2021-03-06T10:55:07.000Z">2021-03-06</time></div>
                    <a href="/games/3DMath-Primerfor-Graphics-and-Game-Development-note/" class="title has-link-black-ter is-size-6 has-text-weight-normal">3D数学基础图形与游戏研发笔记</a>
                    <p class="is-size-7 is-uppercase">
                        <a class="has-link-grey -link" href="/categories/games/">游戏和引擎</a>
                    </p>
                </div>
            </div>
        </article>
        
    </div>
</div>
    
    
</div>

            </div>
        </div>
    </section>
    <footer class="footer">
    <div class="container">
        <div class="level">
            <div class="level-start has-text-centered-mobile">
                <a class="footer-logo is-block has-mb-6" href="/">
                
                    <img src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210717231246.png" alt="Unity3D学习笔记" height="28">
                
                </a>
                <p class="is-size-7">
                &copy; 2025 wjw&nbsp;
                Powered by <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a> & <a
                        href="https://github.com/ppoffice/hexo-theme-icarus" target="_blank" rel="noopener">Icarus</a>
                
                <br>
                <!-- <span id="busuanzi_container_site_uv">
                共<span id="busuanzi_value_site_uv">0</span>个访客
                </span> -->
                <span id="busuanzi_container_site_uv"> 来访 <span id="busuanzi_value_site_uv"></span>人</span>
                <span id="busuanzi_container_site_pv">, 总访问 <span id="busuanzi_value_site_pv"></span>次</span>

                <span id="timeDate">载入天数...</span><span id="times">载入时分秒...</span>
                    <script>
                        var now = new Date(); 
                        function createtime() { 
                            var grt= new Date("03/06/2020 00:00:00"); /*建站时间*/
                            now.setTime(now.getTime()+250); 
                            days = (now - grt ) / 1000 / 60 / 60 / 24; dnum = Math.floor(days); 
                            hours = (now - grt ) / 1000 / 60 / 60 - (24 * dnum); hnum = Math.floor(hours); 
                            if(String(hnum).length ==1 ){hnum = "0" + hnum;} minutes = (now - grt ) / 1000 /60 - (24 * 60 * dnum) - (60 * hnum); 
                            mnum = Math.floor(minutes); if(String(mnum).length ==1 ){mnum = "0" + mnum;} 
                            seconds = (now - grt ) / 1000 - (24 * 60 * 60 * dnum) - (60 * 60 * hnum) - (60 * mnum); 
                            snum = Math.round(seconds); if(String(snum).length ==1 ){snum = "0" + snum;} 
                            document.getElementById("timeDate").innerHTML = "本站已安全运行 "+dnum+" 天 "; 
                            document.getElementById("times").innerHTML = hnum + " 小时 " + mnum + " 分 " + snum + " 秒"; 
                        } 
                    setInterval("createtime()",250);
                    </script>
                
                </p>
            </div>
            <div class="level-end">
            
                <div class="field has-addons is-flex-center-mobile has-mt-5-mobile is-flex-wrap is-flex-middle">
                
                <p class="control">
                    <a class="button is-white is-large" target="_blank" rel="noopener" title="Creative Commons" href="https://creativecommons.org/">
                        
                        <i class="fab fa-creative-commons"></i>
                        
                    </a>
                </p>
                
                <p class="control">
                    <a class="button is-white is-large" target="_blank" rel="noopener" title="Attribution 4.0 International" href="https://creativecommons.org/licenses/by/4.0/">
                        
                        <i class="fab fa-creative-commons-by"></i>
                        
                    </a>
                </p>
                
                <p class="control">
                    <a class="button is-white is-large" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/ppoffice/hexo-theme-icarus">
                        
                        <i class="fab fa-github"></i>
                        
                    </a>
                </p>
                
                </div>
            
            </div>
        </div>
    </div>
</footer>
    <script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/moment@2.22.2/min/moment-with-locales.min.js"></script>
<script>moment.locale("zh-CN");</script>


<script>
var IcarusThemeSettings = {
    site: {
        url: 'https://wjw.today',
        external_link: {"enable":true,"exclude":[]}
    },
    article: {
        highlight: {
            clipboard: true,
            fold: 'unfolded'
        }
    }
};
</script>


<script src="https://cdn.jsdelivr.net/npm/clipboard@2.0.4/dist/clipboard.min.js" defer></script>





<script src="/js/animation.js"></script>



<script src="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/js/lightgallery.min.js" defer></script>
<script src="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/js/jquery.justifiedGallery.min.js" defer></script>
<script src="/js/gallery.js" defer></script>



<div id="outdated">
    <h6>Your browser is out-of-date!</h6>
    <p>Update your browser to view this website correctly. <a id="btnUpdateBrowser" href="http://outdatedbrowser.com/">Update
            my browser now </a></p>
    <p class="last"><a href="#" id="btnCloseUpdateBrowser" title="Close">&times;</a></p>
</div>
<script src="https://cdn.jsdelivr.net/npm/outdatedbrowser@1.1.5/outdatedbrowser/outdatedbrowser.min.js" defer></script>
<script>
    document.addEventListener("DOMContentLoaded", function () {
        outdatedBrowser({
            bgColor: '#f25648',
            color: '#ffffff',
            lowerThan: 'flex'
        });
    });
</script>


<script src="https://cdn.jsdelivr.net/npm/mathjax@2.7.5/unpacked/MathJax.js?config=TeX-MML-AM_CHTML" defer></script>
<script>
document.addEventListener('DOMContentLoaded', function () {
    MathJax.Hub.Config({
        'HTML-CSS': {
            matchFontHeight: false
        },
        SVG: {
            matchFontHeight: false
        },
        CommonHTML: {
            matchFontHeight: false
        },
        tex2jax: {
            inlineMath: [
                ['$','$'],
                ['\\(','\\)']
            ]
        }
    });
});
</script>


<a id="back-to-top" title="回到顶端" href="javascript:;">
    <i class="fas fa-chevron-up"></i>
</a>
<script src="/js/back-to-top.js" defer></script>














<script src="/js/main.js" defer></script>

    
    <div class="searchbox ins-search">
    <div class="searchbox-container ins-search-container">
        <div class="searchbox-input-wrapper">
            <input type="text" class="searchbox-input ins-search-input" placeholder="想要查找什么..." />
            <span class="searchbox-close ins-close ins-selectable"><i class="fa fa-times-circle"></i></span>
        </div>
        <div class="searchbox-result-wrapper ins-section-wrapper">
            <div class="ins-section-container"></div>
        </div>
    </div>
</div>
<script>
    (function (window) {
        var INSIGHT_CONFIG = {
            TRANSLATION: {
                POSTS: '文章',
                PAGES: '页面',
                CATEGORIES: '分类',
                TAGS: '标签',
                UNTITLED: '(无标题)',
            },
            CONTENT_URL: '/content.json',
        };
        window.INSIGHT_CONFIG = INSIGHT_CONFIG;
    })(window);
</script>
<script src="/js/insight.js" defer></script>
<link rel="stylesheet" href="/css/search.css">
<link rel="stylesheet" href="/css/insight.css">
    

        <style>
            [bg-lazy] {
                background-image: none !important;
                background-color: #eee !important;
            }
        </style>
        <script>
            window.imageLazyLoadSetting = {
                isSPA: false,
                preloadRatio: 1,
                processImages: null,
            };
        </script><script>window.addEventListener("load",function(){var t=/\.(gif|jpg|jpeg|tiff|png)$/i,r=/^data:image\/[a-z\d\-\.\+]+;base64,/;Array.prototype.slice.call(document.querySelectorAll("img[data-original]")).forEach(function(a){var e=a.parentNode;"A"===e.tagName&&(t.test(e.href)||r.test(e.href))&&(e.href=a.dataset.original)})});</script><script>(r=>{r.imageLazyLoadSetting.processImages=t;var a=r.imageLazyLoadSetting.isSPA,o=r.imageLazyLoadSetting.preloadRatio||1,d=i();function i(){var t=Array.prototype.slice.call(document.querySelectorAll("img[data-original]")),e=Array.prototype.slice.call(document.querySelectorAll("[bg-lazy]"));return t.concat(e)}function t(t){(a||t)&&(d=i());for(var e,n=0;n<d.length;n++)0<=(e=(e=d[n]).getBoundingClientRect()).bottom&&0<=e.left&&e.top<=(r.innerHeight*o||document.documentElement.clientHeight*o)&&(()=>{var t,e,a,o,i=d[n];e=function(){d=d.filter(function(t){return i!==t}),r.imageLazyLoadSetting.onImageLoaded&&r.imageLazyLoadSetting.onImageLoaded(i)},(t=i).dataset.loaded||(t.hasAttribute("bg-lazy")?(t.removeAttribute("bg-lazy"),e&&e()):(a=new Image,o=t.getAttribute("data-original"),a.onload=function(){t.src=o,t.removeAttribute("data-original"),t.setAttribute("data-loaded",!0),e&&e()},a.onerror=function(){t.removeAttribute("data-original"),t.setAttribute("data-loaded",!1),t.src=o},t.src!==o&&(a.src=o)))})()}function e(){clearTimeout(t.tId),t.tId=setTimeout(t,500)}t(),document.addEventListener("scroll",e),r.addEventListener("resize",e),r.addEventListener("orientationchange",e)})(this);</script></body>
</html>