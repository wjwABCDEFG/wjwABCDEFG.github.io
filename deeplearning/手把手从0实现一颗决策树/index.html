<!DOCTYPE html>
<html  lang="zh">
<head>
    <meta charset="utf-8" />

<meta name="generator" content="Hexo 4.2.1" />

<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />

<title>手把手从0实现一颗决策树 - 小温 blog</title>


    <meta name="description" content="这是我2019-09-24在知乎上面写的文章，原文跳转点这里，今天面试java不知道为什么面试官感兴趣被提起，提起于是搬运到博客上，纯python实现，除numpy外无第三方库  前段时间数学建模我和我的小伙伴们划了个水，几个没有建模经验的小伙伴临时抱佛脚最后通了个宵，在此感谢我的队友们。抱佛脚的时候笔者对决策树起了兴趣（可惜没有用上），之前看过一点点理论相关的知识，但是没有自己实现过，这几天空">
<meta property="og:type" content="article">
<meta property="og:title" content="手把手从0实现一颗决策树">
<meta property="og:url" content="https://wjw.today/deeplearning/%E6%89%8B%E6%8A%8A%E6%89%8B%E4%BB%8E0%E5%AE%9E%E7%8E%B0%E4%B8%80%E9%A2%97%E5%86%B3%E7%AD%96%E6%A0%91/index.html">
<meta property="og:site_name" content="小温 blog">
<meta property="og:description" content="这是我2019-09-24在知乎上面写的文章，原文跳转点这里，今天面试java不知道为什么面试官感兴趣被提起，提起于是搬运到博客上，纯python实现，除numpy外无第三方库  前段时间数学建模我和我的小伙伴们划了个水，几个没有建模经验的小伙伴临时抱佛脚最后通了个宵，在此感谢我的队友们。抱佛脚的时候笔者对决策树起了兴趣（可惜没有用上），之前看过一点点理论相关的知识，但是没有自己实现过，这几天空">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210717205605.jpg">
<meta property="article:published_time" content="2020-09-17T16:46:25.000Z">
<meta property="article:modified_time" content="2021-07-17T12:58:33.946Z">
<meta property="article:author" content="wjw">
<meta property="article:tag" content="DL&#x2F;ML">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210717205605.jpg">







<link rel="icon" href="/images/favicon.ico">


<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bulma@0.7.2/css/bulma.css">
<link rel="stylesheet" href="https://cdn.bootcss.com/font-awesome/5.4.1/css/all.css">
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Ubuntu:400,600|Source+Code+Pro">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@9.12.0/styles/atom-one-dark.css">


    
    
<style>body>.footer,body>.navbar,body>.section{opacity:0}</style>

    
    
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/css/lightgallery.min.css">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/css/justifiedGallery.min.css">

    
    
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/outdatedbrowser@1.1.5/outdatedbrowser/outdatedbrowser.min.css">

    
    
    
    
<link rel="stylesheet" href="/css/back-to-top.css">

    
    
    
    
    
    
    
    <link rel="stylesheet" href="/css/progressbar.css">
<script src="https://cdn.jsdelivr.net/npm/pace-js@1.0.2/pace.min.js"></script>
    
    <script async="" src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
    


<link rel="stylesheet" href="/css/style.css">
</head>
<body class="is-3-column">
    <nav class="navbar navbar-main">
    <div class="container">
        <div class="navbar-brand is-flex-center">
            <a class="navbar-item navbar-logo" href="/">
            
                <img src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210717231246.png" alt="手把手从0实现一颗决策树" height="28">
            
            </a>
        </div>
        <div class="navbar-menu">
            
            <div class="navbar-start">
                
                <a class="navbar-item"
                href="/">主页</a>
                
                <a class="navbar-item"
                href="/archives">归档</a>
                
                <a class="navbar-item"
                href="/categories">分类</a>
                
                <a class="navbar-item"
                href="/tags">标签</a>
                
                <a class="navbar-item"
                href="/about">关于</a>
                
            </div>
            
            <div class="navbar-end">
                
                    
                    <a class="navbar-item" target="_blank" rel="noopener" title="View My GitHub" href="https://github.com/wjwABCDEFG">
                        
                        <i class="fab fa-github"></i>
                        
                    </a>
                    
                
                
                <a class="navbar-item is-hidden-tablet catalogue" title="目录" href="javascript:;">
                    <i class="fas fa-list-ul"></i>
                </a>
                
                
                <a class="navbar-item search" title="搜索" href="javascript:;">
                    <i class="fas fa-search"></i>
                </a>
                
            </div>
        </div>
    </div>
</nav>
    
    <section class="section">
        <div class="container">
            <div class="columns">
                <div class="column is-8-tablet is-8-desktop is-6-widescreen has-order-2 column-main">
<div class="card">
    
    <div class="card-image">
        <span  class="image is-7by1">
            <img class="thumbnail" src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210717205605.jpg" alt="手把手从0实现一颗决策树">
        </span>
    </div>
    
    <div class="card-content article ">
        
        <div class="level article-meta is-size-7 is-uppercase is-mobile is-overflow-x-auto">
            <div class="level-left">
                <time class="level-item has-text-grey" datetime="2020-09-17T16:46:25.000Z">2020-09-18</time>
                
                <div class="level-item">
                <a class="has-link-grey -link" href="/categories/deeplearning/">玄学</a>
                </div>
                
                
                <span class="level-item has-text-grey">
                    
                    
                    24 分钟 读完 (大约 3649 个字)
                </span>
                
                
                <span class="level-item has-text-grey" id="busuanzi_container_page_pv">
                    <i class="far fa-eye"></i>
                    <span id="busuanzi_value_page_pv">0</span>次访问
                </span>
                
            </div>
        </div>
        
        <h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal">
            
                手把手从0实现一颗决策树
            
        </h1>
        <div class="content">
            <blockquote>
<p>这是我2019-09-24在知乎上面写的文章，<a href="https://zhuanlan.zhihu.com/p/83762823">原文跳转点这里</a>，今天面试java不知道为什么面试官感兴趣被提起，提起于是搬运到博客上，纯python实现，除numpy外无第三方库</p>
</blockquote>
<p>前段时间数学建模我和我的小伙伴们划了个水，几个没有建模经验的小伙伴临时抱佛脚最后通了个宵，在此感谢我的队友们。抱佛脚的时候笔者对决策树起了兴趣（可惜没有用上），之前看过一点点理论相关的知识，但是没有自己实现过，这几天空下来决定自己从0撸一颗简单的ID3决策树。</p>
<a id="more"></a>

<p>由于我也是个新手，因此本篇文章深度有限，大神请绕道^_^，我将着重于代码的实现和整个流程的说明，通过一个案例（案例取自<a href="https://link.zhihu.com/?target=https%3A//blog.csdn.net/mn_kw/article/details/79913786">https://blog.csdn.net/mn_kw/article/details/79913786</a>，本文就是对这篇博客中的介绍进行代码实现），带你一步步看懂数据在决策树中的行为，减少理论部分的晦涩知识。快来动手跟我一起实现一颗决策树吧！</p>
<h2 id="一-什么是决策树"><a href="#一-什么是决策树" class="headerlink" title="一.什么是决策树"></a>一.什么是决策树</h2><blockquote>
<p>现想象一个女孩的母亲要给这个女孩介绍男朋友，于是有了下面的对话：<br>女儿：多大年纪了？<br>母亲：26。<br>女儿：长的帅不帅？<br>母亲：挺帅的。<br>女儿：收入高不？<br>母亲：不算很高，中等情况。<br>女儿：是公务员不？<br>母亲：是，在税务局上班呢。<br>女儿：那好，我去见见。<br>这个女孩的决策过程就是典型的分类树决策。<br>（声明：此决策树纯属为了写文章而YY的产物，没有任何根据，也不代表任何女孩的择偶倾向，请各位女同胞莫质问我^_^）<br>例子取自<a href="https://link.zhihu.com/?target=https%3A//blog.csdn.net/mn_kw/article/details/79913786">https://blog.csdn.net/mn_kw/article/details/79913786</a></p>
</blockquote>
<p>假设现在有这么一张表，统计了一些人的择偶标准，称为训练样本</p>
<p><img src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210717205630.jpeg" alt="img"></p>
<p>我们将要对其构建类似如下的判断分支结构，这就叫决策树。之后再有一组样本，我们就可以根据这棵树来判定嫁不嫁啦！</p>
<p><img src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210717205636.jpeg" alt="img"></p>
<p>看到这里你肯定会有个疑问：为什么先判断高不高？难道真是传说中的一高遮百丑吗？</p>
<p><img src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210717205645.jpeg" alt="img"></p>
<p>当然不是，我们可是有依据的！这个依据就叫做信息增益（Gain），公式如下，就是两个函数相减而已，看不懂也没关系，下面有例子说明。</p>
<p><img src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210717205649.jpeg" alt="img">)H(x)叫香农熵，H(D|x)叫条件熵&lt;br&gt;就两个函数相减而已</p>
<p>其中H(x)和H(Y|X)长下面这样</p>
<p><img src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210717205653.jpeg" alt="img">)p(x)是概率，比如矮占身高的</p>
<p><img src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210717205657.jpeg" alt="img">里面的H</p>
<blockquote>
<p>如本例中:<br>一开始嫁的个数为6个，占1/2，那么信息熵H(X)为-1/2log1/2-1/2log1/2 = -log1/2=1<br>现在假如我知道了一个男生的身高信息。<br>身高有三个可能的取值{矮，中，高}<br>矮包括{1,2,3,5,6,11,12}，嫁的个数为1个，不嫁的个数为6个<br>中包括{8,9} ，嫁的个数为2个，不嫁的个数为0个<br>高包括{4,7,10}，嫁的个数为3个，不嫁的个数为0个<br>先回忆一下条件熵的公式如下：<br>我们先求出公式对应的:<br>H(Y|X = 矮) = -1/7log1/7-6/7log6/7=0.592<br>H(Y|X=中) = -1log1-0 = 0<br>H(Y|X=高） = -1log1-0=0<br>p(X = 矮) = 7/12,p(X =中) = 2/12,p(X=高) = 3/12<br>则可以得出条件熵为：<br>7/12<em>0.592+2/12</em>0+3/12*0 = 0.345<br>那么我们知道信息熵与条件熵相减就是我们的信息增益，为<br>1-0.345=0.655<br>所以我们可以得出我们在知道了身高这个信息之后，信息增益是0.655</p>
<p>结论<br>我们可以知道，本来如果我对一个男生什么都不知道的话，作为他的女朋友决定是否嫁给他的不确定性有1.0这么大。<br>当我们知道男朋友的身高信息后，不确定度减少了0.655.也就是说，身高这个特征对于我们广大女生同学来说，决定嫁不嫁给自己的男朋友是很重要的。<br>至少我们知道了身高特征后，我们原来没有底的心里（1.0）已经明朗一半多了，减少0.655了（大于原来的一半了）。<br>那么这就类似于非诚勿扰节目里面的桥段了，请问女嘉宾，你只能知道男生的一个特征。请问你想知道哪个特征。<br>假如其它特征我也全算了，信息增益是身高这个特征最大。那么我就可以说，孟非哥哥，我想知道男嘉宾的一个特征是身高特征。因为它在这些特征中，对于我挑夫君是最重要的，信息增益是最大的，知道了这个特征，嫁与不嫁的不确定度减少的是最多的。<br>取自<a href="https://link.zhihu.com/?target=https%3A//blog.csdn.net/mn_kw/article/details/79913786">https://blog.csdn.net/mn_kw/article/details/79913786</a></p>
</blockquote>
<br>

<h2 id="二-代码实现"><a href="#二-代码实现" class="headerlink" title="二.代码实现"></a>二.代码实现</h2><p>1.咱们先来构建我们的数据，我用的是python3(day1)</p>
<p><img src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210717205707.jpeg" alt="img"></p>
<p>表头</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">datas_header &#x3D; [&#39;是否帅&#39;, &#39;脾气是否好&#39;, &#39;是否高&#39;, &#39;是否上进&#39;, &#39;结果&#39;]</span><br></pre></td></tr></table></figure>

<p>数据</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">import numpy as np</span><br><span class="line">datas &#x3D; np.array([[&#39;帅&#39;, &#39;不好&#39;, &#39;矮&#39;, &#39;不上进&#39;],</span><br><span class="line">                  [&#39;不帅&#39;, &#39;好&#39;, &#39;矮&#39;, &#39;上进&#39;],</span><br><span class="line">                  [&#39;帅&#39;, &#39;好&#39;, &#39;矮&#39;, &#39;上进&#39;],</span><br><span class="line">                  [&#39;不帅&#39;, &#39;爆好&#39;, &#39;高&#39;, &#39;上进&#39;],</span><br><span class="line">                  [&#39;帅&#39;, &#39;不好&#39;, &#39;矮&#39;, &#39;上进&#39;],</span><br><span class="line">                  [&#39;帅&#39;, &#39;不好&#39;, &#39;矮&#39;, &#39;上进&#39;],</span><br><span class="line">                  [&#39;帅&#39;, &#39;好&#39;, &#39;高&#39;, &#39;不上进&#39;],</span><br><span class="line">                  [&#39;不帅&#39;, &#39;好&#39;, &#39;中&#39;, &#39;上进&#39;],</span><br><span class="line">                  [&#39;帅&#39;, &#39;爆好&#39;, &#39;中&#39;, &#39;上进&#39;],</span><br><span class="line">                  [&#39;不帅&#39;, &#39;不好&#39;, &#39;高&#39;, &#39;上进&#39;],</span><br><span class="line">                  [&#39;帅&#39;, &#39;好&#39;, &#39;矮&#39;, &#39;不上进&#39;],</span><br><span class="line">                  [&#39;帅&#39;, &#39;好&#39;, &#39;矮&#39;, &#39;不上进&#39;]])</span><br></pre></td></tr></table></figure>

<p>标签</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">labels &#x3D; np.array([&#39;不嫁&#39;, &#39;不嫁&#39;, &#39;嫁&#39;, &#39;嫁&#39;, &#39;不嫁&#39;, &#39;不嫁&#39;, &#39;嫁&#39;, &#39;嫁&#39;, &#39;嫁&#39;, &#39;嫁&#39;, &#39;不嫁&#39;, &#39;不嫁&#39;])</span><br></pre></td></tr></table></figure>

<p>2.明确代码流程，自顶向下设计，自底向上实现</p>
<p><img src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210717205717.jpeg" alt="img"></p>
<p>3.实现香农熵</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">def get_shannon_entropy(labels: np.ndarray) -&gt; float:</span><br><span class="line">    &quot;&quot;&quot;</span><br><span class="line">    计算香农熵</span><br><span class="line">    即H(X)&#x3D;−∑(i&#x3D;1,n)pi * log2pi</span><br><span class="line">    :param labels: shape &#x3D; (n, )，n个标签</span><br><span class="line">    :return: float香农熵值</span><br><span class="line">    &quot;&quot;&quot;</span><br><span class="line">    num_labels &#x3D; len(labels)</span><br><span class="line">    labels_dic &#x3D; &#123;&#125;     # 考虑到labels不一定是数字，我们用字典来装</span><br><span class="line">    shannon_entropy &#x3D; 0</span><br><span class="line">    for label in labels:        # 统计各label个数，本例中最后labels_dic格式为&#123;&quot;嫁&quot;:6, &quot;不嫁&quot;:6&#125;</span><br><span class="line">        if label not in labels_dic.keys():</span><br><span class="line">            labels_dic[label] &#x3D; 0</span><br><span class="line">        labels_dic[label] +&#x3D; 1</span><br><span class="line"></span><br><span class="line">    for i in labels_dic.keys():</span><br><span class="line">        prob &#x3D; labels_dic[i] &#x2F; num_labels</span><br><span class="line">        shannon_entropy +&#x3D; - prob * np.log2(prob)</span><br><span class="line"></span><br><span class="line">    return shannon_entropy</span><br></pre></td></tr></table></figure>

<p><img src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210717205741.jpeg" alt="img"></p>
<p>4.实现条件熵(day2)</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">def get_conditional_entropy(datas: np.ndarray, labels: np.ndarray) -&gt; float:</span><br><span class="line">    &quot;&quot;&quot;</span><br><span class="line">    接下来的条件熵</span><br><span class="line">    即H(Y|X)&#x3D;∑(i&#x3D;1,n)piH(Y|X&#x3D;xi)     H就是上面的香农熵呀！ Y就是嫁不嫁呀！ X就是当前的特征呀！</span><br><span class="line">    本例中其中一个特征举例：高中矮，则表现为</span><br><span class="line">    H(Y|X) &#x3D; p矮 * H(嫁|X &#x3D; 矮) + p中 * H(嫁|X &#x3D; 中) + p高 * H(嫁|X &#x3D; 高)</span><br><span class="line">    :param datas:某个特征下所有人的取值，例如[&#39;矮&#39;, &#39;矮&#39;, &#39;矮&#39;, &#39;高&#39;, &#39;矮&#39;, &#39;矮&#39;, &#39;高&#39;, &#39;中&#39;, &#39;中&#39;, &#39;高&#39;, &#39;矮&#39;, &#39;矮&#39;]</span><br><span class="line">    :param labels:该特征下嫁或不嫁的结果，例如[&#39;不嫁&#39;, &#39;不嫁&#39;, &#39;嫁&#39;, &#39;嫁&#39;, &#39;不嫁&#39;, &#39;不嫁&#39;, &#39;嫁&#39;, &#39;嫁&#39;, &#39;嫁&#39;, &#39;嫁&#39;, &#39;不嫁&#39;, &#39;不嫁&#39;]</span><br><span class="line">    :return:</span><br><span class="line">    &quot;&quot;&quot;</span><br><span class="line">    num_data &#x3D; len(datas)</span><br><span class="line">    conditional_entropy &#x3D; 0</span><br><span class="line">    num_class &#x3D; &#123;&#125;    # 先得知道身高特征分成了几类（高中矮3类）,每类占多少</span><br><span class="line">    for class_val in datas:     # for循环完后结果为num_class &#x3D; &#123;&quot;矮&quot;: 7, &quot;中&quot;: 2, &quot;高&quot;: 3&#125;</span><br><span class="line">        if class_val not in num_class.keys():</span><br><span class="line">            num_class[class_val] &#x3D; 0</span><br><span class="line">        num_class[class_val] +&#x3D; 1</span><br><span class="line"></span><br><span class="line">    for i in num_class.keys():</span><br><span class="line">        prob &#x3D; num_class[i] &#x2F; num_data</span><br><span class="line">        index &#x3D; np.argwhere(datas &#x3D;&#x3D; i).squeeze()  # 以下两句获得datas中&#39;矮&#39;的下标并找出每个&#39;矮&#39;对应的labels值</span><br><span class="line">        # print(index.shape)</span><br><span class="line">        if index.shape !&#x3D; ():          # 这里如果不这么处理会出问题，就是index只有一个数的情况,index &#x3D; 2，type显示ndarray没有问题，shape却显示()而不是(1,)</span><br><span class="line">            i_labels &#x3D; labels[index]    # 造成这句的结果居然是i_labels &#x3D; &#39;no&#39; 而不是[&#39;no&#39;],于是在后面遍历的时候变成了&#39;n&#39;和&#39;o&#39;，这不是我们想要的</span><br><span class="line">        else:</span><br><span class="line">            i_labels &#x3D; list([])               # 通过先限定i_labels的类型，使用append的方式添加，这时候i_labels就会是想要的[&#39;no&#39;],后面遍历的时候就是遍历数组中的这一个元素</span><br><span class="line">            i_labels.append(labels[index])</span><br><span class="line">        conditional_entropy +&#x3D; prob * get_shannon_entropy(i_labels)</span><br><span class="line">    return conditional_entropy</span><br></pre></td></tr></table></figure>

<p><img src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210717205746.png" alt="img"></p>
<p>5.获得最佳信息增益gain值和对应特征</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">def get_best_gain(datas: np.ndarray, labels: np.ndarray) -&gt; (float, float):</span><br><span class="line">    &quot;&quot;&quot;</span><br><span class="line">    计算信息增益，并找出最佳的信息增益值，作为当前最佳的划分依据</span><br><span class="line">    即g(D,X)&#x3D;H(D)−H(D|X)     H就是香农熵呀！ H(D|X)就是信息熵呀！</span><br><span class="line">    best_gain &#x3D; max(g(D,X))</span><br><span class="line">    :param datas: shape(n, m) n条数据，m种特征</span><br><span class="line">    :param labels: shape &#x3D; (n, )，n个标签</span><br><span class="line">    :return:返回最佳特征和对应的gain值</span><br><span class="line">    &quot;&quot;&quot;</span><br><span class="line">    best_gain &#x3D; 0</span><br><span class="line">    best_feature &#x3D; -1</span><br><span class="line">    (num_data, num_feature) &#x3D; datas.shape</span><br><span class="line">    for feature in range(num_feature):    #遍历每个特征，找出到底谁的信息增益值最大</span><br><span class="line">        current_data &#x3D; datas[:, feature]</span><br><span class="line">        gain &#x3D; get_shannon_entropy(labels) - get_conditional_entropy(current_data, labels)     # 公式</span><br><span class="line">        if gain &gt; best_gain:</span><br><span class="line">            best_gain &#x3D; gain</span><br><span class="line">            best_feature &#x3D; feature</span><br><span class="line">    return best_feature, best_gain</span><br></pre></td></tr></table></figure>

<p><img src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210717205754.jpeg" alt="img"></p>
<p>6.建树(day3)</p>
<p>由于要建树，树型结构就需要建立起来，本来也打算存在数据结构中，但是就在这时候看到了csdn上一篇博客里的树是这样用字典来保存</p>
<p><img src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210717205758.png" alt="img">博客地址<a href="https://blog.csdn.net/hongbin_xu/article/details/78516114">https://blog.csdn.net/hongbin_xu/article/details/78516114</a></p>
<p>我的天！！！惊到我了，学！用字典建树</p>
<iframe frameborder="0" allowfullscreen="" src="https://www.zhihu.com/video/1159917336533549056?autoplay=false&amp;useMSE=" style="display: block; width: 688px; height: 387px;"></iframe>

<p>输入数据变化过程</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line">def create_tree(datas_header: list, datas: np.ndarray, labels: np.ndarray) -&gt; dict:</span><br><span class="line">    &quot;&quot;&quot;</span><br><span class="line">    get_best_gain()是给一组datas,labels计算一次最佳划分特征</span><br><span class="line">    要构建一棵决策树，那必须要在划分完剩下的数据集继续划分(递归过程)，直到以下情况出现：</span><br><span class="line">    1.剩下全部结果都是相同的，那么直接作为结果。</span><br><span class="line">      如在本例中，假如最佳分组为帅或者不帅，帅对应的labels全部为嫁，则不用继续讨论后面的分组。同理，如果不帅中既有嫁和不嫁，那么需要继续递归</span><br><span class="line">    2.遍历完了所有特征，但是还是无法得到唯一标签，则少数服从多数。</span><br><span class="line">      假如在本例中，遍历到最后一组特征：是否上进，但上进的组里还是有嫁或者不嫁两种标签，且较多为嫁，那就让她嫁</span><br><span class="line">    :param datas_header:</span><br><span class="line">    :param datas:</span><br><span class="line">    :param labels:</span><br><span class="line">    :return:</span><br><span class="line">    &quot;&quot;&quot;</span><br><span class="line">    # 结束条件1</span><br><span class="line">    if list(labels).count(labels[0]) &#x3D;&#x3D; len(labels):</span><br><span class="line">        return labels[0]</span><br><span class="line">    # 结束条件2</span><br><span class="line">    if len(datas) &#x3D;&#x3D; 0 and len(set(labels)) &gt; 1:</span><br><span class="line">        result_num &#x3D; &#123;&#125;</span><br><span class="line">        for result in labels:</span><br><span class="line">            if result not in result_num.keys():</span><br><span class="line">                result_num[result] &#x3D; 0</span><br><span class="line">            result_num[result] +&#x3D; 1</span><br><span class="line">        more &#x3D; -1</span><br><span class="line">        decide &#x3D; &#39;&#39;</span><br><span class="line">        for result, num in result_num.items():</span><br><span class="line">            if num &gt; more:</span><br><span class="line">                more &#x3D; num</span><br><span class="line">                decide &#x3D; result</span><br><span class="line">        return decide</span><br><span class="line"></span><br><span class="line">    cur_best_feature_num, _ &#x3D; get_best_gain(datas, labels)</span><br><span class="line">    cur_best_feature_name &#x3D; datas_header[cur_best_feature_num]</span><br><span class="line"></span><br><span class="line">    # 首先知道该特征下有什么值      本例中class_val &#x3D; &#123;&#39;帅&#39;， &#39;不帅&#39;&#125;</span><br><span class="line">    class_val &#x3D; set([data[cur_best_feature_num] for data in datas])</span><br><span class="line">    trees &#x3D; &#123;cur_best_feature_name: &#123;&#125;&#125;</span><br><span class="line">    for val in class_val:   # 逐一找出每个特征值的数据      本例中表现为含&#39;帅&#39;&#x2F;&#39;不帅&#39;的数据</span><br><span class="line">        new_datas &#x3D; [datas[i] for i in range(len(datas)) if datas[i, cur_best_feature_num] &#x3D;&#x3D; val]    # 用列表生成式，读作:遍历datas每行，找到每行的&#39;是否帅&#39;特征下值为&#39;帅&#39;的行，返回该行</span><br><span class="line">        new_labels &#x3D; [labels[i] for i in range(len(datas)) if datas[i, cur_best_feature_num] &#x3D;&#x3D; val]</span><br><span class="line"></span><br><span class="line">        new_datas &#x3D; np.delete(new_datas, cur_best_feature_num, axis&#x3D;1)     # 删除最佳列，准备进入下一个划分依据，即删掉</span><br><span class="line">        new_datas_header &#x3D; np.delete(datas_header, cur_best_feature_num)</span><br><span class="line">        # 递归:去掉该行该列再丢进</span><br><span class="line">        trees[cur_best_feature_name][val] &#x3D; create_tree(list(new_datas_header), new_datas, np.array(new_labels))</span><br><span class="line">    return trees</span><br></pre></td></tr></table></figure>

<p><img src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210717205810.png" alt="img"></p>
<p>7.预测，树建完了，预测时我们就要递归遍历字典(day4)</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">def predict_result(trees_model: dict, input_data: np, datas_header: list) -&gt; str:</span><br><span class="line">    &quot;&quot;&quot;</span><br><span class="line">    1.找字典中的第一个划分特征      本例中是&#39;是否高&#39;</span><br><span class="line">    2.在datas_header中找到高是第几个特征       本例中是第2个特征</span><br><span class="line">    3.在input_data中找到这个特征对应的值        比如要预测的数据中是否高（第二个特征）取值为矮</span><br><span class="line">    4.找到字典中的&#39;矮&#39;的值，如果为str(嫁不嫁)，则直接返回结果，如果是字典，则进行下一个节点预测（递归）</span><br><span class="line">    :param trees_model:</span><br><span class="line">    :param input_data:</span><br><span class="line">    :param datas_header:</span><br><span class="line">    :return:</span><br><span class="line">    &quot;&quot;&quot;</span><br><span class="line">    cur_judge &#x3D; list(trees_model.keys())[0]     # &#39;是否高&#39;</span><br><span class="line">    num_feature &#x3D; datas_header.index(cur_judge)     # 本例中是第2个特征</span><br><span class="line">    cur_val &#x3D; input_data[num_feature]       # 比如要预测的数据中是否高（第二个特征）取值为矮</span><br><span class="line">    cur_tree &#x3D; trees_model[cur_judge]</span><br><span class="line">    # print(type(cur_tree[cur_val]))</span><br><span class="line">    if type(cur_tree[cur_val]) &#x3D;&#x3D; np.str_:</span><br><span class="line">        return cur_tree[cur_val]</span><br><span class="line">    return predict_result(cur_tree[cur_val], input_data, datas_header)</span><br></pre></td></tr></table></figure>

<p><img src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210717205817.jpeg" alt="img"></p>
<p>8.保存和读取模型文件</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"># 保存和读取函数</span><br><span class="line">def store_tree(input_tree, filename):</span><br><span class="line">    import pickle</span><br><span class="line">    with open(filename, &#39;wb&#39;) as f:</span><br><span class="line">        pickle.dump(input_tree, f)</span><br><span class="line">        f.close()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def restore_tree(filename):</span><br><span class="line">    import pickle</span><br><span class="line">    with open(filename, &#39;rb&#39;) as f:</span><br><span class="line">        return pickle.load(f)</span><br></pre></td></tr></table></figure>

<p>通过这棵树，我们就知道，<strong>帅与否并不是影响你勾搭小姐姐主要的因素</strong>，这给了作者足够的自信，好了，我去勾搭小姐姐啦！</p>
<p><img src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210717205822.png" alt="img"></p>
<p>代码已上传github，地址为<a href="https://link.zhihu.com/?target=https%3A//github.com/wjwABCDEFG/wjw-DecisionTree">https://github.com/wjwABCDEFG/wjw-DecisionTree</a></p>
<p>百度网盘地址为<a href="https://link.zhihu.com/?target=https%3A//pan.baidu.com/s/18O1OpU1hPfHdoAh_qVF1-Q">https://pan.baidu.com/s/18O1OpU1hPfHdoAh_qVF1-Q</a>提取码7qdv</p>
<p>零零散散耗时4天，写文章又需要琢磨，感觉说的还不是很清楚，有不懂的可以交流，打算以后有空就实现一些简单的机器学习模型，代码菜鸟，风格不太好，多多包涵，如有错误，欢迎指正。</p>

        </div>
        
        <div class="level is-size-7 is-uppercase">
            <div class="level-start">
                <div class="level-item">
                    <span class="is-size-6 has-text-grey has-mr-7">#</span>
                    <a class="has-link-grey -link" href="/tags/DL-ML/" rel="tag">DL/ML</a>
                </div>
            </div>
        </div>
        
        
        
    </div>
</div>





<div class="card card-transparent">
    <div class="level post-navigation is-flex-wrap is-mobile">
        
        <div class="level-start">
            <a class="level level-item has-link-grey  article-nav-prev" href="/algorithms/backtrace-template/">
                <i class="level-item fas fa-chevron-left"></i>
                <span class="level-item">回溯模板</span>
            </a>
        </div>
        
        
        <div class="level-end">
            <a class="level level-item has-link-grey  article-nav-next" href="/algorithms/combination-sum-ii/">
                <span class="level-item">40-组合总和II</span>
                <i class="level-item fas fa-chevron-right"></i>
            </a>
        </div>
        
    </div>
</div>



<div class="card">
    <div class="card-content">
        <h3 class="title is-5 has-text-weight-normal">评论</h3>
        
<div id="valine-thread" class="content"></div>
<!-- <script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script> -->
<script src="//code.bdstatic.com/npm/leancloud-storage@4.12.0/dist/av-min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/valine@1.3.10/dist/Valine.min.js"></script>
<script>
    new Valine({
        el: '#valine-thread' ,
        notify: false,
        verify: false,
        app_id: 'JK6SpCImIdMNJd75JUpXY0ee-gzGzoHsz',
        app_key: 'Do5gvzKuVTiSa5Woy1bXzbYv',
        placeholder: '留下评论吧~'
    });
</script>

    </div>
</div>
</div>
                




<div class="column is-4-tablet is-4-desktop is-3-widescreen  has-order-1 column-left ">
    
        
<div class="card widget">
    <div class="card-content">
        <nav class="level">
            <div class="level-item has-text-centered" style="flex-shrink: 1">
                <div>
                    
                    <figure class="image is-128x128 has-mb-6">
                        <img class="is-rounded" src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210717231547.jpeg" alt="wjwABCDEFG">
                    </figure>
                    
                    <p class="is-size-4 is-block">
                        wjwABCDEFG
                    </p>
                    
                    
                    
                    <p class="is-size-6 is-flex is-flex-center has-text-grey">
                        <i class="fas fa-map-marker-alt has-mr-7"></i>
                        <span>Shaoguan, China</span>
                    </p>
                    
                </div>
            </div>
        </nav>
        <nav class="level is-mobile">
            <div class="level-item has-text-centered is-marginless">
                <div>
                    <p class="heading">
                        文章
                    </p>
                    <a href="/archives">
                        <p class="title has-text-weight-normal">
                            103
                        </p>
                    </a>
                </div>
            </div>
            <div class="level-item has-text-centered is-marginless">
                <div>
                    <p class="heading">
                        分类
                    </p>
                    <a href="/categories">
                        <p class="title has-text-weight-normal">
                            14
                        </p>
                    </a>
                </div>
            </div>
            <div class="level-item has-text-centered is-marginless">
                <div>
                    <p class="heading">
                        标签
                    </p>
                    <a href="/tags">
                        <p class="title has-text-weight-normal">
                            26
                        </p>
                    </a>
                </div>
            </div>
        </nav>
        
        <div class="level">
            <a class="level-item button is-link is-rounded" href="https://github.com/wjwABCDEFG" target="_blank" rel="noopener">
                关注我</a>
        </div>
        
        
        
    </div>
</div>
    
        
<div class="card widget">
    <div class="card-content">
        <div class="menu">
            <h3 class="menu-label">
                分类
            </h3>
            <ul class="menu-list">
            <li>
        <a class="level is-marginless" href="/categories/Java%E5%9F%BA%E7%A1%80/">
            <span class="level-start">
                <span class="level-item">Java基础</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">7</span>
            </span>
        </a></li><li>
        <a class="level is-marginless" href="/categories/Mysql/">
            <span class="level-start">
                <span class="level-item">Mysql</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">3</span>
            </span>
        </a></li><li>
        <a class="level is-marginless" href="/categories/Others/">
            <span class="level-start">
                <span class="level-item">Others</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">8</span>
            </span>
        </a></li><li>
        <a class="level is-marginless" href="/categories/Spring/">
            <span class="level-start">
                <span class="level-item">Spring</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">6</span>
            </span>
        </a></li><li>
        <a class="level is-marginless" href="/categories/SpringCloud/">
            <span class="level-start">
                <span class="level-item">SpringCloud</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">4</span>
            </span>
        </a></li><li>
        <a class="level is-marginless" href="/categories/util/">
            <span class="level-start">
                <span class="level-item">Util工具类</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">3</span>
            </span>
        </a></li><li>
        <a class="level is-marginless" href="/categories/redis/">
            <span class="level-start">
                <span class="level-item">redis</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">1</span>
            </span>
        </a></li><li>
        <a class="level is-marginless" href="/categories/frontend/">
            <span class="level-start">
                <span class="level-item">前端</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">3</span>
            </span>
        </a></li><li>
        <a class="level is-marginless" href="/categories/algorithms/">
            <span class="level-start">
                <span class="level-item">数据结构和算法</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">60</span>
            </span>
        </a></li><li>
        <a class="level is-marginless" href="/categories/games/">
            <span class="level-start">
                <span class="level-item">游戏和引擎</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">2</span>
            </span>
        </a></li><li>
        <a class="level is-marginless" href="/categories/deeplearning/">
            <span class="level-start">
                <span class="level-item">玄学</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">1</span>
            </span>
        </a></li><li>
        <a class="level is-marginless" href="/categories/life/">
            <span class="level-start">
                <span class="level-item">生活随笔</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">6</span>
            </span>
        </a></li><li>
        <a class="level is-marginless" href="/categories/cs/">
            <span class="level-start">
                <span class="level-item">计算机基础</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">1</span>
            </span>
        </a></li><li>
        <a class="level is-marginless" href="/categories/designpattern/">
            <span class="level-start">
                <span class="level-item">设计模式</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">1</span>
            </span>
        </a></li>
            </ul>
        </div>
    </div>
</div>
    
        <div class="card widget">
    <div class="card-content">
        <h3 class="menu-label">
            标签云
        </h3>
        <a href="/tags/DL-ML/" style="font-size: 10px;">DL/ML</a> <a href="/tags/http/" style="font-size: 10px;">http</a> <a href="/tags/lintcode/" style="font-size: 10px;">lintcode</a> <a href="/tags/markdown/" style="font-size: 10px;">markdown</a> <a href="/tags/mysql/" style="font-size: 11.67px;">mysql</a> <a href="/tags/spring/" style="font-size: 11.67px;">spring</a> <a href="/tags/springcloud/" style="font-size: 10px;">springcloud</a> <a href="/tags/%E4%BA%8C%E5%88%86%E6%9F%A5%E6%89%BE/" style="font-size: 10px;">二分查找</a> <a href="/tags/%E5%89%91%E6%8C%87offer/" style="font-size: 10px;">剑指offer</a> <a href="/tags/%E5%8A%9B%E6%89%A3/" style="font-size: 20px;">力扣</a> <a href="/tags/%E5%8A%A0%E5%AF%86/" style="font-size: 10px;">加密</a> <a href="/tags/%E5%8A%A8%E6%80%81%E8%A7%84%E5%88%92/" style="font-size: 13.33px;">动态规划</a> <a href="/tags/%E5%8D%95%E8%B0%83%E6%A0%88/" style="font-size: 15px;">单调栈</a> <a href="/tags/%E5%9B%9E%E6%BA%AF/" style="font-size: 16.67px;">回溯</a> <a href="/tags/%E5%AD%97%E7%AC%A6%E4%B8%B2/" style="font-size: 10px;">字符串</a> <a href="/tags/%E5%AD%A6%E4%B9%A0%E8%AE%B0%E5%BD%95/" style="font-size: 10px;">学习记录</a> <a href="/tags/%E5%BC%80%E5%8F%91/" style="font-size: 18.33px;">开发</a> <a href="/tags/%E6%8E%92%E5%BA%8F/" style="font-size: 10px;">排序</a> <a href="/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/" style="font-size: 13.33px;">数据结构</a> <a href="/tags/%E6%A0%88/" style="font-size: 10px;">栈</a> <a href="/tags/%E6%A0%91/" style="font-size: 15px;">树</a> <a href="/tags/%E6%B8%B8%E6%88%8F%E5%92%8C%E5%BC%95%E6%93%8E/" style="font-size: 11.67px;">游戏和引擎</a> <a href="/tags/%E7%AC%94%E8%AF%95/" style="font-size: 10px;">笔试</a> <a href="/tags/%E7%AC%94%E8%AF%95%E9%9D%A2%E8%AF%95/" style="font-size: 13.33px;">笔试面试</a> <a href="/tags/%E7%AE%97%E6%B3%95/" style="font-size: 10px;">算法</a> <a href="/tags/%E9%80%92%E5%BD%92/" style="font-size: 10px;">递归</a>
    </div>
</div>
    
    
        <div class="column-right-shadow is-hidden-widescreen is-sticky">
        
            

    <div class="card widget" id="toc">
        <div class="card-content">
            <div class="menu">
                <h3 class="menu-label">
                    目录
                </h3>
                <ul class="menu-list"><li>
        <a class="is-flex" href="#一-什么是决策树">
        <!-- 目录是否自动编号 -->
        <!-- <span class="has-mr-6">1</span> -->
        <span>一.什么是决策树</span>
        </a></li><li>
        <a class="is-flex" href="#二-代码实现">
        <!-- 目录是否自动编号 -->
        <!-- <span class="has-mr-6">2</span> -->
        <span>二.代码实现</span>
        </a></li></ul>
            </div>
        </div>
    </div>

        
            <div class="card widget">
    <div class="card-content">
        <h3 class="menu-label">
            推荐阅读
        </h3>
        
        <article class="media">
            
            <a href="/Others/line-it-node-editor/" class="media-left">
                <p class="image is-64x64">
                    <img class="thumbnail" src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20250401154214355.jpeg" alt="Line-It 节点编辑器">
                </p>
            </a>
            
            <div class="media-content">
                <div class="content">
                    <div><time class="has-text-grey is-size-7 is-uppercase" datetime="2025-04-01T07:28:20.000Z">2025-04-01</time></div>
                    <a href="/Others/line-it-node-editor/" class="title has-link-black-ter is-size-6 has-text-weight-normal">Line-It 节点编辑器</a>
                    <p class="is-size-7 is-uppercase">
                        <a class="has-link-grey -link" href="/categories/Others/">Others</a>
                    </p>
                </div>
            </div>
        </article>
        
        <article class="media">
            
            <a href="/games/Unity3D-note/" class="media-left">
                <p class="image is-64x64">
                    <img class="thumbnail" src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210728004637.jpg" alt="Unity3D学习笔记">
                </p>
            </a>
            
            <div class="media-content">
                <div class="content">
                    <div><time class="has-text-grey is-size-7 is-uppercase" datetime="2021-07-28T12:42:07.000Z">2021-07-28</time></div>
                    <a href="/games/Unity3D-note/" class="title has-link-black-ter is-size-6 has-text-weight-normal">Unity3D学习笔记</a>
                    <p class="is-size-7 is-uppercase">
                        <a class="has-link-grey -link" href="/categories/games/">游戏和引擎</a>
                    </p>
                </div>
            </div>
        </article>
        
        <article class="media">
            
            <a href="/life/%E4%B8%BA%E6%AF%95%E4%B8%9A%E5%81%9A%E5%87%86%E5%A4%87/" class="media-left">
                <p class="image is-64x64">
                    <img class="thumbnail" src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210717225951.jpeg" alt="为毕业做准备">
                </p>
            </a>
            
            <div class="media-content">
                <div class="content">
                    <div><time class="has-text-grey is-size-7 is-uppercase" datetime="2021-03-31T13:13:32.000Z">2021-03-31</time></div>
                    <a href="/life/%E4%B8%BA%E6%AF%95%E4%B8%9A%E5%81%9A%E5%87%86%E5%A4%87/" class="title has-link-black-ter is-size-6 has-text-weight-normal">为毕业做准备</a>
                    <p class="is-size-7 is-uppercase">
                        <a class="has-link-grey -link" href="/categories/life/">生活随笔</a>
                    </p>
                </div>
            </div>
        </article>
        
        <article class="media">
            
            <a href="/life/mhxy-experience/" class="media-left">
                <p class="image is-64x64">
                    <img class="thumbnail" src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210717223725.png" alt="梦幻西游游戏体验">
                </p>
            </a>
            
            <div class="media-content">
                <div class="content">
                    <div><time class="has-text-grey is-size-7 is-uppercase" datetime="2021-03-31T08:29:35.000Z">2021-03-31</time></div>
                    <a href="/life/mhxy-experience/" class="title has-link-black-ter is-size-6 has-text-weight-normal">梦幻西游游戏体验</a>
                    <p class="is-size-7 is-uppercase">
                        <a class="has-link-grey -link" href="/categories/life/">生活随笔</a>
                    </p>
                </div>
            </div>
        </article>
        
        <article class="media">
            
            <a href="/games/3DMath-Primerfor-Graphics-and-Game-Development-note/" class="media-left">
                <p class="image is-64x64">
                    <img class="thumbnail" src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210717223435.jpeg" alt="3D数学基础图形与游戏研发笔记">
                </p>
            </a>
            
            <div class="media-content">
                <div class="content">
                    <div><time class="has-text-grey is-size-7 is-uppercase" datetime="2021-03-06T10:55:07.000Z">2021-03-06</time></div>
                    <a href="/games/3DMath-Primerfor-Graphics-and-Game-Development-note/" class="title has-link-black-ter is-size-6 has-text-weight-normal">3D数学基础图形与游戏研发笔记</a>
                    <p class="is-size-7 is-uppercase">
                        <a class="has-link-grey -link" href="/categories/games/">游戏和引擎</a>
                    </p>
                </div>
            </div>
        </article>
        
    </div>
</div>
        
        </div>
    
</div>

                




<div class="column is-4-tablet is-4-desktop is-3-widescreen is-hidden-touch is-hidden-desktop-only has-order-3 column-right is-sticky">
    
        

    <div class="card widget" id="toc">
        <div class="card-content">
            <div class="menu">
                <h3 class="menu-label">
                    目录
                </h3>
                <ul class="menu-list"><li>
        <a class="is-flex" href="#一-什么是决策树">
        <!-- 目录是否自动编号 -->
        <!-- <span class="has-mr-6">1</span> -->
        <span>一.什么是决策树</span>
        </a></li><li>
        <a class="is-flex" href="#二-代码实现">
        <!-- 目录是否自动编号 -->
        <!-- <span class="has-mr-6">2</span> -->
        <span>二.代码实现</span>
        </a></li></ul>
            </div>
        </div>
    </div>

    
        <div class="card widget">
    <div class="card-content">
        <h3 class="menu-label">
            推荐阅读
        </h3>
        
        <article class="media">
            
            <a href="/Others/line-it-node-editor/" class="media-left">
                <p class="image is-64x64">
                    <img class="thumbnail" src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20250401154214355.jpeg" alt="Line-It 节点编辑器">
                </p>
            </a>
            
            <div class="media-content">
                <div class="content">
                    <div><time class="has-text-grey is-size-7 is-uppercase" datetime="2025-04-01T07:28:20.000Z">2025-04-01</time></div>
                    <a href="/Others/line-it-node-editor/" class="title has-link-black-ter is-size-6 has-text-weight-normal">Line-It 节点编辑器</a>
                    <p class="is-size-7 is-uppercase">
                        <a class="has-link-grey -link" href="/categories/Others/">Others</a>
                    </p>
                </div>
            </div>
        </article>
        
        <article class="media">
            
            <a href="/games/Unity3D-note/" class="media-left">
                <p class="image is-64x64">
                    <img class="thumbnail" src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210728004637.jpg" alt="Unity3D学习笔记">
                </p>
            </a>
            
            <div class="media-content">
                <div class="content">
                    <div><time class="has-text-grey is-size-7 is-uppercase" datetime="2021-07-28T12:42:07.000Z">2021-07-28</time></div>
                    <a href="/games/Unity3D-note/" class="title has-link-black-ter is-size-6 has-text-weight-normal">Unity3D学习笔记</a>
                    <p class="is-size-7 is-uppercase">
                        <a class="has-link-grey -link" href="/categories/games/">游戏和引擎</a>
                    </p>
                </div>
            </div>
        </article>
        
        <article class="media">
            
            <a href="/life/%E4%B8%BA%E6%AF%95%E4%B8%9A%E5%81%9A%E5%87%86%E5%A4%87/" class="media-left">
                <p class="image is-64x64">
                    <img class="thumbnail" src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210717225951.jpeg" alt="为毕业做准备">
                </p>
            </a>
            
            <div class="media-content">
                <div class="content">
                    <div><time class="has-text-grey is-size-7 is-uppercase" datetime="2021-03-31T13:13:32.000Z">2021-03-31</time></div>
                    <a href="/life/%E4%B8%BA%E6%AF%95%E4%B8%9A%E5%81%9A%E5%87%86%E5%A4%87/" class="title has-link-black-ter is-size-6 has-text-weight-normal">为毕业做准备</a>
                    <p class="is-size-7 is-uppercase">
                        <a class="has-link-grey -link" href="/categories/life/">生活随笔</a>
                    </p>
                </div>
            </div>
        </article>
        
        <article class="media">
            
            <a href="/life/mhxy-experience/" class="media-left">
                <p class="image is-64x64">
                    <img class="thumbnail" src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210717223725.png" alt="梦幻西游游戏体验">
                </p>
            </a>
            
            <div class="media-content">
                <div class="content">
                    <div><time class="has-text-grey is-size-7 is-uppercase" datetime="2021-03-31T08:29:35.000Z">2021-03-31</time></div>
                    <a href="/life/mhxy-experience/" class="title has-link-black-ter is-size-6 has-text-weight-normal">梦幻西游游戏体验</a>
                    <p class="is-size-7 is-uppercase">
                        <a class="has-link-grey -link" href="/categories/life/">生活随笔</a>
                    </p>
                </div>
            </div>
        </article>
        
        <article class="media">
            
            <a href="/games/3DMath-Primerfor-Graphics-and-Game-Development-note/" class="media-left">
                <p class="image is-64x64">
                    <img class="thumbnail" src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210717223435.jpeg" alt="3D数学基础图形与游戏研发笔记">
                </p>
            </a>
            
            <div class="media-content">
                <div class="content">
                    <div><time class="has-text-grey is-size-7 is-uppercase" datetime="2021-03-06T10:55:07.000Z">2021-03-06</time></div>
                    <a href="/games/3DMath-Primerfor-Graphics-and-Game-Development-note/" class="title has-link-black-ter is-size-6 has-text-weight-normal">3D数学基础图形与游戏研发笔记</a>
                    <p class="is-size-7 is-uppercase">
                        <a class="has-link-grey -link" href="/categories/games/">游戏和引擎</a>
                    </p>
                </div>
            </div>
        </article>
        
    </div>
</div>
    
    
</div>

            </div>
        </div>
    </section>
    <footer class="footer">
    <div class="container">
        <div class="level">
            <div class="level-start has-text-centered-mobile">
                <a class="footer-logo is-block has-mb-6" href="/">
                
                    <img src="images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/wjwABCDEFG/blog_img/img/20210717231246.png" alt="手把手从0实现一颗决策树" height="28">
                
                </a>
                <a href="https://beian.miit.gov.cn/" target="_blank">粤ICP备2026005630号-2</a >
                <p class="is-size-7">
                &copy; 2026 wjw&nbsp;
                Powered by <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a> & <a
                        href="https://github.com/ppoffice/hexo-theme-icarus" target="_blank" rel="noopener">Icarus</a>
                
                <br>
                <!-- <span id="busuanzi_container_site_uv">
                共<span id="busuanzi_value_site_uv">0</span>个访客
                </span> -->
                <span id="busuanzi_container_site_uv"> 来访 <span id="busuanzi_value_site_uv"></span>人</span>
                <span id="busuanzi_container_site_pv">, 总访问 <span id="busuanzi_value_site_pv"></span>次</span>

                <span id="timeDate">载入天数...</span><span id="times">载入时分秒...</span>
                    <script>
                        var now = new Date(); 
                        function createtime() { 
                            var grt= new Date("03/06/2020 00:00:00"); /*建站时间*/
                            now.setTime(now.getTime()+250); 
                            days = (now - grt ) / 1000 / 60 / 60 / 24; dnum = Math.floor(days); 
                            hours = (now - grt ) / 1000 / 60 / 60 - (24 * dnum); hnum = Math.floor(hours); 
                            if(String(hnum).length ==1 ){hnum = "0" + hnum;} minutes = (now - grt ) / 1000 /60 - (24 * 60 * dnum) - (60 * hnum); 
                            mnum = Math.floor(minutes); if(String(mnum).length ==1 ){mnum = "0" + mnum;} 
                            seconds = (now - grt ) / 1000 - (24 * 60 * 60 * dnum) - (60 * 60 * hnum) - (60 * mnum); 
                            snum = Math.round(seconds); if(String(snum).length ==1 ){snum = "0" + snum;} 
                            document.getElementById("timeDate").innerHTML = "本站已安全运行 "+dnum+" 天 "; 
                            document.getElementById("times").innerHTML = hnum + " 小时 " + mnum + " 分 " + snum + " 秒"; 
                        } 
                    setInterval("createtime()",250);
                    </script>
                
                </p>
            </div>
            <div class="level-end">
            
                <div class="field has-addons is-flex-center-mobile has-mt-5-mobile is-flex-wrap is-flex-middle">
                
                <p class="control">
                    <a class="button is-white is-large" target="_blank" rel="noopener" title="Creative Commons" href="https://creativecommons.org/">
                        
                        <i class="fab fa-creative-commons"></i>
                        
                    </a>
                </p>
                
                <p class="control">
                    <a class="button is-white is-large" target="_blank" rel="noopener" title="Attribution 4.0 International" href="https://creativecommons.org/licenses/by/4.0/">
                        
                        <i class="fab fa-creative-commons-by"></i>
                        
                    </a>
                </p>
                
                <p class="control">
                    <a class="button is-white is-large" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/ppoffice/hexo-theme-icarus">
                        
                        <i class="fab fa-github"></i>
                        
                    </a>
                </p>
                
                </div>
            
            </div>
        </div>
    </div>
</footer>
    <script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/moment@2.22.2/min/moment-with-locales.min.js"></script>
<script>moment.locale("zh-CN");</script>


<script>
var IcarusThemeSettings = {
    site: {
        url: 'https://wjw.today',
        external_link: {"enable":true,"exclude":[]}
    },
    article: {
        highlight: {
            clipboard: true,
            fold: 'unfolded'
        }
    }
};
</script>


<script src="https://cdn.jsdelivr.net/npm/clipboard@2.0.4/dist/clipboard.min.js" defer></script>





<script src="/js/animation.js"></script>



<script src="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/js/lightgallery.min.js" defer></script>
<script src="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/js/jquery.justifiedGallery.min.js" defer></script>
<script src="/js/gallery.js" defer></script>



<div id="outdated">
    <h6>Your browser is out-of-date!</h6>
    <p>Update your browser to view this website correctly. <a id="btnUpdateBrowser" href="http://outdatedbrowser.com/">Update
            my browser now </a></p>
    <p class="last"><a href="#" id="btnCloseUpdateBrowser" title="Close">&times;</a></p>
</div>
<script src="https://cdn.jsdelivr.net/npm/outdatedbrowser@1.1.5/outdatedbrowser/outdatedbrowser.min.js" defer></script>
<script>
    document.addEventListener("DOMContentLoaded", function () {
        outdatedBrowser({
            bgColor: '#f25648',
            color: '#ffffff',
            lowerThan: 'flex'
        });
    });
</script>


<script src="https://cdn.jsdelivr.net/npm/mathjax@2.7.5/unpacked/MathJax.js?config=TeX-MML-AM_CHTML" defer></script>
<script>
document.addEventListener('DOMContentLoaded', function () {
    MathJax.Hub.Config({
        'HTML-CSS': {
            matchFontHeight: false
        },
        SVG: {
            matchFontHeight: false
        },
        CommonHTML: {
            matchFontHeight: false
        },
        tex2jax: {
            inlineMath: [
                ['$','$'],
                ['\\(','\\)']
            ]
        }
    });
});
</script>


<a id="back-to-top" title="回到顶端" href="javascript:;">
    <i class="fas fa-chevron-up"></i>
</a>
<script src="/js/back-to-top.js" defer></script>














<script src="/js/main.js" defer></script>

    
    <div class="searchbox ins-search">
    <div class="searchbox-container ins-search-container">
        <div class="searchbox-input-wrapper">
            <input type="text" class="searchbox-input ins-search-input" placeholder="想要查找什么..." />
            <span class="searchbox-close ins-close ins-selectable"><i class="fa fa-times-circle"></i></span>
        </div>
        <div class="searchbox-result-wrapper ins-section-wrapper">
            <div class="ins-section-container"></div>
        </div>
    </div>
</div>
<script>
    (function (window) {
        var INSIGHT_CONFIG = {
            TRANSLATION: {
                POSTS: '文章',
                PAGES: '页面',
                CATEGORIES: '分类',
                TAGS: '标签',
                UNTITLED: '(无标题)',
            },
            CONTENT_URL: '/content.json',
        };
        window.INSIGHT_CONFIG = INSIGHT_CONFIG;
    })(window);
</script>
<script src="/js/insight.js" defer></script>
<link rel="stylesheet" href="/css/search.css">
<link rel="stylesheet" href="/css/insight.css">
    

        <style>
            [bg-lazy] {
                background-image: none !important;
                background-color: #eee !important;
            }
        </style>
        <script>
            window.imageLazyLoadSetting = {
                isSPA: false,
                preloadRatio: 1,
                processImages: null,
            };
        </script><script>window.addEventListener("load",function(){var t=/\.(gif|jpg|jpeg|tiff|png)$/i,r=/^data:image\/[a-z\d\-\.\+]+;base64,/;Array.prototype.slice.call(document.querySelectorAll("img[data-original]")).forEach(function(a){var e=a.parentNode;"A"===e.tagName&&(t.test(e.href)||r.test(e.href))&&(e.href=a.dataset.original)})});</script><script>(r=>{r.imageLazyLoadSetting.processImages=t;var a=r.imageLazyLoadSetting.isSPA,o=r.imageLazyLoadSetting.preloadRatio||1,d=i();function i(){var t=Array.prototype.slice.call(document.querySelectorAll("img[data-original]")),e=Array.prototype.slice.call(document.querySelectorAll("[bg-lazy]"));return t.concat(e)}function t(t){(a||t)&&(d=i());for(var e,n=0;n<d.length;n++)0<=(e=(e=d[n]).getBoundingClientRect()).bottom&&0<=e.left&&e.top<=(r.innerHeight*o||document.documentElement.clientHeight*o)&&(()=>{var t,e,a,o,i=d[n];e=function(){d=d.filter(function(t){return i!==t}),r.imageLazyLoadSetting.onImageLoaded&&r.imageLazyLoadSetting.onImageLoaded(i)},(t=i).dataset.loaded||(t.hasAttribute("bg-lazy")?(t.removeAttribute("bg-lazy"),e&&e()):(a=new Image,o=t.getAttribute("data-original"),a.onload=function(){t.src=o,t.removeAttribute("data-original"),t.setAttribute("data-loaded",!0),e&&e()},a.onerror=function(){t.removeAttribute("data-original"),t.setAttribute("data-loaded",!1),t.src=o},t.src!==o&&(a.src=o)))})()}function e(){clearTimeout(t.tId),t.tId=setTimeout(t,500)}t(),document.addEventListener("scroll",e),r.addEventListener("resize",e),r.addEventListener("orientationchange",e)})(this);</script></body>
</html>